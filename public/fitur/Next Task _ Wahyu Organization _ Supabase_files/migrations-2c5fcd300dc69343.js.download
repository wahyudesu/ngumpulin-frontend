!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="bc9713d8-eb3e-4563-9436-7b72d4846190",e._sentryDebugIdIdentifier="sentry-dbid-bc9713d8-eb3e-4563-9436-7b72d4846190")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7831],{53698:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/migrations",function(){return n(79748)}])},68056:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});let s=(0,n(67634).Z)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]])},96948:function(e,t,n){"use strict";var s=n(97458),a=n(45196),r=n(29356),i=n(52983),l=n(5546);let o=(0,i.forwardRef)((e,t)=>{let{commands:n,className:a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("space-y-4",a),children:n.map((e,t)=>(0,s.jsx)(d,{item:e},"command-".concat(t)))})});o.displayName="CommandRender",t.Z=o;let d=e=>{let{item:t}=e,[n,l]=(0,i.useState)(!1);return(0,s.jsxs)("div",{className:"space-y-1","data-sentry-component":"Command","data-sentry-source-file":"CommandRender.tsx",children:[(0,s.jsx)("span",{className:"font-mono text-sm text-foreground-lighter",children:"> ".concat(t.comment)}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("div",{className:"flex gap-2 font-mono text-sm font-normal text-foreground",children:[(0,s.jsx)("span",{className:"text-foreground-lighter",children:"$"}),(0,s.jsxs)("span",{children:[(0,s.jsxs)("span",{children:[t.jsx?t.jsx():null," "]}),(0,s.jsx)("button",{type:"button",className:"text-foreground-lighter hover:text-foreground",onClick:()=>{var e;e=t.command,l(!0),navigator.clipboard.writeText(e).then(),setTimeout(function(){l(!1)},3e3)},children:n?(0,s.jsx)(a.Z,{size:14,strokeWidth:3,className:"text-brand"}):(0,s.jsx)(r.Z,{size:14})})]})]})})]})}},7004:function(e,t,n){"use strict";n.d(t,{CG:function(){return p},FW:function(){return u},I7:function(){return f},Lc:function(){return g},Wv:function(){return y},_S:function(){return m},g$:function(){return h},gW:function(){return b},jX:function(){return x},q7:function(){return c},s_:function(){return o},tM:function(){return j},tU:function(){return d},ur:function(){return v},y:function(){return l}});var s=n(97458),a=n(52983),r=n(70559),i=n(5546);let l="mx-auto w-full max-w-[1200px]",o="px-4 md:px-6 lg:px-14 xl:px-24 2xl:px-28",d=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("header",{...a,ref:t,className:(0,i.cn)("w-full","flex-col gap-3 py-6",n)})}),c=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("h1",{ref:t,...a,className:(0,i.cn)("text-2xl",n)})}),u=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("span",{ref:t,...a,className:(0,i.cn)("text-sm text-foreground-light",n)})}),m=a.forwardRef((e,t)=>{let{className:n,bottomPadding:a,...d}=e,{aiAssistantPanel:c}=(0,r.WZ)(),{open:u}=c;return(0,s.jsx)("div",{ref:t,...d,className:(0,i.cn)(l,o,a&&"pb-16",u?"xl:px-6":"",n)})}),f=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("w-full h-px bg-border",n)})}),x=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex flex-col gap-3 py-6","lg:grid md:grid-cols-12 lg:py-12",n)})}),p=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex flex-col gap-3","min-w-[420px]",n)})}),h=a.forwardRef((e,t)=>{let{className:n,children:a,title:r,...l}=e;return(0,s.jsxs)("div",{ref:t,...l,className:(0,i.cn)("col-span-4 xl:col-span-5 prose text-sm",n),children:[r&&(0,s.jsx)("h2",{children:r}),a]})}),g=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",n)})}),j=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex flex-col gap-3 items-center",n)})}),y=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex w-full items-center",n)})}),v=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex flex-row gap-3",n)})}),b=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)(l,o,"my-8 flex flex-col gap-8",n)})});d.displayName="ScaffoldHeader",c.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",m.displayName="ScaffoldContainer",f.displayName="ScaffoldDivider",x.displayName="ScaffoldSection",p.displayName="ScaffoldColumn",h.displayName="ScaffoldSectionDetail",g.displayName="ScaffoldSectionContent",j.displayName="ScaffoldFilterAndContent",y.displayName="ScaffoldActionsContainer",v.displayName="ScaffoldActionsGroup",b.displayName="ScaffoldContainerLegacy"},8504:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var s=n(97458),a=n(5546),r=n(26655);let i=e=>{let{title:t,description:n,docsUrl:i,actions:l,className:o}=e;return(0,s.jsxs)("div",{className:(0,a.cn)("mb-6 flex items-center justify-between gap-x-4 ".concat(o)),"data-sentry-component":"FormHeader","data-sentry-source-file":"FormHeader.tsx",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-foreground text-xl prose",children:t}),n&&(0,s.jsx)("div",{className:"prose text-sm max-w-full",children:n})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[void 0!==i&&(0,s.jsx)(r.G,{href:i}),l]})]})}},79748:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var s=n(97458),a=n(28977),r=n.n(a),i=n(37669),l=n.n(i),o=n(52983),d=n(20170),c=n(99658),u=n(48855),m=n(98261),f=n(28894),x=n(29020),p=n(30344);let h=()=>"\n    select\n      *\n    from supabase_migrations.schema_migrations sm\n    order by sm.version desc\n  ".trim();async function g(e,t){let{projectRef:n,connectionString:s}=e,a=h();try{let{result:e}=await (0,x.R)({projectRef:n,connectionString:s,sql:a,queryKey:["migrations"]},t);return e}catch(e){if(e.message.includes('relation "supabase_migrations.schema_migrations" does not exist'))return[];throw e}}let j=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.a)(p.A.migrations(t),e=>{let{signal:s}=e;return g({projectRef:t,connectionString:n},s)},{enabled:s&&void 0!==t,...a})};var y=n(19168),v=n(96789),b=n(86977),N=n(65022),w=n(71598),C=n(62836),S=n(45925),Z=n(96948),k=n(48653),_=n(5546),M=()=>{let{ref:e}=(0,S.UO)(),[t,n]=(0,o.useState)(!1),a=[{comment:"Link your project",command:"supabase link --project-ref ".concat(e),jsx:()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-brand-600",children:"supabase"})," link --project-ref ",e]})},{comment:'Create a new migration called "new-migration"',command:"supabase migration new new-migration",jsx:()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-brand-600",children:"supabase"})," migration new new-migration"]})},{comment:"Run all migrations against this project",command:"supabase db push",jsx:()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-brand-600",children:"supabase"})," db push"]})}];return(0,s.jsx)("div",{className:"w-full px-12 py-12 bg-no-repeat border rounded bg-studio border-default","data-sentry-component":"MigrationsEmptyState","data-sentry-source-file":"MigrationsEmptyState.tsx",children:(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"space-y-2 w-4/5",children:[(0,s.jsx)("h4",{className:"text-lg",children:"Database migrations"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:'Database changes are managed through "migrations" and they are a common way of tracking changes to your database over time. You can run migrations against your project\'s database via the Supabase CLI.'})]}),(0,s.jsxs)(k.ZP,{open:t,onOpenChange:n,"data-sentry-element":"Collapsible","data-sentry-source-file":"MigrationsEmptyState.tsx",children:[(0,s.jsx)(k.ZP.Trigger,{asChild:!0,"data-sentry-element":"unknown","data-sentry-source-file":"MigrationsEmptyState.tsx",children:(0,s.jsx)("button",{type:"button",className:(0,_.cn)("flex w-full items-center justify-between rounded py-3 px-6 text-foreground border bg-surface-100",t&&"rounded-b-none"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3 w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 p-2 border rounded bg-alternative",children:(0,s.jsx)(N.Z,{strokeWidth:2,"data-sentry-element":"Terminal","data-sentry-source-file":"MigrationsEmptyState.tsx"})}),(0,s.jsx)("h4",{children:"Terminal instructions"})]}),t?(0,s.jsx)(w.Z,{className:"text-border-stronger transition data-open-parent:rotate-0 data-closed-parent:rotate-180",strokeWidth:2,width:14}):(0,s.jsx)(C.Z,{className:"text-border-stronger transition data-open-parent:rotate-0 data-closed-parent:rotate-180",strokeWidth:2,width:14})]})})}),(0,s.jsx)(k.ZP.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"MigrationsEmptyState.tsx",children:(0,s.jsx)("div",{className:"border border-t-0 bg-surface-100 rounded-b py-3 px-6",children:(0,s.jsx)(Z.Z,{commands:a,"data-sentry-element":"CommandRender","data-sentry-source-file":"MigrationsEmptyState.tsx"})})})]})]})})},R=n(78854),D=n(61911),E=()=>{var e,t,n,a;let[i,f]=(0,o.useState)(""),[x,p]=(0,o.useState)(),{project:h}=(0,d.d2)(),{data:g,isLoading:N,isSuccess:w,isError:C,error:S}=j({projectRef:null==h?void 0:h.ref,connectionString:null==h?void 0:h.connectionString}),Z=0===i.length?null!=g?g:[]:null!==(t=null==g?void 0:g.filter(e=>{var t;return e.version.includes(i)||(null===(t=e.name)||void 0===t?void 0:t.includes(i))}))&&void 0!==t?t:[];return(0,s.jsxs)(s.Fragment,{children:[N&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.Z,{}),(0,s.jsx)(m.Z,{className:"w-3/4"}),(0,s.jsx)(m.Z,{className:"w-1/2"})]}),(0,s.jsxs)("div",{children:[C&&(0,s.jsx)(D.J,{type:"warning",title:"Failed to retrieve migration history for database",description:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"mb-1",children:"Try refreshing your browser, but if the issue persists, please reach out to us via support."}),(0,s.jsxs)("p",{className:"mb-4",children:["Error: ",null!==(n=null==S?void 0:S.message)&&void 0!==n?n:"Unknown"]})]}),children:(0,s.jsx)(y.z,{asChild:!0,type:"default",children:(0,s.jsx)(l(),{href:"/support/new?ref=".concat(null==h?void 0:h.ref,"&category=dashboard_bug&subject=Unable%20to%20view%20database%20migrations"),children:"Contact support"})},"contact-support")}),w&&(0,s.jsxs)("div",{children:[g.length<=0&&(0,s.jsx)(M,{}),g.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-80 mb-4",children:(0,s.jsx)(v.Z,{size:"small",placeholder:"Search for a migration",value:i,onChange:e=>f(e.target.value),icon:(0,s.jsx)(R.Z,{size:"14"})})}),(0,s.jsx)(c.Z,{head:[(0,s.jsx)(c.Z.th,{style:{width:"180px"},children:"Version"},"version"),(0,s.jsx)(c.Z.th,{children:"Name"},"version"),(0,s.jsx)(c.Z.th,{children:"Inserted at (UTC)"},"version"),(0,s.jsx)(c.Z.th,{},"buttons")],body:Z.length>0?Z.map(e=>{var t,n;let a=r()(e.version,"YYYYMMDDHHmmss").format("DD MMM YYYY, HH:mm:ss");return(0,s.jsxs)(c.Z.tr,{children:[(0,s.jsx)(c.Z.td,{children:e.version}),(0,s.jsx)(c.Z.td,{className:0===(null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"").length?"!text-foreground-lighter":"",children:null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"Name not available"}),(0,s.jsx)(c.Z.td,{children:a}),(0,s.jsx)(c.Z.td,{align:"right",children:(0,s.jsx)(y.z,{type:"default",onClick:()=>p(e),children:"View migration SQL"})})]},e.version)}):(0,s.jsx)(c.Z.tr,{children:(0,s.jsxs)(c.Z.td,{colSpan:3,children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',i,'" did not return any results']})]})})})]})]})]}),(0,s.jsx)(b.ZP,{size:"large",visible:void 0!==x,header:"Migration: ".concat(null==x?void 0:x.version),onCancel:()=>p(void 0),customFooter:(0,s.jsx)("div",{className:"flex items-center justify-end p-4 border-t border-overlay-border",children:(0,s.jsx)(y.z,{type:"default",onClick:()=>p(void 0),children:"Close"})}),"data-sentry-element":"SidePanel","data-sentry-source-file":"Migrations.tsx",children:(0,s.jsx)("div",{className:"h-full",children:(0,s.jsx)("div",{className:"relative h-full",children:(0,s.jsx)(u.Z,{isReadOnly:!0,id:null!==(a=null==x?void 0:x.version)&&void 0!==a?a:"",language:"pgsql",defaultValue:null==x?void 0:null===(e=x.statements)||void 0===e?void 0:e.join("\n"),"data-sentry-element":"CodeEditor","data-sentry-source-file":"Migrations.tsx"})})})})]})},F=n(69019),T=n(7004),Y=n(8504),z=n(26655);let H=()=>(0,s.jsx)(T._S,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"MigrationsPage","data-sentry-source-file":"migrations.tsx",children:(0,s.jsxs)(T.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"migrations.tsx",children:[(0,s.jsx)(T.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"migrations.tsx",children:(0,s.jsx)(Y.p,{className:"!mb-0",title:"Database Migrations",description:"History of migrations that have been run on your database","data-sentry-element":"FormHeader","data-sentry-source-file":"migrations.tsx"})}),(0,s.jsx)(T.g$,{className:"flex items-center md:justify-end gap-x-2","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"migrations.tsx",children:(0,s.jsx)(z.G,{className:"no-underline",href:"https://supabase.com/docs/guides/deployment/database-migrations","data-sentry-element":"DocsButton","data-sentry-source-file":"migrations.tsx"})}),(0,s.jsx)("div",{className:"col-span-12 mt-3",children:(0,s.jsx)(E,{"data-sentry-element":"Migrations","data-sentry-source-file":"migrations.tsx"})})]})});H.getLayout=e=>(0,s.jsx)(F.Z,{title:"Migrations",children:e});var O=H},48653:function(e,t,n){"use strict";var s=n(97458),a=n(99517);n(52983);var r=n(82188);let i=e=>{let{open:t,children:n,className:r,...i}=e;return(0,s.jsx)(a.fC,{asChild:i.asChild,defaultOpen:i.defaultOpen,open:t,onOpenChange:i.onOpenChange,disabled:i.disabled,className:r,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:n})};i.Trigger=function(e){let{children:t,asChild:n}=e;return(0,s.jsx)(a.xz,{asChild:n,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},i.Content=function(e){let{asChild:t,children:n,className:i}=e,l=(0,r.Z)("collapsible");return(0,s.jsx)(a.VY,{asChild:t,className:[l.content,i].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:n})},t.ZP=i}},function(e){e.O(0,[1885,588,520,2597,8703,9505,3351,6019,7191,2594,175,659,2829,5294,5313,5970,9885,495,7546,6064,111,5394,7687,9774,2888,179],function(){return e(e.s=53698)}),_N_E=e.O()}]);