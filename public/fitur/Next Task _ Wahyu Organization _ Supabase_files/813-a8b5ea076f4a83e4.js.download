!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3e59ae71-ef94-46b9-a2cc-ea07e15dc56d",e._sentryDebugIdIdentifier="sentry-dbid-3e59ae71-ef94-46b9-a2cc-ea07e15dc56d")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[813],{4673:function(e,t,n){n.d(t,{NK:function(){return m},Tf:function(){return f},Yb:function(){return u},cc:function(){return c},rg:function(){return d},x4:function(){return p}});var r=n(12832),a=n(6494),o=n.n(a),s=n(69171),l=n(43289),i=n(90897);function c(e){let{editable:t}=e;return t?e:{...e,onAddColumn:void 0,onAddRow:void 0,onEditColumn:void 0,onDeleteColumn:void 0,onEditRow:void 0}}function d(e,t){return Array.isArray(t)?o()(t.map(t=>{let[n,r]=t.split(":");if(n&&r)return{table:e,column:n,ascending:"asc"===r}})):[]}function u(e){return Array.isArray(e)?e.map(e=>{let[t,n,...r]=e.split(":"),a=r.join(":"),o=l.o.find(e=>e.abbrev===n);if(t&&n&&o)return{column:t,operator:o.value,value:a||""}}).filter(e=>void 0!==e):[]}function m(e){let t=e.columns,n=(0,s.N3)(e)?e.primary_keys:[],r=(0,s.N3)(e)?e.relationships:[],a=t.map(e=>{let t={position:e.ordinal_position,name:e.name,defaultValue:e.default_value,dataType:e.data_type,format:e.format,isPrimaryKey:!1,isIdentity:e.is_identity,isGeneratable:"BY DEFAULT"==e.identity_generation,isNullable:e.is_nullable,isUpdatable:e.is_updatable,enum:e.enums,comment:e.comment,foreignKey:{targetTableSchema:null,targetTableName:null,targetColumnName:null,deletionAction:void 0,updateAction:void 0}},a=n.find(t=>t.name==e.name);t.isPrimaryKey=!!a;let o=r.find(t=>t.source_schema===e.schema&&t.source_table_name===e.table&&t.source_column_name===e.name);return o&&(t.foreignKey.targetTableSchema=o.target_table_schema,t.foreignKey.targetTableName=o.target_table_name,t.foreignKey.targetColumnName=o.target_column_name,t.foreignKey.deletionAction=o.deletion_action,t.foreignKey.updateAction=o.update_action),t});return{id:e.id,name:e.name,comment:e.comment,schema:e.schema,columns:a,estimateRowCount:(0,s.N3)(e)?e.live_rows_estimate:0}}let f=(0,r.Z)(function(e,t,n,r){let a;if(!e.table)return;let o={gridColumns:e.gridColumns,...void 0!==n&&{sorts:n},...void 0!==r&&{filters:r}},s=p(i.E_,t),l=localStorage.getItem(s),{name:c,schema:d}=e.table,u=d&&"public"!=d?"".concat(d,".").concat(c):c;a=l?{...a=JSON.parse(l),[u]:o}:{[u]:o},localStorage.setItem(s,JSON.stringify(a))},500);function p(e,t){return"".concat(e,"_").concat(t)}},43289:function(e,t,n){n.d(t,{o:function(){return r}});let r=[{value:"=",label:"equals",preLabel:"[ = ]",abbrev:"eq"},{value:"<>",label:"not equal",preLabel:"[ <> ]",abbrev:"neq"},{value:">",label:"greater than",preLabel:"[ > ]",abbrev:"gt"},{value:"<",label:"less than",preLabel:"[ < ]",abbrev:"lt"},{value:">=",label:"greater than or equal",preLabel:"[ >= ]",abbrev:"gte"},{value:"<=",label:"less than or equal",preLabel:"[ <= ]",abbrev:"lte"},{value:"~~",label:"like operator",preLabel:"[ ~~ ]",abbrev:"like"},{value:"~~*",label:"ilike operator",preLabel:"[ ~~* ]",abbrev:"ilike"},{value:"in",label:"one of a list of values",preLabel:"[ in ]",abbrev:"in"},{value:"is",label:"checking for (null,not null,true,false)",preLabel:"[ is ]",abbrev:"is"}]},62408:function(e,t,n){n.d(t,{f:function(){return j}});var r=n(97458),a=n(58724),o=n.n(a),s=n(85466),l=n.n(s),i=n(5812),c=n(63204),d=n(52983),u=n(4673),m=n(1680),f=n(41341),p=n(19168),h=n(26264),x=n(14415),g=n(17751),y=n(37555),v=n(25084),b=(0,d.memo)(e=>{let{table:t,index:n,columnName:a,sort:o,onDelete:s,onToggle:l,onDrag:i}=e,c=t.columns.find(e=>e.name===a),u=(0,d.useRef)(null),[{isDragging:m},f]=(0,g.c)({type:"sort-row",item:()=>({key:a,index:n}),collect:e=>({isDragging:e.isDragging()})}),[{handlerId:b},j]=(0,y.L)({accept:"sort-row",collect:e=>({handlerId:e.getHandlerId()}),hover(e,t){var r;if(!u.current)return;let a=e.index;if(a===n)return;let o=null===(r=u.current)||void 0===r?void 0:r.getBoundingClientRect(),s=(o.bottom-o.top)/2,l=t.getClientOffset().y-o.top;a<n&&l<s||a>n&&l>s||(_(a,n),e.index=n)}}),_=(e,t)=>{e!=t&&i(e,t)};return(f(j(u)),c)?(0,r.jsxs)("div",{className:"flex items-center gap-3 px-3",ref:u,style:{opacity:m?0:1},"data-handler-id":b,"data-sentry-component":"SortRow","data-sentry-source-file":"SortRow.tsx",children:[(0,r.jsx)("span",{className:"transition-color text-foreground-lighter hover:text-foreground-light",children:(0,r.jsx)(h.Z,{strokeWidth:2,size:16,"data-sentry-element":"Menu","data-sentry-source-file":"SortRow.tsx"})}),(0,r.jsx)("div",{className:"grow",children:(0,r.jsxs)("span",{className:"flex grow items-center gap-1 truncate text-sm text-foreground",children:[(0,r.jsx)("span",{className:"text-xs text-foreground-lighter",children:n>0?"then by":"sort by"}),c.name]})}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("label",{className:"text-xs text-foreground-lighter",children:"ascending:"}),(0,r.jsx)(v.Z,{size:"tiny",layout:"flex",defaultChecked:o.ascending,onChange:e=>l(a,e),"data-sentry-element":"Toggle","data-sentry-source-file":"SortRow.tsx"})]}),(0,r.jsx)(p.z,{icon:(0,r.jsx)(x.Z,{strokeWidth:1.5}),size:"tiny",type:"text",onClick:()=>s(a),"data-sentry-element":"Button","data-sentry-source-file":"SortRow.tsx"})]}):null}),j=e=>{let{table:t,sorts:n,setParams:a}=e,[o,s]=(0,d.useState)(!1),l=(n||[]).length>0?"Sorted by ".concat(n.length," rule").concat(n.length>1?"s":""):"Sort";return(0,r.jsxs)(f.J2,{modal:!1,open:o,onOpenChange:s,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"SortPopover","data-sentry-source-file":"SortPopover.tsx",children:[(0,r.jsx)(f.xo,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"SortPopover.tsx",children:(0,r.jsx)(p.z,{type:(n||[]).length>0?"link":"text",icon:(0,r.jsx)(i.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"SortPopover.tsx",children:l})}),(0,r.jsx)(f.yk,{className:"p-0 w-96",side:"bottom",align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"SortPopover.tsx",children:(0,r.jsx)(_,{table:t,sorts:n,onApplySorts:e=>{a(t=>({...t,sort:e.map(e=>"".concat(e.column,":").concat(e.ascending?"asc":"desc"))}))},"data-sentry-element":"SortOverlay","data-sentry-source-file":"SortPopover.tsx"})})]})};let _=e=>{let{table:t,sorts:n,onApplySorts:a}=e,s=(0,d.useMemo)(()=>(0,u.rg)(t.name,null!=n?n:[]),[t.name,n]),[i,h]=(0,d.useState)(s),x=t.columns.filter(e=>"json"!==e.dataType&&"jsonb"!==e.dataType&&!i.find(t=>t.column==e.name)),g=(null==x?void 0:x.map(e=>({value:e.name,label:e.name})))||[],y=(0,d.useCallback)(e=>{h(t=>t.filter(t=>t.column!==e))},[]),v=(0,d.useCallback)((e,t)=>{h(n=>{let r=n.findIndex(t=>t.column===e);return o()(n,{[r]:{$merge:{ascending:t}}})})},[]),j=(0,d.useCallback)((e,t)=>{h(n=>o()(n,{$splice:[[e,1],[t,0,n[e]]]}))},[]);return(0,r.jsxs)("div",{className:"space-y-2 py-2","data-sentry-component":"SortOverlay","data-sentry-source-file":"SortPopover.tsx",children:[i.map((e,n)=>(0,r.jsx)(b,{table:t,index:n,columnName:e.column,sort:e,onDelete:y,onToggle:v,onDrag:j},e.column)),0===i.length&&(0,r.jsxs)("div",{className:"space-y-1 px-3",children:[(0,r.jsx)("h5",{className:"text-sm text-foreground-light",children:"No sorts applied to this view"}),(0,r.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Add a column below to sort the view"})]}),(0,r.jsx)(f.Fm,{"data-sentry-element":"PopoverSeparator_Shadcn_","data-sentry-source-file":"SortPopover.tsx"}),(0,r.jsxs)("div",{className:"px-3 flex flex-row justify-between",children:[x&&x.length>0?(0,r.jsx)(m.F,{options:g,onSelect:function(e){h([...i,{table:t.name,column:e,ascending:!0}])},side:"bottom",align:"start",children:(0,r.jsx)(p.z,{asChild:!0,type:"text",iconRight:(0,r.jsx)(c.Z,{size:"14",className:"text-foreground-light"}),className:"sb-grid-dropdown__item-trigger","data-testid":"table-editor-pick-column-to-sort-button",children:(0,r.jsxs)("span",{children:["Pick ",i.length>1?"another":"a"," column to sort by"]})})}):(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"All columns have been added"}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(p.z,{disabled:l()(i,s),type:"default",onClick:()=>a(i),"data-sentry-element":"Button","data-sentry-source-file":"SortPopover.tsx",children:"Apply sorting"})})]})]})}},54931:function(e,t,n){n.d(t,{ov:function(){return p},ep:function(){return j},q4:function(){return b}});var r=n(97458),a=n(13948),o=n(18656),s=n(86173),l=n(67328),i=n(17471),c=n(63204),d=n(77518),u=n(44273),m=n(19168),f=n(27299),p=e=>{let{column:t,isEncrypted:n}=e,p=(0,f.Qq)(),h=(0,f.I0)(),{onEditColumn:x,onDeleteColumn:g}=p,y=t.key;function v(){x&&x(y)}function b(){g&&g(y)}return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(d.h_,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"ColumnMenu.tsx",children:[(0,r.jsx)(d.$F,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"ColumnMenu.tsx",children:(0,r.jsx)(m.z,{className:"opacity-50 flex",type:"text",style:{padding:"3px"},icon:(0,r.jsx)(c.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"ColumnMenu.tsx"})}),(0,r.jsx)(d.AW,{align:"end",side:"bottom","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"ColumnMenu.tsx",children:(0,r.jsxs)(r.Fragment,{children:[p.editable&&void 0!==v&&(0,r.jsxs)(a.fC,{delayDuration:0,children:[(0,r.jsx)(a.xz,{asChild:!0,className:"".concat(n?"opacity-50":""),children:(0,r.jsxs)(d.Xi,{className:"space-x-2",onClick:v,disabled:n,children:[(0,r.jsx)(o.Z,{size:14}),(0,r.jsx)("p",{children:"Edit column"})]})}),n&&(0,r.jsx)(a.h_,{children:(0,r.jsxs)(a.VY,{side:"bottom",children:[(0,r.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,r.jsx)("span",{className:"text-xs text-foreground",children:"Encrypted columns cannot be edited"})})]})})]}),(0,r.jsx)(d.Xi,{className:"space-x-2",onClick:t.frozen?function(){h({type:"UNFREEZE_COLUMN",payload:{columnKey:y}})}:function(){h({type:"FREEZE_COLUMN",payload:{columnKey:y}})},"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"ColumnMenu.tsx",children:t.frozen?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{size:14}),(0,r.jsx)("p",{children:"Unfreeze column"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{size:14}),(0,r.jsx)("p",{children:"Freeze column"})]})}),p.editable&&void 0!==b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{}),(0,r.jsxs)(d.Xi,{className:"space-x-2",onClick:b,children:[(0,r.jsx)(i.Z,{size:14,stroke:"red"}),(0,r.jsx)("p",{children:"Delete column"})]})]})]})})]})})},h=n(29356),x=n(52983),g=n(70717),y=n(44190),v=n(99429),b=e=>{let{rows:t}=e,n=(0,f.Qq)(),a=(0,y._2)();function s(e){let{data:t}=e;return"edit"===t?void 0==n.onEditRow:"delete"===t&&!n.editable}let l=(0,x.useCallback)(e=>{var r;let{props:a}=e;if(!n.selectedCellPosition||!a)return;let{rowIdx:o}=a,s=t[o][n.gridColumns[null===(r=n.selectedCellPosition)||void 0===r?void 0:r.idx].key],l=(0,v.Lw)(s);(0,v.vQ)(l)},[t,n.gridColumns,n.selectedCellPosition]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(g.v2,{id:j,animation:!1,"data-sentry-element":"Menu","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,r.jsxs)(g.ck,{onClick:l,"data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,r.jsx)(h.Z,{size:14,"data-sentry-element":"Clipboard","data-sentry-source-file":"RowContextMenu.tsx"}),(0,r.jsx)("span",{className:"ml-2 text-xs",children:"Copy cell content"})]}),(0,r.jsxs)(g.ck,{onClick:function(e){let{props:r}=e,{rowIdx:a}=r,o=t[a];n.onEditRow&&n.onEditRow(o)},hidden:s,data:"edit","data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,r.jsx)(o.Z,{size:14,"data-sentry-element":"Edit","data-sentry-source-file":"RowContextMenu.tsx"}),(0,r.jsx)("span",{className:"ml-2 text-xs",children:"Edit row"})]}),n.editable&&(0,r.jsx)(g.Z0,{}),(0,r.jsxs)(g.ck,{onClick:function(e){let{props:n}=e,{rowIdx:r}=n,o=t[r];o&&a.onDeleteRows([o])},hidden:s,data:"delete","data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,r.jsx)(i.Z,{size:14,stroke:"red","data-sentry-element":"Trash","data-sentry-source-file":"RowContextMenu.tsx"}),(0,r.jsx)("span",{className:"ml-2 text-xs",children:"Delete row"})]})]})})};let j="row-context-menu-id"},90897:function(e,t,n){n.d(t,{E_:function(){return a},Vz:function(){return o},W:function(){return l},ZR:function(){return s},mr:function(){return r},uZ:function(){return i}});let r=100,a="supabase_grid",o=-1,s=-2,l="supabase-grid-select-row",i="supabase-grid-add-column"},44767:function(e,t,n){n.d(t,{A:function(){return u}});var r=n(98219),a=n(34225);function o(e,t){return 0===t.length?e:e+=" where ".concat(t.map(e=>{switch(e.operator){case"in":let t;return t=Array.isArray(e.value)?e.value.map(e=>s(e)):String(e.value).split(",").map(e=>s(e)),"".concat((0,a.yR)(e.column)," ").concat(e.operator," (").concat(t.join(","),")");case"is":return function(e){let t=String(e.value);switch(t){case"null":case"false":case"true":case"not null":return"".concat((0,a.yR)(e.column)," ").concat(e.operator," ").concat(t);default:return"".concat((0,a.yR)(e.column)," ").concat(e.operator," ").concat(s(e.value))}}(e);default:return"".concat((0,a.yR)(e.column)," ").concat(e.operator," ").concat(s(e.value))}}).join(" and "))}function s(e){return"string"!=typeof e||(null==e?void 0:e.startsWith("ARRAY["))&&(null==e?void 0:e.endsWith("]"))?e:(0,a.i0)(e)}function l(e){return"".concat((0,a.yR)(e.schema),".").concat((0,a.yR)(e.name))}class i{range(e,t){return this.pagination={offset:e,limit:t-e+1},this}toSql(){try{var e;let{actionValue:t,actionOptions:n,filters:r,sorts:s}=null!==(e=this.options)&&void 0!==e?e:{};switch(this.action){case"count":return function(e,t){let n="select count(*) from ".concat(l(e)),{filters:r}=null!=t?t:{};return r&&(n=o(n,r)),n+";"}(this.table,{filters:r});case"delete":return function(e,t,n){if(!t||0===t.length)throw{message:"no filters for this delete query"};let r="delete from ".concat(l(e)),{returning:a,enumArrayColumns:s}=null!=n?n:{};return t&&(r=o(r,t)),a&&(r+=void 0===s||0===s.length?" returning *":" returning *, ".concat(s.map(e=>'"'.concat(e,'"::text[]')).join(","))),r+";"}(this.table,r,{returning:null==n?void 0:n.returning,enumArrayColumns:null==n?void 0:n.enumArrayColumns});case"insert":return function(e,t,n){if(!t||0===t.length)throw{message:"no value to insert"};let{returning:r,enumArrayColumns:o}=null!=n?n:{},s=Object.keys(t[0]).map(e=>(0,a.yR)(e)).join(","),i="";return i=0==s.length?(0,a.WU)("insert into %1$s select from jsonb_populate_recordset(null::%1$s, %2$s)",l(e),(0,a.i0)(JSON.stringify(t))):(0,a.WU)("insert into %1$s (%2$s) select %2$s from jsonb_populate_recordset(null::%1$s, %3$s)",l(e),s,(0,a.i0)(JSON.stringify(t))),r&&(i+=void 0===o||0===o.length?" returning *":" returning *, ".concat(o.map(e=>'"'.concat(e,'"::text[]')).join(","))),i+";"}(this.table,t,{returning:null==n?void 0:n.returning,enumArrayColumns:null==n?void 0:n.enumArrayColumns});case"select":return function(e,t,n){var r;let s="";s+="select ".concat(null!=t?t:"*"," from ").concat(l(e));let{filters:i,pagination:c,sorts:d}=null!=n?n:{};if(i&&(s=o(s,i)),d&&(r=s,s=0===d.length?r:r+=" order by ".concat(d.map(e=>{if(!e.column)return null;let t=e.ascending?"asc":"desc",n=e.nullsFirst?"nulls first":"nulls last";return"".concat((0,a.yR)(e.table),".").concat((0,a.yR)(e.column)," ").concat(t," ").concat(n)}).join(", "))),c){let{limit:e,offset:t}=null!=c?c:{};s+=" limit ".concat((0,a.i0)(e)," offset ").concat((0,a.i0)(t))}return s+";"}(this.table,t,{filters:r,pagination:this.pagination,sorts:s});case"update":return function(e,t,n){let{filters:r,returning:s,enumArrayColumns:i}=null!=n?n:{};if(!r||0===r.length)throw{message:"no filters for this update query"};let c=Object.keys(t).map(e=>(0,a.yR)(e)).join(","),d=(0,a.WU)("update %1$s set (%2$s) = (select %2$s from json_populate_record(null::%1$s, %3$s))",l(e),c,(0,a.i0)(JSON.stringify(t)));return r&&(d=o(d,r)),s&&(d+=void 0===i||0===i.length?" returning *":" returning *, ".concat(i.map(e=>'"'.concat(e,'"::text[]')).join(","))),d+";"}(this.table,t,{filters:r,returning:null==n?void 0:n.returning,enumArrayColumns:null==n?void 0:n.enumArrayColumns});case"truncate":return function(e,t){let n="truncate ".concat(l(e)),{cascade:r}=null!=t?t:{};return r&&(n+=" cascade"),n+";"}(this.table,{cascade:null==n?void 0:n.cascade});default:return""}}catch(e){throw e}}constructor(e,t,n){(0,r._)(this,"table",void 0),(0,r._)(this,"action",void 0),(0,r._)(this,"options",void 0),(0,r._)(this,"pagination",void 0),this.table=e,this.action=t,this.options=n}}class c{filter(e,t,n){return this.filters.push({column:e,operator:t,value:n}),this}match(e){return Object.entries(e).map(e=>{let[t,n]=e;this.filters.push({column:t,operator:"=",value:n})}),this}order(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.sorts.push({table:e,column:t,ascending:n,nullsFirst:r}),this}range(e,t){return this._getQueryModifier().range(e,t)}toSql(){return this._getQueryModifier().toSql()}_getQueryModifier(){return new i(this.table,this.action,{actionValue:this.actionValue,actionOptions:this.actionOptions,filters:this.filters,sorts:this.sorts})}constructor(e,t,n,a){(0,r._)(this,"table",void 0),(0,r._)(this,"action",void 0),(0,r._)(this,"actionValue",void 0),(0,r._)(this,"actionOptions",void 0),(0,r._)(this,"filters",void 0),(0,r._)(this,"sorts",void 0),this.table=e,this.action=t,this.actionValue=n,this.actionOptions=a,this.filters=[],this.sorts=[]}}class d{count(){return new c(this.table,"count")}delete(e){return new c(this.table,"delete",void 0,e)}insert(e,t){return new c(this.table,"insert",e,t)}select(e){return new c(this.table,"select",e)}update(e,t){return new c(this.table,"update",e,t)}truncate(e){return new c(this.table,"truncate",void 0,e)}constructor(e){(0,r._)(this,"table",void 0),this.table=e}}class u{from(e,t){return new d({name:e,schema:null!=t?t:"public"})}}},99429:function(e,t,n){function r(e){try{return JSON.parse(JSON.stringify(e))}catch(e){throw e}}function a(e){return e?"object"==typeof e||Array.isArray(e)?JSON.stringify(e):e:""}n.d(t,{I8:function(){return r},Lw:function(){return a},vQ:function(){return o}});let o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(window.document.hasFocus()){var n,r;null===(r=window.navigator)||void 0===r||null===(n=r.clipboard)||void 0===n||n.writeText(e).then(t)}else console.warn("Unable to copy to clipboard")}},68417:function(e,t,n){n.d(t,{II:function(){return d},Kp:function(){return p},LT:function(){return y},N8:function(){return _},Pm:function(){return w},VO:function(){return x},kO:function(){return m},nL:function(){return b},nr:function(){return i},om:function(){return s},v3:function(){return a}});let r=["smallint","integer","bigint","decimal","numeric","real","double precision","serial","bigserial","int2","int4","int8","float4","float8","smallserial","serial2","serial4","serial8"];function a(e){return r.indexOf(e.toLowerCase())>-1}let o=["json","jsonb","array"];function s(e){return o.indexOf(e.toLowerCase())>-1}let l=["array"];function i(e){return l.indexOf(e.toLowerCase())>-1}let c=["uuid","text","character varying"];function d(e){return c.indexOf(e.toLowerCase())>-1}let u=["citext"];function m(e){return u.indexOf(e.toLowerCase())>-1}let f=["timestamp","timestamptz"];function p(e){return f.indexOf(e.toLowerCase())>-1}let h=["date"];function x(e){return h.indexOf(e.toLowerCase())>-1}let g=["time","timetz"];function y(e){return g.indexOf(e.toLowerCase())>-1}let v=["boolean","bool"];function b(e){return v.indexOf(e.toLowerCase())>-1}let j=["user-defined"];function _(e){return j.indexOf(e.toLowerCase())>-1}function w(e){var t;let{targetTableSchema:n,targetTableName:r,targetColumnName:a}=null!==(t=null==e?void 0:e.foreignKey)&&void 0!==t?t:{};return!!n&&!!r&&!!a}},74039:function(e,t,n){n.d(t,{Of:function(){return p},QZ:function(){return d},Sb:function(){return y},oo:function(){return m},s8:function(){return g},uE:function(){return u},xY:function(){return f}});var r=n(85466),a=n.n(r),o=n(7534),s=n.n(o),l=n(58636),i=n(47878);let c=e=>{if(["CURRENT_DATE"].includes(e)||"("===e[0]&&")"===e[e.length-1])return!0;let t=e.indexOf("("),n=e.indexOf(")");return!(e.indexOf(" ")>=0)&&t>=0&&n>t},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{name:t,table:n,schema:r,format:a}=e;return{id:(0,i.k$)(),name:t||"",table:n||"",schema:r||"",comment:"",format:a||"",defaultValue:null,foreignKey:void 0,check:null,isNullable:!0,isUnique:!1,isArray:!1,isPrimaryKey:!1,isIdentity:!1,isNewColumn:!0,isEncrypted:!1}},u=(e,t,n)=>{var r,a;let{primary_keys:o}=t,s=o.map(e=>e.name),l=h(e,t,n),c=(null==e?void 0:e.data_type)==="ARRAY";return{foreignKey:l,id:null!==(r=null==e?void 0:e.id)&&void 0!==r?r:(0,i.k$)(),table:e.table,schema:e.schema,name:e.name,comment:null!==(a=null==e?void 0:e.comment)&&void 0!==a?a:"",format:c?e.format.slice(1):e.format,defaultValue:null==e?void 0:e.default_value,check:e.check,isArray:c,isNullable:e.is_nullable,isIdentity:e.is_identity,isUnique:e.is_unique,isNewColumn:!1,isEncrypted:!1,isPrimaryKey:s.includes(e.name)}},m=(e,t)=>{var n,r;let a=!!t.format.includes("int")&&t.isIdentity,o=t.defaultValue;return{tableId:e,isIdentity:a,name:t.name.trim(),comment:null===(n=t.comment)||void 0===n?void 0:n.trim(),type:t.isArray?"".concat(t.format,"[]"):t.format,check:(null===(r=t.check)||void 0===r?void 0:r.trim())||void 0,isUnique:t.isUnique,isPrimaryKey:t.isPrimaryKey,...!t.isPrimaryKey&&!a&&{isNullable:t.isNullable},...!a&&{defaultValue:t.isArray&&o?x(o):o},...!a&&o&&{defaultValueFormat:s()(o)||c(o)?"expression":"literal"}}},f=(e,t,n)=>{var r,o,l,i,d,u;let m=t.primary_keys.map(e=>e.name).includes(e.name),f=n.name.trim(),p=n.isArray?"".concat(n.format,"[]"):n.format,h=null===(r=(null!==(u=null===(o=n.comment)||void 0===o?void 0:o.length)&&void 0!==u?u:"")===0?null:n.comment)||void 0===r?void 0:r.trim(),x=null===(l=n.check)||void 0===l?void 0:l.trim(),g={};if(a()(e.name.trim(),f)||(g.name=f),a()(null===(i=e.comment)||void 0===i?void 0:i.trim(),h)||(g.comment=h),a()(null===(d=e.check)||void 0===d?void 0:d.trim(),x)||(g.check=x),a()(e.format,p)||(g.type=p),!a()(e.default_value,n.defaultValue)){let e=n.defaultValue;g.defaultValue=e,g.defaultValueFormat=s()(e)||c(e)?"expression":"literal"}return a()(e.is_identity,n.isIdentity)||(g.isIdentity=n.isIdentity),a()(e.is_nullable,n.isNullable)||(g.isNullable=n.isNullable),a()(e.is_unique,n.isUnique)||(g.isUnique=n.isUnique),a()(m,n.isPrimaryKey)||(g.isPrimaryKey=n.isPrimaryKey),g},p=e=>{let t={};return 0===e.name.length&&(t.name="Please assign a name for your column"),0===e.format.length&&(t.format="Please select a type for your column"),t},h=(e,t,n)=>{let{relationships:r}=t,a=r.find(t=>t.source_schema===e.schema&&t.source_table_name===e.table&&t.source_column_name===e.name);if(void 0===a)return a;{var o,s;let e=n.find(e=>e.id===a.id);return{...a,deletion_action:null!==(o=null==e?void 0:e.deletion_action)&&void 0!==o?o:l.N.NO_ACTION,update_action:null!==(s=null==e?void 0:e.update_action)&&void 0!==s?s:l.N.NO_ACTION}}},x=e=>e?e.replaceAll("[","{").replaceAll("]","}"):null,g=e=>{switch(e){case l.N.CASCADE:return"Cascade";case l.N.RESTRICT:return"Restrict";case l.N.SET_DEFAULT:return"Set default";case l.N.SET_NULL:return"Set NULL";default:return}},y=(e,t)=>{let n=t||"column_name";switch(e){case"int2":case"int4":case"int8":case"numeric":return'"'.concat(n,'" > 0');case"float4":case"float8":return'"'.concat(n,'" > 0.0');case"text":case"varchar":return'length("'.concat(n,'") <= 50');case"json":case"jsonb":return'jsonb_typeof("'.concat(n,"\"->'active') = 'boolean'");case"bool":return'"'.concat(n,'" in (true, false)');case"date":return'"'.concat(n,"\" > '2024-01-01'");case"time":return'"'.concat(n,"\" between '09:00:00' and '12:00:00'");case"timetz":return'"'.concat(n,"\" at time zone 'UTC' between '09:00:00+00' and '17:00:00+00'");case"uuid":return'"'.concat(n,"\" '00000000-0000-0000-0000-000000000000'");case"timestamp":return'"'.concat(n,"\" > '2023-01-01 00:00' and \"").concat(n,"\" < '2025-01-01 00:00'");case"timestamptz":return'"'.concat(n,"\" > '2023-01-01 00:00:00+00' and \"").concat(n,"\" < '2025-01-01 00:00:00+00'");default:return'length("'.concat(n,'") < 500')}}},46235:function(e,t,n){n.d(t,{BB:function(){return c},DL:function(){return h},Ks:function(){return d},N0:function(){return g},VP:function(){return x},XO:function(){return m},YF:function(){return i},ji:function(){return l},lb:function(){return u},nA:function(){return f},vH:function(){return p}});var r=n(71635),a=n.n(r),o=n(11466),s=n.n(o);let l=["int2","int4","int8","float4","float8","numeric","double precision"],i=["json","jsonb"],c=["text","varchar"],d=["timestamp","timestamptz"],u=["date"],m=["time","timetz"],f=s()(d,u,m),p=["uuid","bool","vector"],h=a()(s()(l,i,c,f,p)),x={varchar:{alternative:"text",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_varchar.28n.29_by_default"},json:{alternative:"jsonb",reference:"https://www.postgresql.org/docs/current/datatype-json.html"},timetz:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timetz"},timestamp:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timestamp_.28without_time_zone.29"}},g=[{name:"int2",description:"Signed two-byte integer",type:"number"},{name:"int4",description:"Signed four-byte integer",type:"number"},{name:"int8",description:"Signed eight-byte integer",type:"number"},{name:"float4",description:"Single precision floating-point number (4 bytes)",type:"number"},{name:"float8",description:"Double precision floating-point number (8 bytes)",type:"number"},{name:"numeric",description:"Exact numeric of selectable precision",type:"number"},{name:"json",description:"Textual JSON data",type:"json"},{name:"jsonb",description:"Binary JSON data, decomposed",type:"json"},{name:"text",description:"Variable-length character string",type:"text"},{name:"varchar",description:"Variable-length character string",type:"text"},{name:"uuid",description:"Universally unique identifier",type:"text"},{name:"date",description:"Calendar date (year, month, day)",type:"time"},{name:"time",description:"Time of day (no time zone)",type:"time"},{name:"timetz",description:"Time of day, including time zone",type:"time"},{name:"timestamp",description:"Date and time (no time zone)",type:"time"},{name:"timestamptz",description:"Date and time, including time zone",type:"time"},{name:"bool",description:"Logical boolean (true/false)",type:"bool"}]},54811:function(e,t,n){n.d(t,{R:function(){return r},k:function(){return a}});let r=(e,t,n,r,a)=>{let o=(null==r?void 0:r.find(r=>{var o,s;return(null==r?void 0:null===(o=r.metadata)||void 0===o?void 0:o.name)===e&&(null==r?void 0:null===(s=r.metadata)||void 0===s?void 0:s.schema)===a&&(null==r?void 0:r.name)===t&&n.includes(null==r?void 0:r.level)}))||null;return{hasLint:null!==o,count:o?1:0,matchingLint:o}},a=(e,t)=>{if(0===t.length)return"";let n=e.columns.map(e=>'"'.concat(e.name,'"')).join(", "),r=t.map(t=>{let n={...t};"idx"in n&&delete n.idx;let r=Object.entries(n).map(t=>{var n;let[r,a]=t,{dataType:o,format:s}=null!==(n=e.columns.find(e=>e.name===r))&&void 0!==n?n:{};return null===a?"null":"ARRAY"===o?"'".concat(JSON.stringify(a).replace("[","{").replace(/.$/,"}"),"'"):(null==s?void 0:s.includes("json"))?"".concat(JSON.stringify(a).replace(/\\"/g,'"').replace('"',"'").replace(/.$/,"'")):"'".concat(a,"'")});return"(".concat(r.join(", "),")")}).join(", ");return'INSERT INTO "'.concat(e.schema,'"."').concat(e.name,'" (').concat(n,") VALUES ").concat(r,";")}},60816:function(e,t,n){n.d(t,{LW:function(){return u},bn:function(){return h}});var r=n(36457),a=n(64618),o=n(34549),s=n(15538),l=n.n(s),i=n(29020),c=n(81899),d=n(30344);let u="pgmq_public",m=l()("\ncreate schema if not exists ".concat(u,";\ngrant usage on schema ").concat(u," to postgres, anon, authenticated, service_role;\n\ncreate or replace function ").concat(u,".pop(\n    queue_name text\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.pop(\n        queue_name := queue_name\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".pop(queue_name text) is 'Retrieves and locks the next message from the specified queue.';\n\n\ncreate or replace function ").concat(u,".send(\n    queue_name text,\n    message jsonb,\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send(\n        queue_name := queue_name,\n        msg := message,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer) is 'Sends a message to the specified queue, optionally delaying its availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".send_batch(\n    queue_name text,\n    messages jsonb[],\n    sleep_seconds integer default 0  -- renamed from 'delay'\n)\n  returns setof bigint\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.send_batch(\n        queue_name := queue_name,\n        msgs := messages,\n        delay := sleep_seconds\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".send_batch(queue_name text, messages jsonb[], sleep_seconds integer) is 'Sends a batch of messages to the specified queue, optionally delaying their availability by a number of seconds.';\n\n\ncreate or replace function ").concat(u,".archive(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.archive(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".archive(queue_name text, message_id bigint) is 'Archives a message by moving it from the queue to a permanent archive.';\n\n\ncreate or replace function ").concat(u,".archive(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.archive(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".archive(queue_name text, message_id bigint) is 'Archives a message by moving it from the queue to a permanent archive.';\n\n\ncreate or replace function ").concat(u,".delete(\n    queue_name text,\n    message_id bigint\n)\n  returns boolean\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return\n    pgmq.delete(\n        queue_name := queue_name,\n        msg_id := message_id\n    );\nend;\n$$;\n\ncomment on function ").concat(u,".delete(queue_name text, message_id bigint) is 'Permanently deletes a message from the specified queue.';\n\ncreate or replace function ").concat(u,".read(\n    queue_name text,\n    sleep_seconds integer,\n    n integer\n)\n  returns setof pgmq.message_record\n  language plpgsql\n  set search_path = ''\nas $$\nbegin\n    return query\n    select *\n    from pgmq.read(\n        queue_name := queue_name,\n        vt := sleep_seconds,\n        qty := n\n    );\nend;\n$$;\n\ncomment on function ").concat(u,'.read(queue_name text, sleep_seconds integer, n integer) is \'Reads up to "n" messages from the specified queue with an optional "sleep_seconds" (visibility timeout).\';\n\n-- Grant execute permissions on wrapper functions to roles\ngrant execute on function ').concat(u,".pop(text) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.pop(text) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send(text, jsonb, integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.send_batch(text, jsonb[], integer) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".archive(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.archive(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".delete(text, bigint) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.delete(text, bigint) to postgres, service_role, anon, authenticated;\n\ngrant execute on function ").concat(u,".read(text, integer, integer) to postgres, service_role, anon, authenticated;\ngrant execute on function pgmq.read(text, integer, integer) to postgres, service_role, anon, authenticated;\n\n-- For the service role, we want full access\n-- Grant permissions on existing tables\ngrant all privileges on all tables in schema pgmq to postgres, service_role;\n\n-- Ensure service_role has permissions on future tables\nalter default privileges in schema pgmq grant all privileges on tables to postgres, service_role;\n\ngrant usage on schema pgmq to postgres, anon, authenticated, service_role;\n")),f=l()("\n  drop function if exists \n    ".concat(u,".pop(queue_name text),\n    ").concat(u,".send(queue_name text, message jsonb, sleep_seconds integer),\n    ").concat(u,".send_batch(queue_name text, message jsonb[], sleep_seconds integer),\n    ").concat(u,".archive(queue_name text, message_id bigint),\n    ").concat(u,".delete(queue_name text, message_id bigint),\n    ").concat(u,".read(queue_name text, sleep integer, n integer)\n  ;\n\n  -- Revoke execute permissions on inner pgmq functions to roles (inverse of enabling)\n  do $$\n  begin\n      if exists (select 1 from pg_namespace where nspname = 'pgmq') then\n          -- Revoke privileges on the schema itself\n          revoke all on schema pgmq from anon, authenticated, service_role;\n          \n          -- Revoke default privileges for future objects\n          alter default privileges in schema pgmq revoke all on tables from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on sequences from anon, authenticated, service_role;\n          alter default privileges in schema pgmq revoke all on functions from anon, authenticated, service_role;\n      end if;\n  end $$;\n\n  drop schema if exists ").concat(u,";\n"));async function p(e){let{projectRef:t,connectionString:n,enable:r}=e,{result:a}=await (0,i.R)({projectRef:t,connectionString:n,sql:r?m:f,queryKey:["toggle-queues-exposure"]});return a}let h=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,r.NL)();return(0,a.D)(e=>p(e),{async onSuccess(t,n,r){let{projectRef:a}=n;await s.invalidateQueries(c.a.exposePostgrestStatus(a)),s.invalidateQueries(d.A.schemas(a)),await (null==e?void 0:e(t,n,r))},async onError(e,n,r){void 0===t?o.Am.error("Failed to toggle queue exposure via PostgREST: ".concat(e.message)):t(e,n,r)},...n})}},81899:function(e,t,n){n.d(t,{a:function(){return r}});let r={create:()=>["queues","create"],delete:e=>["queues",e,"delete"],purge:e=>["queues",e,"purge"],getMessagesInfinite:(e,t,n)=>["projects",e,"queue-messages",t,n].filter(Boolean),list:e=>["projects",e,"queues"],metrics:(e,t)=>["projects",e,"queue-metrics",t],exposePostgrestStatus:e=>["projects",e,"queue-expose-status"]}},19878:function(e,t,n){n.d(t,{XJ:function(){return i}});var r=n(28894),a=n(29020),o=n(30344);let s=e=>{let{schema:t}=e;if(!t)throw Error("schema is required");return"\nSELECT \n  con.oid as id, \n  con.conname as constraint_name, \n  con.confdeltype as deletion_action,\n  con.confupdtype as update_action,\n  rel.oid as source_id,\n  nsp.nspname as source_schema, \n  rel.relname as source_table, \n  (\n    SELECT \n      array_agg(\n        att.attname \n        ORDER BY \n          un.ord\n      ) \n    FROM \n      unnest(con.conkey) WITH ORDINALITY un (attnum, ord) \n      INNER JOIN pg_attribute att ON att.attnum = un.attnum \n    WHERE \n      att.attrelid = rel.oid\n  ) source_columns, \n  frel.oid as target_id,\n  fnsp.nspname as target_schema, \n  frel.relname as target_table, \n  (\n    SELECT \n      array_agg(\n        att.attname \n        ORDER BY \n          un.ord\n      ) \n    FROM \n      unnest(con.confkey) WITH ORDINALITY un (attnum, ord) \n      INNER JOIN pg_attribute att ON att.attnum = un.attnum \n    WHERE \n      att.attrelid = frel.oid\n  ) target_columns \nFROM \n  pg_constraint con \n  INNER JOIN pg_class rel ON rel.oid = con.conrelid \n  INNER JOIN pg_namespace nsp ON nsp.oid = rel.relnamespace \n  INNER JOIN pg_class frel ON frel.oid = con.confrelid \n  INNER JOIN pg_namespace fnsp ON fnsp.oid = frel.relnamespace \nWHERE \n  con.contype = 'f'\n  AND nsp.nspname = '".concat(t,"'\n").trim()};async function l(e,t){let{projectRef:n,connectionString:r,schema:o}=e,l=s({schema:o}),{result:i}=await (0,a.R)({projectRef:n,connectionString:r,sql:l,queryKey:["foreign-key-constraints",o]},t);return(null!=i?i:[]).map(e=>({...e,source_columns:e.source_columns.replace("{","").replace("}","").split(","),target_columns:e.target_columns.replace("{","").replace("}","").split(",")}))}let i=function(e){let{projectRef:t,connectionString:n,schema:a}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.a)(o.A.foreignKeyConstraints(t,a),e=>{let{signal:r}=e;return l({projectRef:t,connectionString:n,schema:a},r)},{enabled:s&&void 0!==t&&void 0!==a,...i})}},18829:function(e,t,n){n.d(t,{Q:function(){return r}});let r={tableEditor:(e,t)=>["projects",e,"table-editor",t]}},59650:function(e,t,n){n.d(t,{IV:function(){return i},nq:function(){return d},iB:function(){return c}});var r=n(28894),a=n(29020),o=n(18829),s=n(15538),l=n.n(s);async function i(e,t){var n,r;let{projectRef:o,connectionString:s,id:i}=e;if(!i)throw Error("id is required");let c=i?l()("\n    with base_table_info as (\n        select \n            c.oid::int8 as id,\n            nc.nspname as schema,\n            c.relname as name,\n            c.relkind,\n            c.relrowsecurity as rls_enabled,\n            c.relforcerowsecurity as rls_forced,\n            c.relreplident,\n            c.relowner,\n            obj_description(c.oid) as comment\n        from pg_class c\n        join pg_namespace nc on nc.oid = c.relnamespace\n        where c.oid = ".concat(i,"\n            and not pg_is_other_temp_schema(nc.oid)\n            and (\n                pg_has_role(c.relowner, 'USAGE')\n                or has_table_privilege(\n                    c.oid,\n                    'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n                )\n                or has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n            )\n    ),\n    table_stats as (\n        select \n            b.id,\n            case\n                when b.relreplident = 'd' then 'DEFAULT'\n                when b.relreplident = 'i' then 'INDEX'\n                when b.relreplident = 'f' then 'FULL'\n                else 'NOTHING'\n            end as replica_identity,\n            pg_total_relation_size(format('%I.%I', b.schema, b.name))::int8 as bytes,\n            pg_size_pretty(pg_total_relation_size(format('%I.%I', b.schema, b.name))) as size,\n            pg_stat_get_live_tuples(b.id) as live_rows_estimate,\n            pg_stat_get_dead_tuples(b.id) as dead_rows_estimate\n        from base_table_info b\n        where b.relkind in ('r', 'p')\n    ),\n    primary_keys as (\n        select \n            i.indrelid as table_id,\n            jsonb_agg(jsonb_build_object(\n                'schema', n.nspname,\n                'table_name', c.relname,\n                'table_id', i.indrelid::int8,\n                'name', a.attname\n            )) as primary_keys\n        from pg_index i\n        join pg_class c on i.indrelid = c.oid\n        join pg_attribute a on (a.attrelid = c.oid and a.attnum = any(i.indkey))\n        join pg_namespace n on c.relnamespace = n.oid\n        where i.indisprimary\n        group by i.indrelid\n    ),\n    relationships as (\n        select \n            c.conrelid as source_id,\n            c.confrelid as target_id,\n            jsonb_build_object(\n                'id', c.oid::int8,\n                'constraint_name', c.conname,\n                'deletion_action', c.confdeltype,\n                'update_action', c.confupdtype,\n                'source_schema', nsa.nspname,\n                'source_table_name', csa.relname,\n                'source_column_name', sa.attname,\n                'target_table_schema', nta.nspname,\n                'target_table_name', cta.relname,\n                'target_column_name', ta.attname\n            ) as rel_info\n        from pg_constraint c\n        join pg_class csa on c.conrelid = csa.oid\n        join pg_namespace nsa on csa.relnamespace = nsa.oid\n        join pg_attribute sa on (sa.attrelid = c.conrelid and sa.attnum = any(c.conkey))\n        join pg_class cta on c.confrelid = cta.oid\n        join pg_namespace nta on cta.relnamespace = nta.oid\n        join pg_attribute ta on (ta.attrelid = c.confrelid and ta.attnum = any(c.confkey))\n        where c.contype = 'f'\n    ),\n    columns as (\n        select \n            a.attrelid as table_id,\n            jsonb_agg(jsonb_build_object(\n                'id', (a.attrelid || '.' || a.attnum),\n                'table_id', c.oid::int8,\n                'schema', nc.nspname,\n                'table', c.relname,\n                'ordinal_position', a.attnum,\n                'name', a.attname,\n                'default_value', case \n                    when a.atthasdef then pg_get_expr(ad.adbin, ad.adrelid)\n                    else null\n                end,\n                'data_type', case \n                    when t.typtype = 'd' then \n                        case \n                            when bt.typelem <> 0::oid and bt.typlen = -1 then 'ARRAY'\n                            when nbt.nspname = 'pg_catalog' then format_type(t.typbasetype, null)\n                            else 'USER-DEFINED'\n                        end\n                    else \n                        case \n                            when t.typelem <> 0::oid and t.typlen = -1 then 'ARRAY'\n                            when nt.nspname = 'pg_catalog' then format_type(a.atttypid, null)\n                            else 'USER-DEFINED'\n                        end\n                end,\n                'format', coalesce(bt.typname, t.typname),\n                'is_identity', a.attidentity in ('a', 'd'),\n                'identity_generation', case a.attidentity\n                    when 'a' then 'ALWAYS'\n                    when 'd' then 'BY DEFAULT'\n                    else null\n                end,\n                'is_generated', a.attgenerated in ('s'),\n                'is_nullable', not (a.attnotnull or t.typtype = 'd' and t.typnotnull),\n                'is_updatable', (\n                    b.relkind in ('r', 'p') or \n                    (b.relkind in ('v', 'f') and pg_column_is_updatable(b.id, a.attnum, false))\n                ),\n                'is_unique', uniques.table_id is not null,\n                'check', check_constraints.definition,\n                'comment', col_description(c.oid, a.attnum),\n                'enums', coalesce(\n                    (\n                        select jsonb_agg(e.enumlabel order by e.enumsortorder)\n                        from pg_catalog.pg_enum e\n                        where e.enumtypid = coalesce(bt.oid, t.oid)\n                            or e.enumtypid = coalesce(bt.typelem, t.typelem)\n                    ),\n                    '[]'::jsonb\n                )\n            ) order by a.attnum) as columns\n        from pg_attribute a\n        join base_table_info b on a.attrelid = b.id\n        join pg_class c on a.attrelid = c.oid\n        join pg_namespace nc on c.relnamespace = nc.oid\n        left join pg_attrdef ad on (a.attrelid = ad.adrelid and a.attnum = ad.adnum)\n        join pg_type t on a.atttypid = t.oid\n        join pg_namespace nt on t.typnamespace = nt.oid\n        left join pg_type bt on (t.typtype = 'd' and t.typbasetype = bt.oid)\n        left join pg_namespace nbt on bt.typnamespace = nbt.oid\n        left join (\n            select \n                conrelid as table_id,\n                conkey[1] as ordinal_position\n            from pg_catalog.pg_constraint\n            where contype = 'u' and cardinality(conkey) = 1\n        ) as uniques on uniques.table_id = a.attrelid and uniques.ordinal_position = a.attnum\n        left join (\n            select distinct on (conrelid, conkey[1])\n                conrelid as table_id,\n                conkey[1] as ordinal_position,\n                substring(\n                    pg_get_constraintdef(oid, true),\n                    8,\n                    length(pg_get_constraintdef(oid, true)) - 8\n                ) as definition\n            from pg_constraint\n            where contype = 'c' and cardinality(conkey) = 1\n            order by conrelid, conkey[1], oid asc\n        ) as check_constraints on check_constraints.table_id = a.attrelid \n                            and check_constraints.ordinal_position = a.attnum\n        where a.attnum > 0 \n        and not a.attisdropped\n        group by a.attrelid\n    )\n    select \n        case b.relkind\n            when 'r' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'rls_enabled', b.rls_enabled,\n                'rls_forced', b.rls_forced,\n                'replica_identity', ts.replica_identity,\n                'bytes', ts.bytes,\n                'size', ts.size,\n                'live_rows_estimate', ts.live_rows_estimate,\n                'dead_rows_estimate', ts.dead_rows_estimate,\n                'comment', b.comment,\n                'primary_keys', coalesce(pk.primary_keys, '[]'::jsonb),\n                'relationships', coalesce(\n                    (select jsonb_agg(r.rel_info)\n                    from relationships r\n                    where r.source_id = b.id or r.target_id = b.id), \n                    '[]'::jsonb\n                ),\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'p' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'rls_enabled', b.rls_enabled,\n                'rls_forced', b.rls_forced,\n                'replica_identity', ts.replica_identity,\n                'bytes', ts.bytes,\n                'size', ts.size,\n                'live_rows_estimate', ts.live_rows_estimate,\n                'dead_rows_estimate', ts.dead_rows_estimate,\n                'comment', b.comment,\n                'primary_keys', coalesce(pk.primary_keys, '[]'::jsonb),\n                'relationships', coalesce(\n                    (select jsonb_agg(r.rel_info)\n                    from relationships r\n                    where r.source_id = b.id or r.target_id = b.id), \n                    '[]'::jsonb\n                ),\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'v' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'is_updatable', (pg_relation_is_updatable(b.id, false) & 20) = 20,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'm' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'is_populated', true,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'f' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n        end as entity\n    from base_table_info b\n    left join table_stats ts on b.id = ts.id\n    left join primary_keys pk on b.id = pk.table_id\n    left join columns c on b.id = c.table_id;\n  ")):"",{result:d}=await (0,a.R)({projectRef:o,connectionString:s,sql:c,queryKey:["table-editor",i]},t);return null!==(r=null===(n=d[0])||void 0===n?void 0:n.entity)&&void 0!==r?r:void 0}let c=function(e){let{projectRef:t,connectionString:n,id:a}=e,{enabled:s=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.a)(o.Q.tableEditor(t,a),e=>{let{signal:r}=e;return i({projectRef:t,connectionString:n,id:a},r)},{enabled:s&&void 0!==t&&void 0!==a&&!isNaN(a),staleTime:3e5,...l})};function d(e,t){let{projectRef:n,connectionString:r,id:a}=t;return e.fetchQuery(o.Q.tableEditor(n,a),e=>{let{signal:t}=e;return i({projectRef:n,connectionString:r,id:a},t)})}},69171:function(e,t,n){n.d(t,{D1:function(){return i},Du:function(){return s},GV:function(){return o},N3:function(){return a},z_:function(){return l}});var r=n(7514);function a(e){return(null==e?void 0:e.entity_type)===r.l.TABLE||(null==e?void 0:e.entity_type)===r.l.PARTITIONED_TABLE}function o(e){return(null==e?void 0:e.entity_type)===r.l.FOREIGN_TABLE}function s(e){return(null==e?void 0:e.entity_type)===r.l.VIEW}function l(e){return(null==e?void 0:e.entity_type)===r.l.MATERIALIZED_VIEW}function i(e){return s(e)||l(e)}},55638:function(e,t,n){n.d(t,{rp:function(){return i}});var r=n(64618),a=n(34549),o=n(44767),s=n(29020);async function l(e){let{projectRef:t,connectionString:n,table:r,column:a,pkMatch:l}=e,i=function(e){var t;let{table:n,column:r,pkMatch:a}=e;return new o.A().from(n.name,null!==(t=n.schema)&&void 0!==t?t:void 0).select('"'.concat(r,'"')).match(a).toSql()}({table:r,column:a,pkMatch:l}),{result:c}=await (0,s.R)({projectRef:t,connectionString:n,sql:i});return null==c?void 0:c[0][a]}let i=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.D)(e=>l(e),{async onSuccess(t,n,r){await (null==e?void 0:e(t,n,r))},async onError(e,n,r){void 0===t?a.Am.error(e.message):t(e,n,r)},...n})}},24158:function(e,t,n){n.d(t,{s:function(){return r}});let r={tableRows:function(e){let{table:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["projects",e,"table-rows",null==t?void 0:t.id,"rows",n]},tableRowsCount:function(e){let{table:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["projects",e,"table-rows",null==t?void 0:t.id,"count",n]},tableRowsAndCount:(e,t)=>["projects",e,"table-rows",t]}},99576:function(e,t,n){n.d(t,{Fi:function(){return f},HS:function(){return g}});var r=n(36457),a=n(28894),o=n(44767),s=n(4673),l=n(59650),i=n(190),c=n(15997),d=n(29020),u=n(24158),m=n(24519);let f=5e4,p="\nCREATE OR REPLACE FUNCTION pg_temp.count_estimate(\n    query text\n) RETURNS integer LANGUAGE plpgsql AS $$\nDECLARE\n    plan jsonb;\nBEGIN\n    EXECUTE 'EXPLAIN (FORMAT JSON)' || query INTO plan;\n    RETURN plan->0->'Plan'->'Plan Rows';\nEND;\n$$;\n".trim(),h=e=>{var t,n,r;let{table:a,filters:s=[],enforceExactCount:l=!1}=e;if(!a)return"";if(l){let e=new o.A().from(a.name,null!==(t=a.schema)&&void 0!==t?t:void 0).count();return s.filter(e=>e.value&&""!==e.value).forEach(t=>{let n=(0,m.q)(a,t);e=e.filter(t.column,t.operator,n)}),"select (".concat(e.toSql().slice(0,-1),"), false as is_estimate;")}{let e=new o.A().from(a.name,null!==(n=a.schema)&&void 0!==n?n:void 0).select("*");s.filter(e=>e.value&&""!=e.value).forEach(t=>{let n=(0,m.q)(a,t);e=e.filter(t.column,t.operator,n)});let t=e.toSql(),l=new o.A().from(a.name,null!==(r=a.schema)&&void 0!==r?r:void 0).count();s.filter(e=>e.value&&""!=e.value).forEach(e=>{let t=(0,m.q)(a,e);l=l.filter(e.column,e.operator,t)});let i=l.toSql().slice(0,-1);return"\n".concat(p,"\n\nwith approximation as (\n    select reltuples as estimate\n    from pg_class\n    where oid = ").concat(a.id,"\n)\nselect \n  case \n    when estimate = -1 then (select pg_temp.count_estimate('").concat(t.replaceAll("'","''"),"'))\n    when estimate > ").concat(f," then ").concat(s.length>0?"pg_temp.count_estimate('".concat(t.replaceAll("'","''"),"')"):"estimate","\n    else (").concat(i,")\n  end as count,\n  estimate = -1 or estimate > ").concat(f," as is_estimate\nfrom approximation;\n").trim()}};async function x(e,t){var n;let{queryClient:r,projectRef:a,connectionString:o,tableId:u,filters:m,impersonatedRole:f,enforceExactCount:p}=e,x=await (0,l.nq)(r,{projectRef:a,connectionString:o,id:u});if(!x)throw Error("Table not found");let g=(0,s.NK)(x),y=(0,i.Jh)(h({table:g,filters:m,enforceExactCount:p}),{projectRef:null!=a?a:"ref",role:f}),{result:v}=await (0,d.R)({projectRef:a,connectionString:o,sql:y,queryKey:["table-rows-count",g.id],isRoleImpersonationEnabled:(0,c.Gm)(f)},t);return{count:v[0].count,is_estimate:null!==(n=v[0].is_estimate)&&void 0!==n&&n}}let g=function(e){let{projectRef:t,connectionString:n,tableId:o,...s}=e,{enabled:l=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=(0,r.NL)();return(0,a.a)(u.s.tableRowsCount(t,{table:{id:o},...s}),e=>{let{signal:r}=e;return x({queryClient:c,projectRef:t,connectionString:n,tableId:o,...s},r)},{enabled:l&&void 0!==t&&void 0!==o,...i})}},50853:function(e,t,n){n.d(t,{no:function(){return g},wF:function(){return v},Ue:function(){return w},KK:function(){return _}});var r=n(36457),a=n(28894),o=n(45925),s=n(44767),l=n(4673),i=n(46235),c=n(59650),d=n(77946),u=n(190),m=n(15997),f=n(29020),p=n(24158),h=n(99576),x=n(24519);let g=10*d.KB,y=e=>{var t;let n=e.columns.filter(e=>null==e?void 0:e.isPrimaryKey).map(e=>e.name);return 0!==n.length?n:[null===(t=e.columns[0])||void 0===t?void 0:t.name]},v=async e=>{var t;let{projectRef:n,connectionString:r,table:a,filters:l=[],sorts:i=[],impersonatedRole:c}=e;if(o.Qy&&!r)return console.error("Connection string is required"),[];let d=[],m=new s.A,p=a.columns.filter(e=>{var t;return(null!==(t=null==e?void 0:e.enum)&&void 0!==t?t:[]).length>0&&"array"===e.dataType.toLowerCase()}).map(e=>'"'.concat(e.name,'"::text[]')),g=m.from(a.name,null!==(t=a.schema)&&void 0!==t?t:void 0).select(p.length>0?"*,".concat(p.join(",")):"*");if(l.filter(e=>e.value&&""!==e.value).forEach(e=>{let t=(0,x.q)(a,e);g=g.filter(e.column,e.operator,t)}),0===i.length&&a.estimateRowCount<=h.Fi){let e=y(a);e.length>0&&e.forEach(e=>{g=g.order(a.name,e,!0,!0)})}else i.forEach(e=>{g=g.order(e.table,e.column,e.ascending,e.nullsFirst)});let v=-1,b=0,j=0,_=[];return await (async()=>{do{v+=1,b=500*v,j=(v+1)*500-1;let e=(0,u.Jh)(g.range(b,j).toSql(),{projectRef:n,role:c});try{let{result:t}=await (0,f.R)({projectRef:n,connectionString:r,sql:e});d.push(...t),_=t}catch(e){return{data:{rows:[]}}}}while(500===_.length)})(),d.filter(e=>1!==e[u.$y])},b=e=>{var t;let{table:n,filters:r=[],sorts:a=[],page:o,limit:l}=e,c=new s.A;if(!n)return"";let d=n.columns.filter(e=>{var t;return(null!==(t=null==e?void 0:e.enum)&&void 0!==t?t:[]).length>0&&"array"===e.dataType.toLowerCase()}).map(e=>'"'.concat(e.name,'"::text[]')),u=c.from(n.name,null!==(t=n.schema)&&void 0!==t?t:void 0).select(d.length>0?"*,".concat(d.join(",")):"*");if(r.filter(e=>e.value&&""!=e.value).forEach(e=>{let t=(0,x.q)(n,e);u=u.filter(e.column,e.operator,t)}),0===a.length&&n.estimateRowCount<=h.Fi&&n.columns.length>0){let e=y(n);e.length>0&&e.forEach(e=>{u=u.order(n.name,e,!0,!0)})}else a.forEach(e=>{u=u.order(e.table,e.column,e.ascending,e.nullsFirst)});let{from:m,to:f}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=e?e*t:0;return{from:n,to:e?n+t-1:t-1}}((null!=o?o:1)-1,l),p=u.range(m,f).toSql(),v=n.columns.filter(e=>i.BB.includes(e.format)||i.YF.includes(e.format)).map(e=>'case when length("'.concat(e.name,'"::text) > ').concat(g,' then concat(left("').concat(e.name,'"::text, ').concat(g,"), '...') else \"").concat(e.name,'"::text end "').concat(e.name,'"'));return v.length>0?"with _temp as (".concat(p.slice(0,-1),") select *, ").concat(v.join(",")," from _temp"):p};async function j(e,t){let{queryClient:n,projectRef:r,connectionString:a,tableId:o,impersonatedRole:s,filters:i,sorts:d,limit:p,page:h}=e,x=await (0,c.nq)(n,{projectRef:r,connectionString:a,id:o});if(!x)throw Error("Table not found");let g=(0,l.NK)(x),y=(0,u.Jh)(b({table:g,filters:i,sorts:d,limit:p,page:h,impersonatedRole:s}),{projectRef:null!=r?r:"ref",role:s}),{result:v}=await (0,f.R)({projectRef:r,connectionString:a,sql:y,queryKey:["table-rows",null==g?void 0:g.id],isRoleImpersonationEnabled:(0,m.Gm)(s)},t);return{rows:v.map((e,t)=>({idx:t,...e}))}}let _=function(e){let{projectRef:t,connectionString:n,tableId:o,...s}=e,{enabled:l=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=(0,r.NL)();return(0,a.a)(p.s.tableRows(t,{table:{id:o},...s}),e=>{let{signal:r}=e;return j({queryClient:c,projectRef:t,connectionString:n,tableId:o,...s},r)},{enabled:l&&void 0!==t&&void 0!==o,...i})};function w(e,t){let{projectRef:n,connectionString:r,tableId:a,impersonatedRole:o,...s}=t;return e.fetchQuery(p.s.tableRows(n,{table:{id:a},...s}),t=>{let{signal:o}=t;return j({queryClient:e,projectRef:n,connectionString:r,tableId:a,...s},o)})}},24519:function(e,t,n){n.d(t,{h:function(){return s},q:function(){return o}});var r=n(68417),a=n(69171);function o(e,t){let n=e.columns.find(e=>e.name==t.column);if(n&&(0,r.v3)(n.format)){let e=Number(t.value);if(!Number.isNaN(e)&&!(e>Number.MAX_SAFE_INTEGER))return Number(t.value)}return t.value}function s(e){let{table:t}=e;if(!(0,a.N3)(t))return{error:{message:"Only table rows can be updated or deleted"}};let n=t.primary_keys;return n&&0!=n.length?{primaryKeys:n.map(e=>e.name)}:{error:{message:"Please add a primary key column to your table to update or delete rows"}}}},10012:function(e,t,n){n.d(t,{B:function(){return i}});var r=n(73860),a=n(52983),o=n(45925),s=n(77946);let l=e=>(0,r.v1)("schema",r.Oi.withDefault(e)),i=()=>{let{ref:e}=(0,o.UO)(),t=e&&e.length>0&&window.localStorage.getItem(s.dA.LAST_SELECTED_SCHEMA(e))||"public",[n,r]=l((0,a.useMemo)(()=>t,[e]));return(0,a.useEffect)(()=>{e&&e.length>0&&window.localStorage.setItem(s.dA.LAST_SELECTED_SCHEMA(e),n)},[n,e]),{selectedSchema:n,setSelectedSchema:r}}},43428:function(e,t,n){n.d(t,{T:function(){return a},s:function(){return r}});let r=["auth","cron","extensions","information_schema","net","pgsodium","pgsodium_masks","pgbouncer","pgtle","realtime","storage","supabase_functions","supabase_migrations","vault","graphql","graphql_public",n(60816).LW],a=r.filter(e=>"extensions"!==e)},69468:function(e,t,n){n.d(t,{z:function(){return M},v:function(){return F}});var r=n(97458),a=n(52983),o=n(29442),s=n(63969),l=n(63730),i=n(45925),c=n(20170),d=n(50853),u=n(46327),m=n(15997),f=n(44190),p=n(4673),h=n(27299),x=n(99429),g=n(74884);function y(e){let{gridRef:t}=e,{rows:n,gridColumns:r,selectedCellPosition:o}=(0,h.Qq)(),[s,l]=a.useState("Command");return a.useEffect(()=>{var e,t;l("windows"==((null===(e=navigator)||void 0===e?void 0:e.appVersion.indexOf("Win"))!==-1?"windows":(null===(t=navigator)||void 0===t?void 0:t.appVersion.indexOf("Mac"))!==-1?"macos":"unknown")?"Control":"Command")},[]),(0,g.a)({["".concat(s,"+ArrowUp")]:e=>{if(e.stopPropagation(),o){var n;let e={idx:null!==(n=null==o?void 0:o.idx)&&void 0!==n?n:0,rowIdx:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(0)})},["".concat(s,"+ArrowDown")]:e=>{if(e.stopPropagation(),o){var r;let e={idx:null!==(r=null==o?void 0:o.idx)&&void 0!==r?r:0,rowIdx:n.length>1?n.length-1:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(n.length)})},["".concat(s,"+ArrowLeft")]:e=>{var n;e.stopPropagation();let a={idx:r.filter(e=>e.frozen).length,rowIdx:null!==(n=null==o?void 0:o.rowIdx)&&void 0!==n?n:0};t.current.selectCell(a)},["".concat(s,"+ArrowRight")]:e=>{var n,a;e.stopPropagation(),null===(n=t.current)||void 0===n||n.selectCell({idx:r.length-1,rowIdx:null!==(a=null==o?void 0:o.rowIdx)&&void 0!==a?a:0})},["".concat(s,"+c")]:e=>{if(e.stopPropagation(),o){let{idx:e,rowIdx:s}=o;if(e>0){var t,a;let o=r[e].key,l=null!==(a=null===(t=n[s])||void 0===t?void 0:t[o])&&void 0!==a?a:"",i=(0,x.Lw)(l);(0,x.vQ)(i)}}}},["INPUT","TEXTAREA","SELECT"]),null}var v=n(65663),b=n(12832),j=n(44914),_=n(87595),w=n(56311),N=n(27818),C=n(61223),E=n(19878),S=n(47878),k=n(5546),R=n(19168),A=n(70717),T=n(54931);function L(e,t){let{show:n}=(0,A.av)();return(0,r.jsx)(j.X2,{...t,onContextMenu:function(e){n(e,{id:T.ep,props:{rowIdx:t.rowIdx}})},"data-sentry-element":"Row","data-sentry-component":"RowRenderer","data-sentry-source-file":"RowRenderer.tsx"},e)}let I=e=>{var t;return null!==(t=null==e?void 0:e.idx)&&void 0!==t?t:-1},O=(0,b.Z)((e,t,n)=>{n({type:"UPDATE_COLUMN_SIZE",payload:{index:e,width:Math.round(t)}})},500),q=(0,_.X$)((0,a.forwardRef)((e,t)=>{var n;let{width:o,height:s,containerClass:l,gridClass:i,rowClass:d,rows:u,error:m,isLoading:f,isSuccess:p,isError:y,filters:v,setParams:b,updateRow:_,onAddRow:A,onImportData:T,onEditForeignKeyColumnValue:q}=e,P=(0,h.I0)(),D=(0,h.Qq)();async function z(e,t){let n=e[t.indexes[0]],r=u.find(e=>e.idx==n.idx),a=Object.keys(n).find(e=>n[e]!==r[e]);a&&_(r,{[a]:n[a]})}let F=(0,a.useRef)(null);function Z(){var e,t,n,r;let a=null===(r=F.current)||void 0===r?void 0:null===(n=r.row)||void 0===n?void 0:n[null===(t=F.current)||void 0===t?void 0:null===(e=t.column)||void 0===e?void 0:e.key],o=(0,x.Lw)(a);o&&(0,S.vQ)(o)}(0,g.a)({"Command+c":e=>{e.stopPropagation(),Z()},"Control+c":e=>{e.stopPropagation(),Z()}},["INPUT","TEXTAREA"]);let M=D.table,{project:U}=(0,c.d2)(),{data:W}=(0,E.XJ)({projectRef:null==U?void 0:U.ref,connectionString:null==U?void 0:U.connectionString,schema:null!==(n=null==M?void 0:M.schema)&&void 0!==n?n:void 0}),K=()=>{b(e=>({...e,filter:[]}))};return(0,r.jsx)("div",{className:(0,k.cn)("flex flex-col",l),style:{width:o||"100%",height:s||"50vh"},children:(0,r.jsx)(j.ZP,{ref:t,className:"".concat(i," flex-grow"),rowClass:d,columns:D.gridColumns,rows:null!=u?u:[],renderers:{renderRow:L,noRowsFallback:(0,r.jsxs)("div",{style:{width:"calc(100vw - 255px - 55px)"},children:[f&&(0,r.jsx)(w.U,{}),y&&(0,r.jsx)("div",{className:"p-2 col-span-full",children:(0,r.jsx)(C.Z,{error:m,subject:"Failed to retrieve rows from table"})}),p&&(0,r.jsx)(r.Fragment,{children:0===(null!=v?v:[]).length?(0,r.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"flex flex-col items-center justify-center col-span-full",children:[(0,r.jsx)("p",{className:"text-sm text-light",children:"This table is empty"}),void 0!==A&&void 0!==T&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-sm text-light mt-1",children:"Add rows to your table to get started."}),(0,r.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:void 0!==A&&void 0!==T&&(0,r.jsx)(R.z,{type:"default",onClick:T,children:"Import data via CSV"})})]})]}):(0,r.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"flex flex-col items-center justify-center col-span-full",children:[(0,r.jsx)("p",{className:"text-sm text-light",children:"The filters applied have returned no results from this table"}),(0,r.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,r.jsx)(R.z,{type:"default",onClick:()=>K(),children:"Remove all filters"})})]})})]})},rowKeyGetter:I,selectedRows:D.selectedRows,onColumnResize:function(e,t){O(e,t,P)},onRowsChange:z,onSelectedCellChange:function(e){F.current=e,P({type:"SELECTED_CELL_CHANGE",payload:{position:{idx:e.column.idx,rowIdx:e.rowIdx}}})},onSelectedRowsChange:function(e){P({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:e}})},onCellDoubleClick:e=>(function(e,t){let n=function(e){var t,n;let{targetTableSchema:r,targetTableName:a,targetColumnName:o}=null!==(n=null==M?void 0:null===(t=M.columns.find(t=>t.name==e))||void 0===t?void 0:t.foreignKey)&&void 0!==n?n:{},s=null==W?void 0:W.find(t=>t.source_schema===(null==M?void 0:M.schema)&&t.source_table===(null==M?void 0:M.name)&&t.source_columns.includes(e)&&t.target_schema===r&&t.target_table===a&&t.target_columns.includes(o));return void 0!==s?(0,N.S)([s])[0]:void 0}(t.name);n&&q({foreignKey:n,row:e,column:t})})(e.row,e.column)})})}));var P=n(18826),D=n(90897),z=n(90476);function F(e,t,n){let r=(0,p.x4)(D.E_,e),a=localStorage.getItem(r);if(a)return JSON.parse(a)[n&&"public"!=n?"".concat(n,".").concat(t):t]}async function Z(e,t,n,r,a){var o,s;let l=e.projectRef?F(e.projectRef,e.table.name,e.table.schema):void 0;if(!t.isInitialComplete&&void 0===r&&void 0===a&&((null==l?void 0:l.sorts)||(null==l?void 0:l.filters)))return{savedState:{sorts:l.sorts,filters:l.filters}};let i=(0,z.cv)(e.table,{projectRef:e.projectRef,tableId:e.tableId,editable:e.editable,defaultWidth:null===(o=e.gridProps)||void 0===o?void 0:o.defaultColumnWidth,onAddColumn:e.editable?e.onAddColumn:void 0,onExpandJSONEditor:e.onExpandJSONEditor,onExpandTextEditor:e.onExpandTextEditor});return n({type:"INIT_TABLE",payload:{table:e.table,gridProps:e.gridProps,gridColumns:i,savedState:l,editable:e.editable,onError:null!==(s=e.onError)&&void 0!==s?s:e=>{console.error("Supabase grid error: ",e)}}}),{savedState:{}}}let M=e=>{let t=(0,p.cc)(e);return(0,r.jsx)(h.g3,{"data-sentry-element":"StoreProvider","data-sentry-component":"SupabaseGrid","data-sentry-source-file":"SupabaseGrid.tsx",children:(0,r.jsx)(o.W,{backend:s.PD,context:window,"data-sentry-element":"DndProvider","data-sentry-source-file":"SupabaseGrid.tsx",children:(0,r.jsx)(U,{...t,"data-sentry-element":"SupabaseGridLayout","data-sentry-source-file":"SupabaseGrid.tsx"})})})},U=e=>{var t,n,o;let{editable:s,projectRef:x,gridProps:g,headerActions:b,showCustomChildren:j,customHeader:_,children:w,onAddRow:N,onAddColumn:C,updateTableRow:E,onEditForeignKeyColumnValue:S,onImportData:k}=e,{id:R}=(0,i.UO)(),A=(0,h.I0)(),L=(0,h.Qq)(),I=(0,f._2)(),O=(0,a.useRef)(null),[D,z]=(0,a.useState)(!1),[{sort:F,filter:M},U]=(0,u.x)({arrayKeys:["sort","filter"]}),W=(0,p.rg)(e.table.name,F),K=(0,p.Yb)(M),$=(0,m.fN)(),{project:B}=(0,c.d2)(),{data:H,error:J,isSuccess:V,isError:Y,isLoading:G,isRefetching:Q}=(0,d.KK)({projectRef:null==B?void 0:B.ref,connectionString:null==B?void 0:B.connectionString,tableId:e.table.id,sorts:W,filters:K,page:I.page,limit:I.rowsPerPage,impersonatedRole:$.role},{keepPreviousData:!0,retryDelay:(e,t)=>{var n;return(t&&(null===(n=t.message)||void 0===n?void 0:n.includes("does not exist"))&&U(e=>({...e,sort:void 0})),e>3)?1/0:5e3},onSuccess(e){A({type:"SET_ROWS_COUNT",payload:e.rows.length})}});return(0,a.useEffect)(()=>{D||z(!0)},[]),(0,a.useEffect)(()=>{D&&A({type:"UPDATE_FILTERS",payload:{}})},[JSON.stringify(K)]),(0,a.useEffect)(()=>{D&&A({type:"UPDATE_SORTS",payload:{}})},[JSON.stringify(W)]),(0,a.useEffect)(()=>{L.isInitialComplete&&x&&L.table&&(0,p.Tf)(L,x,F,M)},[L.table,L.isInitialComplete,L.gridColumns,JSON.stringify(W),JSON.stringify(K),x]),(0,a.useEffect)(()=>{A({type:"INIT_CALLBACK",payload:{...e}})},[]),(0,a.useEffect)(()=>{let t=async()=>{let{savedState:t}=await Z({...e,tableId:R},L,A,F,M);(t.sorts||t.filters)&&U(e=>({...e,...t.sorts&&{sort:t.sorts},...t.filters&&{filter:t.filters}}))},n=JSON.stringify(e.table)!==JSON.stringify(L.table);(!L.table||n)&&t()},[L.table,e.table,e.schema]),(0,r.jsxs)("div",{className:"sb-grid h-full flex flex-col","data-sentry-component":"SupabaseGridLayout","data-sentry-source-file":"SupabaseGrid.tsx",children:[(0,r.jsx)(P.ZP,{table:e.table,sorts:W,filters:K,onAddRow:s&&(null!==(t=e.table.columns)&&void 0!==t?t:[]).length>0?N:void 0,onAddColumn:s?C:void 0,onImportData:s?k:void 0,headerActions:b,customHeader:_,"data-sentry-element":"Header","data-sentry-source-file":"SupabaseGrid.tsx"}),j&&void 0!==w?(0,r.jsx)(r.Fragment,{children:w}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q,{ref:O,...g,rows:null!==(n=null==H?void 0:H.rows)&&void 0!==n?n:[],error:J,isLoading:G,isSuccess:V,isError:Y,filters:K,setParams:U,updateRow:E,onAddRow:N,onImportData:k,onEditForeignKeyColumnValue:S}),(0,r.jsx)(v.Z,{isRefetching:Q}),(0,r.jsx)(y,{gridRef:O})]}),D&&(0,l.createPortal)((0,r.jsx)(T.q4,{rows:null!==(o=null==H?void 0:H.rows)&&void 0!==o?o:[]}),document.body)]})}},1680:function(e,t,n){n.d(t,{F:function(){return o}});var r=n(97458),a=n(77518);let o=e=>{let{children:t,side:n,align:o,options:s,onSelect:l}=e;return(0,r.jsxs)(a.h_,{"data-sentry-element":"DropdownMenu","data-sentry-component":"DropdownControl","data-sentry-source-file":"DropdownControl.tsx",children:[(0,r.jsx)(a.$F,{"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"DropdownControl.tsx",children:t}),(0,r.jsx)(a.AW,{side:n,align:o,"data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"DropdownControl.tsx",children:(0,r.jsxs)("div",{className:"dropdown-control",style:{maxHeight:"30vh"},children:[0===s.length&&(0,r.jsx)("p",{className:"dropdown-control__empty-text",children:"No more items"}),s.map(e=>(0,r.jsx)(a.Xi,{onClick:()=>l(e.value),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.preLabel&&(0,r.jsx)("span",{className:"grow text-foreground-lighter",children:e.preLabel}),(0,r.jsx)("span",{children:e.label}),e.postLabel&&(0,r.jsx)("span",{className:"text-foreground-lighter",children:e.postLabel})]})},e.value))]})})]})}},74884:function(e,t,n){n.d(t,{a:function(){return o}});var r=n(52983);function a(e,t){return e.indexOf(t)>=0}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[o,s]=r.useState(),l=r=>{if(!e||a(t,r.target.nodeName)||a(n,r.target.className))return;let o=r.metaKey&&r.shiftKey?"Command+Shift+".concat(r.key):r.metaKey?"Command+".concat(r.key):r.shiftKey&&"Enter"===r.key?"Shift+".concat(r.key):r.ctrlKey&&r.key?"Control+".concat(r.key):r.key;e[o]&&(o.includes("+")?(r.preventDefault(),e[o](r),s(null)):(s(r.key),r.preventDefault()))},i=t=>{e&&e[t.key]&&o===t.key&&(t.preventDefault(),e[t.key](t),s(null))};r.useEffect(()=>(window.addEventListener("keydown",l),window.addEventListener("keyup",i),()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",i)}))}},50047:function(e,t,n){n.d(t,{r:function(){return o}});var r=n(97458),a=n(85229);let o=e=>{let{width:t,height:n,value:o,language:s,readOnly:l=!1,onChange:i,onMount:c}=e;return(0,r.jsx)(a.default,{width:t,height:n||"200px",theme:"supabase",wrapperProps:{className:"grid-monaco-editor-container"},className:"grid-monaco-editor",defaultLanguage:s||"plaintext",defaultValue:o,onChange:i,onMount:function(e){e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})});let t=e.getModel().getPositionAt(null==o?void 0:o.length);e.setPosition(t),setTimeout(()=>{null==e||e.focus()},0),c&&c(e)},options:{readOnly:l,tabSize:2,fontSize:13,minimap:{enabled:!1},glyphMargin:!1,folding:!1,lineNumbers:"off",lineNumbersMinChars:0,scrollBeyondLastLine:!1,wordWrap:"on"},"data-sentry-element":"Editor","data-sentry-component":"MonacoEditor","data-sentry-source-file":"MonacoEditor.tsx"})}},65663:function(e,t,n){n.d(t,{Z:function(){return R}});var r=n(97458),a=n(45925),o=n(20170),s=n(30549),l=n(3553),i=n(59650),c=n(69171),d=n(46327),u=n(30805),m=n(60063),f=n(44216),p=n(39677),h=n(52983),x=n(4673),g=n(99576),y=n(15997),v=n(44190),b=n(19168),j=n(82445),_=n(30413),w=n(587),N=n(27299),C=n(1680);let E=e=>{if(0===e)return"0";let t=Math.floor(Math.log(e)/Math.log(1e3)),n=t>4?"T":["","K","M","B","T"][t];return"".concat((e/Math.pow(1e3,t>4?4:t)).toFixed(1)).concat(n)},S=[{value:100,label:"100 rows"},{value:500,label:"500 rows"},{value:1e3,label:"1000 rows"}];var k=()=>{var e,t;let{id:n}=(0,a.UO)(),s=n?Number(n):void 0,l=(0,N.Qq)(),u=(0,N.I0)(),{project:k}=(0,o.d2)(),R=(0,v._2)(),{data:A}=(0,i.iB)({projectRef:null==k?void 0:k.ref,connectionString:null==k?void 0:k.connectionString,id:s}),T=(0,c.N3)(A)?A.live_rows_estimate:null,[{filter:L}]=(0,d.x)({arrayKeys:["filter"]}),I=(0,x.Yb)(L),O=R.page,q=(0,y.fN)(),[P,D]=(0,h.useState)(!1),[z,F]=(0,h.useState)(!1),[Z,M]=(0,h.useState)(!1),[U,W]=(0,h.useState)(O.toString());(0,h.useEffect)(()=>{W(String(O))},[O]);let{data:K,isLoading:$,isSuccess:B,isError:H,isFetching:J}=(0,g.HS)({projectRef:null==k?void 0:k.ref,connectionString:null==k?void 0:k.connectionString,tableId:s,filters:I,enforceExactCount:R.enforceExactCount,impersonatedRole:q.role},{keepPreviousData:!0,onSuccess(e){u({type:"SET_ROWS_COUNT",payload:e.count})}}),V=(null==K?void 0:K.is_estimate)?E(K.count):null==K?void 0:K.count.toLocaleString(),Y=Math.ceil((null!==(e=null==K?void 0:K.count)&&void 0!==e?e:0)/R.rowsPerPage),G=(null!==(t=null==K?void 0:K.count)&&void 0!==t?t:0)>0?Y:1,Q=()=>{ee(),u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})},X=()=>{et(),u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})},ee=()=>{let e=O-1;R.setPage(e)},et=()=>{let e=O+1;R.setPage(e)},en=e=>{let t=e>Y?Y:e;R.setPage(t||1)};return(0,h.useEffect)(()=>{O&&O>G&&R.setPage(G)},[O,G]),(0,h.useEffect)(()=>{void 0!==s&&R.setEnforceExactCount(null!==T&&T<=g.Fi)},[s]),(0,r.jsxs)("div",{className:"flex items-center gap-x-4","data-sentry-component":"Pagination","data-sentry-source-file":"Pagination.tsx",children:[$&&(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Loading records count..."}),B&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)(b.z,{icon:(0,r.jsx)(m.Z,{}),type:"outline",className:"px-1.5",disabled:O<=1||$,onClick:()=>{O>1&&(l.selectedRows.size>=1?F(!0):ee())}}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Page"}),(0,r.jsx)(_.I,{className:"w-12",size:"tiny",min:1,max:Y,value:U,onChange:e=>W(e.target.value),onKeyDown:e=>{let t=Number(U);"Enter"===e.code&&!Number.isNaN(t)&&t>=1&&t<=Y&&en(t)}}),(0,r.jsxs)("p",{className:"text-xs text-foreground-light",children:["of ",G.toLocaleString()]}),(0,r.jsx)(b.z,{icon:(0,r.jsx)(f.Z,{}),type:"outline",className:"px-1.5",disabled:O>=Y||$,onClick:()=>{O<Y&&(l.selectedRows.size>=1?D(!0):et())}}),(0,r.jsx)(C.F,{options:S,onSelect:e=>{let t=Number(e);R.setRowsPerPage(isNaN(t)?100:t)},side:"top",align:"start",children:(0,r.jsx)(b.z,{asChild:!0,type:"outline",style:{padding:"3px 10px"},children:(0,r.jsx)("span",{children:"".concat(R.rowsPerPage," rows")})})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsxs)("p",{className:"text-xs text-foreground-light",children:["".concat(V," ").concat(0===K.count||K.count>1?"records":"record")," ",K.is_estimate?"(estimated)":""]}),K.is_estimate&&(0,r.jsxs)(j.u,{children:[(0,r.jsx)(j.aJ,{asChild:!0,children:(0,r.jsx)(b.z,{size:"tiny",type:"text",className:"px-1.5",loading:J,icon:(0,r.jsx)(p.Z,{}),onClick:()=>{null===T||K.count>g.Fi?M(!0):R.setEnforceExactCount(!0)}})}),(0,r.jsxs)(j._v,{side:"top",className:"w-72",children:["This is an estimated value as your table has more than"," ",g.Fi.toLocaleString()," rows. ",(0,r.jsx)("br",{}),(0,r.jsx)("span",{className:"text-brand",children:"Click to retrieve the exact count of the table."})]})]})]})]}),H&&(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Error fetching records count. Please refresh the page."}),(0,r.jsx)(w.Z,{visible:z,title:"Confirm moving to previous page",confirmLabel:"Confirm",onCancel:()=>F(!1),onConfirm:()=>{Q()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,r.jsx)(w.Z,{visible:P,title:"Confirm moving to next page",confirmLabel:"Confirm",onCancel:()=>D(!1),onConfirm:()=>{X()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,r.jsx)(w.Z,{variant:"warning",visible:Z,title:"Confirm to fetch exact count for table",confirmLabel:"Retrieve exact count",onCancel:()=>M(!1),onConfirm:()=>{R.setEnforceExactCount(!0),M(!1)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:null===T?"If your table has a row count of greater than ".concat(g.Fi.toLocaleString()," rows,\n          retrieving the exact count of the table may cause performance issues on your database."):"Your table has a row count of greater than ".concat(g.Fi.toLocaleString()," rows, and\n          retrieving the exact count of the table may cause performance issues on your database.")})})]})},R=e=>{let{isRefetching:t}=e,{project:n}=(0,o.d2)(),{id:m}=(0,a.UO)(),f=m?Number(m):void 0,{data:p}=(0,i.iB)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString,id:f}),[{view:h="data"},x]=(0,d.x)(),g=(0,c.D1)(p),y=(0,c.N3)(p);return(0,r.jsxs)(s.x,{"data-sentry-element":"GridFooter","data-sentry-component":"Footer","data-sentry-source-file":"Footer.tsx",children:["data"===h&&(0,r.jsx)(k,{}),(0,r.jsxs)("div",{className:"ml-auto flex items-center gap-x-2",children:[p&&"data"===h&&(0,r.jsx)(u.Z,{table:p,isRefetching:t}),(g||y)&&(0,r.jsx)(l.Z,{width:75,options:["definition","data"],activeOption:h,borderOverride:"border",onClickOption:e=>{"data"===e?x({view:void 0}):x({view:e})}})]})]})}},18826:function(e,t,n){n.d(t,{kI:function(){return I},m0:function(){return O}});var r=n(97458),a=n(198),o=n(12887),s=n.n(o),l=n(63204),i=n(32939),c=n(24544),d=n(17471),u=n(49571),m=n.n(u),f=n(52983),p=n(34549),h=n(27299),x=n(54811),g=n(20170),y=n(97881),v=n(99576),b=n(50853),j=n(87790),_=n(46327),w=n(15997),N=n(44190),C=n(77518),E=n(19168),S=n(5546),k=n(44273),R=n(57222),A=n(62408),T=n(37669),L=n.n(T);let I=5e5,O=(0,r.jsxs)(r.Fragment,{children:["Sorry! We're unable to support exporting row counts larger than $",I.toLocaleString()," at the moment. Alternatively, you may consider using",(0,r.jsx)(L(),{href:"https://supabase.com/docs/reference/cli/supabase-db-dump",target:"_blank",children:"pg_dump"})," ","via our CLI instead."]});t.ZP=e=>{let{table:t,sorts:n,filters:a,onAddColumn:o,onAddRow:s,onImportData:l,headerActions:i,customHeader:c}=e,{selectedRows:d}=(0,h.Qq)();return(0,r.jsx)("div",{"data-sentry-component":"Header","data-sentry-source-file":"Header.tsx",children:(0,r.jsxs)("div",{className:"flex h-10 items-center justify-between bg-dash-sidebar px-1.5 py-1.5 gap-2 overflow-x-auto",children:[c?(0,r.jsx)(r.Fragment,{children:c}):(0,r.jsx)(r.Fragment,{children:d.size>0?(0,r.jsx)(P,{table:t,sorts:n,filters:a}):(0,r.jsx)(q,{table:t,onAddColumn:o,onAddRow:s,onImportData:l})}),(0,r.jsx)("div",{className:"sb-grid-header__inner",children:i})]})})};let q=e=>{let{table:t,onAddColumn:n,onAddRow:o,onImportData:s}=e,d=(0,j.Xo)(a.KA.TENANT_SQL_ADMIN_WRITE,"columns"),[{filter:u,sort:m},f]=(0,_.x)({arrayKeys:["sort","filter"]});return(0,r.jsxs)("div",{className:"flex items-center gap-4","data-sentry-component":"DefaultHeader","data-sentry-source-file":"Header.tsx",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(R.Z,{table:t,filters:u,setParams:f,"data-sentry-element":"FilterPopover","data-sentry-source-file":"Header.tsx"}),(0,r.jsx)(A.f,{table:t,sorts:m,setParams:f,"data-sentry-element":"SortPopover","data-sentry-source-file":"Header.tsx"})]}),(void 0!==o||void 0!==n)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"h-[20px] w-px border-r border-control"}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:d&&(0,r.jsxs)(C.h_,{children:[(0,r.jsx)(C.$F,{asChild:!0,children:(0,r.jsx)(E.z,{"data-testid":"table-editor-insert-new-row",type:"primary",size:"tiny",icon:(0,r.jsx)(l.Z,{strokeWidth:1.5}),children:"Insert"})}),(0,r.jsx)(C.AW,{side:"bottom",align:"start",children:[...void 0!==o?[(0,r.jsxs)(C.Xi,{className:"group space-x-2",onClick:o,children:[(0,r.jsxs)("div",{className:"-mt-2 pr-1.5",children:[(0,r.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px]"}),(0,r.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px] my-[2px]"}),(0,r.jsx)("div",{className:(0,S.cn)(["border border-foreground-light w-[15px] h-[4px] translate-x-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-x-0"])})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Insert row"}),(0,r.jsxs)("p",{className:"text-foreground-light",children:["Insert a new row into ",t.name]})]})]},"add-row")]:[],...void 0!==n?[(0,r.jsxs)(C.Xi,{className:"group space-x-2",onClick:n,children:[(0,r.jsxs)("div",{className:"flex -mt-2 pr-1.5",children:[(0,r.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px]"}),(0,r.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px] mx-[2px]"}),(0,r.jsx)("div",{className:(0,S.cn)(["border border-foreground-light w-[4px] h-[15px] -translate-y-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-y-0"])})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Insert column"}),(0,r.jsxs)("p",{className:"text-foreground-light",children:["Insert a new column into ",t.name]})]})]},"add-column")]:[],...void 0!==s?[(0,r.jsxs)(C.Xi,{className:"group space-x-2",onClick:s,children:[(0,r.jsxs)("div",{className:"relative -mt-2",children:[(0,r.jsx)(i.Z,{size:18,strokeWidth:1.5,className:"-translate-x-[2px]"}),(0,r.jsx)(c.Z,{className:(0,S.cn)("transition duration-200 absolute bottom-0 right-0 translate-y-1 opacity-0 bg-brand-400 rounded-full","group-data-[highlighted]:translate-y-0 group-data-[highlighted]:text-brand group-data-[highlighted]:opacity-100"),strokeWidth:3,size:12})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Import data from CSV"}),(0,r.jsx)("p",{className:"text-foreground-light",children:"Insert new rows from a CSV"})]})]},"import-data")]:[]]})]})})]})]})},P=e=>{var t,n;let{table:a,sorts:o,filters:i}=e,c=(0,h.Qq)(),u=(0,h.I0)(),{project:j}=(0,g.d2)(),_=(0,N._2)(),S=(0,w.fN)(),R=void 0!==S.role,[A,T]=(0,f.useState)(!1),{data:L}=(0,b.KK)({projectRef:null==j?void 0:j.ref,connectionString:null==j?void 0:j.connectionString,tableId:a.id,sorts:o,filters:i,page:_.page,limit:_.rowsPerPage,impersonatedRole:S.role}),{data:q}=(0,v.HS)({projectRef:null==j?void 0:j.ref,connectionString:null==j?void 0:j.connectionString,tableId:a.id,filters:i,enforceExactCount:_.enforceExactCount,impersonatedRole:S.role},{keepPreviousData:!0}),P=()=>{u({type:"SELECT_ALL_ROWS",payload:{selectedRows:new Set(F.map(e=>e.idx))}})};async function D(){if(T(!0),W&&Z>I)return p.Am.error((0,r.jsx)("div",{className:"prose text-sm text-foreground",children:O})),T(!1);if(!j)return p.Am.error("Project is required"),T(!1);let e=(W?await (0,b.wF)({projectRef:j.ref,connectionString:j.connectionString,table:a,filters:i,sorts:o,impersonatedRole:S.role}):F.filter(e=>M.has(e.idx))).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e)),t=new Blob([m().unparse(e,{columns:c.table.columns.map(e=>e.name)})],{type:"text/csv;charset=utf-8;"});s()(t,"".concat(c.table.name,"_rows.csv")),T(!1)}async function z(){if(T(!0),W&&Z>I)return p.Am.error((0,r.jsx)("div",{className:"prose text-sm text-foreground",children:O})),T(!1);if(!j)return p.Am.error("Project is required"),T(!1);let e=W?await (0,b.wF)({projectRef:j.ref,connectionString:j.connectionString,table:a,filters:i,sorts:o,impersonatedRole:S.role}):F.filter(e=>M.has(e.idx)),t=new Blob([(0,x.k)(a,e)],{type:"text/sql;charset=utf-8;"});s()(t,"".concat(c.table.name,"_rows.sql")),T(!1)}let F=null!==(t=null==L?void 0:L.rows)&&void 0!==t?t:[],Z=null!==(n=null==q?void 0:q.count)&&void 0!==n?n:0,{selectedRows:M,editable:U,allRowsSelected:W}=c;return(0,w.gv)(()=>{(W||M.size>0)&&u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2","data-sentry-component":"RowHeader","data-sentry-source-file":"Header.tsx",children:[U&&(0,r.jsx)(y.u,{type:"default",size:"tiny",icon:(0,r.jsx)(d.Z,{}),onClick:()=>{let e=W?Z:M.size,t=Array.from(M),n=F.filter(e=>t.includes(e.idx));_.onDeleteRows(n,{allRowsSelected:W,numRows:e,callback:()=>{u({type:"REMOVE_ROWS",payload:{rowIdxs:t}}),u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})}})},disabled:W&&R,tooltip:{content:{side:"bottom",text:W&&R?"Table truncation is not supported when impersonating a role":void 0}},children:W?"Delete all rows in table":M.size>1?"Delete ".concat(M.size," rows"):"Delete ".concat(M.size," row")}),(0,r.jsxs)(C.h_,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"Header.tsx",children:[(0,r.jsx)(C.$F,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"Header.tsx",children:(0,r.jsx)(E.z,{type:"default",size:"tiny",iconRight:(0,r.jsx)(l.Z,{}),loading:A,disabled:A,"data-sentry-element":"Button","data-sentry-source-file":"Header.tsx",children:"Export"})}),(0,r.jsxs)(C.AW,{className:"w-40","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"Header.tsx",children:[(0,r.jsx)(C.Xi,{onClick:D,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"Header.tsx",children:(0,r.jsx)("span",{className:"text-foreground-light",children:"Export to CSV"})}),(0,r.jsx)(C.Xi,{onClick:z,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"Header.tsx",children:"Export to SQL"})]})]}),!W&&Z>F.length&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"h-6 ml-0.5",children:(0,r.jsx)(k.Z,{orientation:"vertical"})}),(0,r.jsx)(E.z,{type:"text",onClick:()=>P(),children:"Select all rows in table"})]})]})}},30805:function(e,t,n){var r=n(97458),a=n(36457),o=n(17542),s=n(45925),l=n(24158),i=n(19168);t.Z=e=>{let{table:t,isRefetching:n}=e,{ref:c}=(0,s.UO)(),d=(0,a.NL)(),u=l.s.tableRowsAndCount(c,t.id);async function m(){await d.invalidateQueries(u)}return(0,r.jsx)(i.z,{type:"text",loading:n,icon:(0,r.jsx)(o.Z,{className:"text-foreground-muted",strokeWidth:1.5}),onClick:()=>m(),"data-sentry-element":"Button","data-sentry-component":"RefreshButton","data-sentry-source-file":"RefreshButton.tsx",children:"Refresh"})}},57222:function(e,t,n){n.d(t,{Z:function(){return j}});var r=n(97458),a=n(58724),o=n.n(a),s=n(85466),l=n.n(s),i=n(6303),c=n(81449),d=n(52983),u=n(4673),m=n(41341),f=n(19168),p=n(43289),h=n(96789),x=n(1680),g=n(63204),y=n(14415),v=(0,d.memo)(e=>{var t,n;let{table:a,filter:o,filterIdx:s,onChange:l,onDelete:i,onKeyDown:c}=e,d=a.columns.find(e=>e.name===o.column),u=(null===(t=a.columns)||void 0===t?void 0:t.map(e=>({value:e.name,label:e.name,postLabel:e.dataType})))||[],m=(null==d?void 0:d.format)==="timestamptz"?"yyyy-mm-dd hh:mm:ss+zz":(null==d?void 0:d.format)==="timestamp"?"yyyy-mm-dd hh:mm:ss":"Enter a value";return(0,r.jsxs)("div",{className:"flex w-full items-center justify-between gap-x-1 px-3","data-sentry-component":"FilterRow","data-sentry-source-file":"FilterRow.tsx",children:[(0,r.jsx)(x.F,{align:"start",options:u,onSelect:e=>l(s,{...o,column:e}),"data-sentry-element":"DropdownControl","data-sentry-source-file":"FilterRow.tsx",children:(0,r.jsx)(f.z,{asChild:!0,type:"outline",icon:(0,r.jsx)("div",{className:"text-foreground-lighter",children:(0,r.jsx)(g.Z,{strokeWidth:1.5})}),className:"w-32 justify-start","data-sentry-element":"Button","data-sentry-source-file":"FilterRow.tsx",children:(0,r.jsx)("span",{children:null!==(n=null==d?void 0:d.name)&&void 0!==n?n:""})})}),(0,r.jsx)(x.F,{align:"start",options:p.o,onSelect:e=>l(s,{...o,operator:e}),"data-sentry-element":"DropdownControl","data-sentry-source-file":"FilterRow.tsx",children:(0,r.jsx)(f.z,{asChild:!0,type:"outline",icon:(0,r.jsx)("div",{className:"text-foreground-lighter",children:(0,r.jsx)(g.Z,{strokeWidth:1.5})}),"data-sentry-element":"Button","data-sentry-source-file":"FilterRow.tsx",children:(0,r.jsx)("span",{children:o.operator})})}),(0,r.jsx)(h.Z,{size:"tiny",className:"w-full",placeholder:m,value:o.value,onChange:e=>l(s,{...o,value:e.target.value}),onKeyDown:c,"data-sentry-element":"Input","data-sentry-source-file":"FilterRow.tsx"}),(0,r.jsx)(f.z,{type:"text",className:"px-1",icon:(0,r.jsx)(y.Z,{strokeWidth:1.5}),onClick:()=>i(s),"data-sentry-element":"Button","data-sentry-source-file":"FilterRow.tsx"})]})}),b=n(44190),j=e=>{let{table:t,filters:n,setParams:a}=e,[o,s]=(0,d.useState)(!1),l=(0,b._2)(),c=(n||[]).length>0?"Filtered by ".concat(n.length," rule").concat(n.length>1?"s":""):"Filter";return(0,r.jsxs)(m.J2,{open:o,onOpenChange:s,modal:!1,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"FilterPopover","data-sentry-source-file":"FilterPopover.tsx",children:[(0,r.jsx)(m.xo,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:(0,r.jsx)(f.z,{type:(n||[]).length>0?"link":"text",icon:(0,r.jsx)(i.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:c})}),(0,r.jsx)(m.yk,{className:"p-0 w-96",side:"bottom",align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:(0,r.jsx)(_,{table:t,filters:n,onApplyFilters:e=>{l.setEnforceExactCount(!1),a(t=>({...t,filter:e.map(e=>{let t=p.o.find(t=>t.value===e.operator);return"".concat(e.column,":").concat(null==t?void 0:t.abbrev,":").concat(e.value)})}))},"data-sentry-element":"FilterOverlay","data-sentry-source-file":"FilterPopover.tsx"})})]})};let _=e=>{let{table:t,filters:n,onApplyFilters:a}=e,s=(0,d.useMemo)(()=>(0,u.Yb)(null!=n?n:[]),[n]),[i,p]=(0,d.useState)(s),h=(0,d.useCallback)((e,t)=>{p(n=>o()(n,{[e]:{$set:t}}))},[]),x=(0,d.useCallback)(e=>{p(t=>o()(t,{$splice:[[e,1]]}))},[]),g=()=>{let e=i.map(e=>{let n=t.columns.find(t=>t.name===e.column);return(null==n?void 0:n.format)==="uuid"?{...e,value:e.value.trim()}:e});p(e),a(e)};function y(e){"Enter"===e.key&&g()}return(0,r.jsxs)("div",{className:"space-y-2 py-2","data-sentry-component":"FilterOverlay","data-sentry-source-file":"FilterPopover.tsx",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[i.map((e,n)=>(0,r.jsx)(v,{table:t,filter:e,filterIdx:n,onChange:h,onDelete:x,onKeyDown:y},"filter-".concat(e.column,"-").concat([n]))),0==i.length&&(0,r.jsxs)("div",{className:"space-y-1 px-3",children:[(0,r.jsx)("h5",{className:"text-sm text-foreground-light",children:"No filters applied to this view"}),(0,r.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Add a column below to filter the view"})]})]}),(0,r.jsx)(m.Fm,{"data-sentry-element":"PopoverSeparator_Shadcn_","data-sentry-source-file":"FilterPopover.tsx"}),(0,r.jsxs)("div",{className:"px-3 flex flex-row justify-between",children:[(0,r.jsx)(f.z,{icon:(0,r.jsx)(c.Z,{}),type:"text",onClick:function(){var e;let n=null===(e=t.columns[0])||void 0===e?void 0:e.name;n&&p([...i,{column:n,operator:"=",value:""}])},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:"Add filter"}),(0,r.jsx)(f.z,{disabled:l()(i,s),type:"default",onClick:()=>g(),"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:"Apply filter"})]})]})}},27299:function(e,t,n){n.d(t,{g3:function(){return m},I0:function(){return p},Qq:function(){return f}});var r=n(52983),a=n(87595),o=n(90897),s=n(58724),l=n.n(s),i=n(99429);function c(e){let t=(0,i.I8)(e);return t.renderEditCell=e.renderEditCell,t.renderHeaderCell=e.renderHeaderCell,t.renderCell=e.renderCell,t.renderGroupCell=e.renderGroupCell,t}let d={table:null,isInitialComplete:!1,editable:!1,allRowsSelected:!1,onAddColumn:null,onAddRow:null,onError:null,onEditRow:null,onEditColumn:null,onDeleteColumn:null,gridColumns:[],rows:[],selectedRows:new Set,selectedCellPosition:null,totalRows:o.Vz},u=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,n=arguments.length>1?arguments[1]:void 0;for(let r=0;r<t.length;r++)e=t[r](e,n);return e}}((e,t)=>{switch(t.type){case"INIT_TABLE":return{...e,table:t.payload.table,isInitialComplete:!0,editable:t.payload.editable||!1};case"UPDATE_FILTERS":{let t={...e};return t.page=1,t.totalRows=o.ZR,t}case"UPDATE_SORTS":return{...e};default:return e}},(e,t)=>"INIT_CALLBACK"===t.type?{...e,onAddColumn:t.payload.onAddColumn,onAddRow:t.payload.onAddRow,onError:t.payload.onError,onEditRow:t.payload.onEditRow,onEditColumn:t.payload.onEditColumn,onDeleteColumn:t.payload.onDeleteColumn}:e,(e,t)=>{switch(t.type){case"INIT_TABLE":return{...e,gridColumns:function(e,t){let n=e;if(null==t?void 0:t.gridColumns){n=[];let r=t.gridColumns.filter(e=>(null==e?void 0:e.name)!=="");for(let t=0;t<r.length;t++){let a=r[t],o=e.find(e=>e.key===a.key);o&&n.push({...o,width:a.width,frozen:a.frozen})}let a=e.filter(e=>!r.find(t=>t.key===e.key)&&""!==e.name);n=n.concat(a);let s=e.find(e=>e.key===o.W);s&&(n=[s,...n]);let l=e.find(e=>e.key===o.uZ);l&&n.push(l)}return n}(t.payload.gridColumns,t.payload.savedState)};case"MOVE_COLUMN":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.fromKey),r=e.gridColumns.findIndex(e=>e.key===t.payload.toKey),a=e.gridColumns[n];return{...e,gridColumns:l()(e.gridColumns,{$splice:[[n,1],[r,0,a]]})}}case"UPDATE_COLUMN_SIZE":{let n=c(e.gridColumns[t.payload.index]);return n.width=t.payload.width,{...e,gridColumns:l()(e.gridColumns,{[t.payload.index]:{$set:n}})}}case"FREEZE_COLUMN":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.columnKey),r=c(e.gridColumns[n]);return r.frozen=!0,{...e,gridColumns:l()(e.gridColumns,{[n]:{$set:r}})}}case"UNFREEZE_COLUMN":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.columnKey),r=c(e.gridColumns[n]);return r.frozen=!1,{...e,gridColumns:l()(e.gridColumns,{[n]:{$set:r}})}}case"UPDATE_COLUMN_IDX":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.columnKey),r=c(e.gridColumns[n]);return r.idx=t.payload.columnIdx,{...e,gridColumns:l()(e.gridColumns,{[n]:{$set:r}}).sort((e,t)=>e.idx-t.idx)}}default:return e}},(e,t)=>{switch(t.type){case"INIT_TABLE":return{...e,selectedCellPosition:null,selectedRows:new Set,totalRows:o.ZR};case"SELECTED_CELL_CHANGE":return{...e,selectedCellPosition:t.payload.position};case"SELECTED_ROWS_CHANGE":return{...e,allRowsSelected:!1,selectedRows:t.payload.selectedRows};case"SELECT_ALL_ROWS":return{...e,allRowsSelected:!0,selectedRows:t.payload.selectedRows};case"SET_ROWS":return{...e,rows:t.payload.rows};case"SET_ROWS_COUNT":return{...e,totalRows:t.payload};default:return e}}),{Provider:m,useTrackedState:f,useUpdate:p}=(0,a.fH)(()=>(0,r.useReducer)(u,d))},90476:function(e,t,n){n.d(t,{i1:function(){return ek},ve:function(){return eA},cv:function(){return eR}});var r=n(97458),a=n(90897),o=n(27299),s=n(23729);let l=e=>{let{row:t,column:n,isNullable:a,onRowChange:l,onClose:i}=e,c=(0,o.Qq)().gridColumns.find(e=>e.name==n.key),d=t[n.key];return(0,r.jsxs)(s.ZP,{autoFocus:!0,id:"boolean-editor",name:"boolean-editor",size:"small",onBlur:()=>i(!1),onChange:e=>{let r=e.target.value;"null"===r?l({...t,[n.key]:null},!0):l({...t,[n.key]:"true"===r},!0)},defaultValue:null===d?"null":d.toString(),style:{width:"".concat((null==c?void 0:c.width)||n.width,"px")},"data-sentry-element":"Select","data-sentry-component":"BooleanEditor","data-sentry-source-file":"BooleanEditor.tsx",children:[(0,r.jsx)(s.ZP.Option,{value:"true","data-sentry-element":"unknown","data-sentry-source-file":"BooleanEditor.tsx",children:"TRUE"}),(0,r.jsx)(s.ZP.Option,{value:"false","data-sentry-element":"unknown","data-sentry-source-file":"BooleanEditor.tsx",children:"FALSE"}),a&&(0,r.jsx)(s.ZP.Option,{value:"null",children:"NULL"})]})};var i=n(28977),c=n.n(i),d=n(63204),u=n(52983),m=n(41341),f=n(5546),p=n(19168),h=n(77518),x=n(60005),g=n(30413);let y=e=>{let[t,n]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{let t=t=>{e.current&&!e.current.contains(t.target)?n(!0):n(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[e]),t},v=e=>{let{value:t,children:n,onEscape:a,onEnter:o,ignoreOutsideClicks:s=!1}=e,l=(0,u.useRef)(null),i=y(l),c=(0,u.useCallback)(e=>{switch(e.key){case"Escape":e.stopPropagation(),a&&a(t);break;case"Enter":e.stopPropagation(),!e.shiftKey&&o&&(e.preventDefault(),o(t))}},[t]);return(0,u.useEffect)(()=>{!s&&i&&void 0!==o&&o(t)},[i]),(0,r.jsx)("div",{ref:l,onKeyDown:c,"data-sentry-component":"BlockKeys","data-sentry-source-file":"BlockKeys.tsx",children:n})},b={date:"YYYY-MM-DD",datetime:"YYYY-MM-DD HH:mm:ss",datetimetz:"YYYY-MM-DD HH:mm:ss+ZZ"};function j(e){let{row:t,column:n,type:a,isNullable:o,onRowChange:s,onClose:l}=e,i=(0,u.useRef)(null),y=b[a],j=t[n.key],[_,w]=(0,u.useState)(j),N=_?Number(c()(_,y)):_,C=e=>{("string"!=typeof e||0!==e.length)&&"Invalid Date"!==N&&s({...t,[n.key]:e},!0)};return(0,u.useEffect)(()=>{var e,t;try{null===(e=i.current)||void 0===e||e.focus({preventScroll:!0})}catch(e){null===(t=i.current)||void 0===t||t.focus()}},[]),(0,r.jsxs)(m.J2,{open:!0,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"BaseEditor","data-sentry-source-file":"DateTimeEditor.tsx",children:[(0,r.jsx)(m.xo,{"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"DateTimeEditor.tsx",children:(0,r.jsx)("div",{className:(0,f.cn)("px-[8px]",null===j?"text-foreground-lighter":""),children:null===j?"NULL":j})}),(0,r.jsxs)(m.yk,{align:"start",className:"p-0 rounded-none w-64","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"DateTimeEditor.tsx",children:[(0,r.jsx)(v,{ignoreOutsideClicks:!0,value:_,onEscape:()=>l(!1),onEnter:C,"data-sentry-element":"BlockKeys","data-sentry-source-file":"DateTimeEditor.tsx",children:(0,r.jsx)(g.I,{ref:i,value:null!=_?_:"",placeholder:b[a],onChange:e=>w(e.target.value),className:"border-0 rounded-none bg-dash-sidebar outline-none !ring-0 !ring-offset-0","data-sentry-element":"Input","data-sentry-source-file":"DateTimeEditor.tsx"})}),(0,r.jsxs)("div",{className:"px-3 py-1 flex flex-col gap-y-0.5",children:[(0,r.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Formatted value:"}),0===(null!=_?_:"").length?(0,r.jsx)("p",{className:"text-sm font-mono text-foreground-light",children:"Enter a valid date format"}):"Invalid Date"===N?(0,r.jsx)("p",{className:"text-sm font-mono text-foreground-light",children:"Invalid date format"}):"datetimetz"===a?(0,r.jsx)(x.c,{displayAs:"utc",utcTimestamp:N,labelFormat:"DD MMM YYYY HH:mm:ss (ZZ)",className:"text-left !text-sm font-mono tracking-tight"}):(0,r.jsx)("p",{className:"text-sm font-mono tracking-tight",children:(0,x.w)({utcTimestamp:N,format:"date"===a?"DD MMM YYYY":"datetime"===a?"DD MMM YYYY HH:mm:ss":void 0})})]}),(0,r.jsxs)("div",{className:"px-3 pt-1 pb-2 flex justify-between gap-x-1",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1.5 h-[22px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:""})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Save changes"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1 h-[22px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:"Esc"})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Cancel changes"})]})]}),(0,r.jsx)("div",{className:"flex",children:o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.z,{type:"default",className:"rounded-r-none",onClick:()=>C(null),children:"Set NULL"}),(0,r.jsxs)(h.h_,{children:[(0,r.jsx)(h.$F,{asChild:!0,children:(0,r.jsx)(p.z,{type:"default",icon:(0,r.jsx)(d.Z,{}),className:"px-1 rounded-l-none border-l-0"})}),(0,r.jsx)(h.AW,{className:"w-20",align:"end",children:(0,r.jsx)(h.Xi,{onClick:()=>{C(c()().format(b[a]).replace("++","+"))},children:"Set to NOW"})})]})]})})]})]})]})}function _(e,t){return n=>(0,r.jsx)(j,{...n,type:e,isNullable:t})}var w=n(48141),N=n(34549),C=n(45925),E=n(59650),S=n(69171),k=n(55638),R=n(50853),A=n(51735),T=n(47878),L=n(26006),I=n(82445),O=n(50047);let q=()=>(0,r.jsx)("span",{className:"null-value opacity-50","data-sentry-component":"NullValue","data-sentry-source-file":"NullValue.tsx",children:"NULL"}),P=e=>{let{isLoading:t,loadFullValue:n}=e;return(0,r.jsxs)("div",{className:(0,f.cn)("absolute top-0 left-0 flex items-center justify-center flex-col gap-y-3","text-xs w-full h-full px-3 text-center","bg-default/80 backdrop-blur-[1.5px]"),"data-sentry-component":"TruncatedWarningOverlay","data-sentry-source-file":"TruncatedWarningOverlay.tsx",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,r.jsxs)("p",{children:["Value is larger than ",R.no.toLocaleString()," characters"]}),(0,r.jsx)("p",{className:"text-foreground-light",children:"You may try to render the entire value, but your browser may run into performance issues"})]}),(0,r.jsx)(p.z,{type:"default",loading:t,onClick:n,"data-sentry-element":"Button","data-sentry-source-file":"TruncatedWarningOverlay.tsx",children:"Load full value"})]})},D=e=>{try{return JSON.parse(e),!0}catch(e){return!1}},z=e=>{try{let t=JSON.parse(e);return JSON.stringify(t)}catch(t){if("string"==typeof e)return e.replaceAll('"','"');return JSON.stringify(e)}},F=e=>{let{row:t,column:n,isEditable:a=!0,onRowChange:s,onExpandEditor:l}=e,i=(0,o.Qq)(),{id:c}=(0,C.UO)(),d=c?Number(c):void 0,m=(0,A.Vm)(),{data:f}=(0,E.iB)({projectRef:null==m?void 0:m.ref,connectionString:null==m?void 0:m.connectionString,id:d}),p=i.gridColumns.find(e=>e.name==n.key),h=t[n.key],x=null==h||"string"==typeof h?h:JSON.stringify(h),g=(0,T.ZO)(x?z(x):""),y="string"==typeof x&&x.endsWith("...")&&x.length>R.no,[b,j]=(0,u.useState)(!0),[_,F]=(0,u.useState)(g),{mutate:Z,isLoading:M,isSuccess:U}=(0,k.rp)(),W=(0,u.useCallback)(()=>{a&&s(t,!0),j(!1)},[]),K=(0,u.useCallback)(e=>{(null!==e?(0,T.tT)(e):e)!==_?B(e):j(!1)},[U]),$=()=>{W(),l(n.key,{...t,[n.key]:(0,T.dW)(_)||t[n.key]})},B=e=>{if(a){if(e){if(D(e)){let r=JSON.parse(e);s({...t,[n.key]:r},!0),j(!1)}else{let{onError:e}=i;e&&e(Error("Please enter a valid JSON"))}}else s({...t,[n.key]:null},!0),j(!1)}};return(0,r.jsx)(L.Z,{open:b,side:"bottom",align:"start",sideOffset:-35,className:"rounded-none",overlay:y&&!U?(0,r.jsxs)("div",{style:{width:"".concat((null==p?void 0:p.width)||n.width,"px")},className:"flex items-center justify-center flex-col relative",children:[(0,r.jsx)(O.r,{readOnly:!0,onChange:()=>{},width:"".concat((null==p?void 0:p.width)||n.width,"px"),value:null!=_?_:"",language:"markdown"}),(0,r.jsx)(P,{isLoading:M,loadFullValue:()=>{if(void 0===f||void 0===m||!(0,S.N3)(f))return;if(0===f.primary_keys.length)return(0,N.Am)("Unable to load value as table has no primary keys");let e=f.primary_keys.reduce((e,n)=>({...e,[n.name]:t[n.name]}),{});Z({table:{schema:f.schema,name:f.name},column:n.name,pkMatch:e,projectRef:null==m?void 0:m.ref,connectionString:null==m?void 0:m.connectionString},{onSuccess:e=>{F(JSON.stringify(e))}})}})]}):(0,r.jsxs)(v,{value:_,onEscape:W,onEnter:K,children:[(0,r.jsx)(O.r,{width:"".concat((null==p?void 0:p.width)||n.width,"px"),value:null!=_?_:"",language:"json",readOnly:!a,onChange:e=>{a&&(e&&""!=e?F(e):F(null))}}),(0,r.jsxs)("div",{className:"flex items-start justify-between p-2 bg-surface-200 gap-x-2",children:[a&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1.5 py-[2.5px] rounded bg-selection border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:""})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Save changes"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1 py-[2.5px] rounded bg-selection border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:"Esc"})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Cancel changes"})]})]}),(0,r.jsxs)(I.u,{children:[(0,r.jsx)(I.aJ,{asChild:!0,children:(0,r.jsx)("div",{className:"border border-strong rounded p-1 flex items-center justify-center transition cursor-pointer bg-selection hover:bg-border-strong",onClick:()=>$(),children:(0,r.jsx)(w.Z,{size:12,strokeWidth:2})})}),(0,r.jsx)(I._v,{side:"bottom",align:"center",children:(0,r.jsx)("span",{children:"Expand editor"})})]})]})]}),"data-sentry-element":"Popover","data-sentry-component":"JsonEditor","data-sentry-source-file":"JsonEditor.tsx",children:(0,r.jsx)("div",{className:"".concat(_&&0==g.trim().length?"sb-grid-fill-container":""," sb-grid-json-editor__trigger"),onClick:()=>j(!b),children:null===_||""===_?(0,r.jsx)(q,{}):g})})};function Z(e){null==e||e.focus(),null==e||e.select()}function M(e){let{row:t,column:n,onRowChange:a,onClose:o}=e,s=t[n.key];return(0,r.jsx)("input",{className:"sb-grid-number-editor",ref:Z,value:null!=s?s:"",onChange:function(e){let r=e.target.value;""===r?a({...t,[n.key]:null}):a({...t,[n.key]:r})},onBlur:function(){o(!0)},type:"number","data-sentry-component":"NumberEditor","data-sentry-source-file":"NumberEditor.tsx"})}function U(e){let{row:t,column:n,onRowChange:a,onClose:l,options:i,isNullable:c}=e,d=(0,o.Qq)().gridColumns.find(e=>e.name==n.key),u=t[n.key];return(0,r.jsxs)(s.ZP,{autoFocus:!0,id:"select-editor",name:"select-editor",size:"small",defaultValue:null!=u?u:"",className:"sb-grid-select-editor !gap-2",style:{width:"".concat((null==d?void 0:d.width)||n.width,"px")},onChange:function(e){e.target.value&&""!=e.target.value?a({...t,[n.key]:e.target.value},!0):a({...t,[n.key]:null},!0)},onBlur:function(){l(!1)},"data-sentry-element":"Select","data-sentry-component":"SelectEditor","data-sentry-source-file":"SelectEditor.tsx",children:[c&&(0,r.jsx)(s.ZP.Option,{value:"",children:"NULL"}),i.map(e=>{let{label:t,_value:n}=e;return(0,r.jsx)(s.ZP.Option,{value:n,selected:n===u,children:t},n)})]})}var W=n(587);let K=()=>(0,r.jsx)("span",{className:"sb-grid-empty-value opacity-50","data-sentry-component":"EmptyValue","data-sentry-source-file":"EmptyValue.tsx",children:"EMPTY"}),$=e=>{let{row:t,column:n,isNullable:a,isEditable:s,onRowChange:l,onExpandEditor:i}=e,c=(0,o.Qq)(),{id:d}=(0,C.UO)(),m=d?Number(d):void 0,h=(0,A.Vm)(),{data:x}=(0,E.iB)({projectRef:null==h?void 0:h.ref,connectionString:null==h?void 0:h.connectionString,id:m}),g=c.gridColumns.find(e=>e.name==n.key),y=t[n.key],b=y?String(y):null,[j,_]=(0,u.useState)(!0),[T,D]=(0,u.useState)(b),[z,F]=(0,u.useState)(!1),{mutate:Z,isLoading:M,isSuccess:U}=(0,k.rp)(),$="string"==typeof b&&b.endsWith("...")&&b.length>R.no,B=(0,u.useCallback)(()=>{s&&l(t,!0),_(!1)},[]),H=(0,u.useCallback)(e=>{s&&e!==T&&l({...t,[n.key]:e},!0),_(!1)},[U]),J=()=>{B(),i(n.key,{...t,[n.key]:T||t[n.key]})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.Z,{open:j,side:"bottom",align:"start",sideOffset:-35,className:"rounded-none",overlay:$&&!U?(0,r.jsxs)("div",{style:{width:"".concat((null==g?void 0:g.width)||n.width,"px")},className:"flex items-center justify-center flex-col relative",children:[(0,r.jsx)(O.r,{readOnly:!0,onChange:()=>{},width:"".concat((null==g?void 0:g.width)||n.width,"px"),value:null!=T?T:"",language:"markdown"}),(0,r.jsx)(P,{isLoading:M,loadFullValue:()=>{if(void 0===x||void 0===h||!(0,S.N3)(x))return;if(0===x.primary_keys.length)return(0,N.Am)("Unable to load value as table has no primary keys");let e=x.primary_keys.reduce((e,n)=>({...e,[n.name]:t[n.name]}),{});Z({table:{schema:x.schema,name:x.name},column:n.name,pkMatch:e,projectRef:null==h?void 0:h.ref,connectionString:null==h?void 0:h.connectionString},{onSuccess:e=>D(e)})}})]}):(0,r.jsxs)(v,{value:T,onEscape:B,onEnter:H,ignoreOutsideClicks:z,children:[(0,r.jsx)(O.r,{width:"".concat((null==g?void 0:g.width)||n.width,"px"),value:null!=T?T:"",readOnly:!s,onChange:e=>{s&&(e?D(e):D(""))}}),s&&(0,r.jsxs)("div",{className:"flex items-start justify-between p-2 bg-surface-200 space-x-2",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1.5 py-[2.5px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:""})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Save changes"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"px-1 py-[2.5px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-[10px]",children:"Esc"})}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Cancel changes"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-y-1",children:[(0,r.jsxs)(I.u,{children:[(0,r.jsx)(I.aJ,{asChild:!0,children:(0,r.jsx)(p.z,{type:"default",className:"px-1",onClick:()=>J(),icon:(0,r.jsx)(w.Z,{size:12,strokeWidth:2})})}),(0,r.jsx)(I._v,{side:"bottom",children:"Expand editor"})]}),a&&(0,r.jsx)(p.z,{size:"tiny",type:"default",htmlType:"button",onClick:()=>F(!0),children:"Set to NULL"})]})]})]}),"data-sentry-element":"Popover","data-sentry-source-file":"TextEditor.tsx",children:(0,r.jsx)("div",{className:(0,f.cn)(!!T&&0===T.toString().trim().length&&"sb-grid-fill-container","sb-grid-text-editor__trigger"),onClick:()=>_(!j),children:null===T?(0,r.jsx)(q,{}):""===T?(0,r.jsx)(K,{}):T})}),(0,r.jsx)(W.Z,{visible:z,title:"Confirm setting value to NULL",confirmLabel:"Confirm",onCancel:()=>F(!1),onConfirm:()=>{H(null)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"TextEditor.tsx",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you wish to set this value to NULL? This action cannot be undone."})})]})};var B=n(97214),H=n.n(B);function J(e){null==e||e.focus(),null==e||e.select()}c().extend(H());let V="HH:mm:ss";function Y(e){let{row:t,column:n,format:a,onRowChange:o,onClose:s}=e,l=t[n.key],i=l?c()(l,a).format(V):l;return(0,r.jsx)("input",{className:"sb-grid-time-editor",ref:J,value:null!=i?i:"",onChange:function(e){let r=e.target.value;if(""==r)o({...t,[n.key]:null});else{let e=c()(r,V).format(a);o({...t,[n.key]:e})}},onBlur:()=>s(!0),type:"time",step:"1","data-sentry-component":"BaseEditor","data-sentry-source-file":"TimeEditor.tsx"})}function G(e){return(0,r.jsx)(Y,{...e,format:"HH:mm:ss","data-sentry-element":"BaseEditor","data-sentry-component":"TimeEditor","data-sentry-source-file":"TimeEditor.tsx"})}function Q(e){return(0,r.jsx)(Y,{...e,format:"HH:mm:ssZZ","data-sentry-element":"BaseEditor","data-sentry-component":"TimeWithTimezoneEditor","data-sentry-source-file":"TimeEditor.tsx"})}let X=e=>{let t=e.row[e.column.key];return null===t?(0,r.jsx)(q,{}):(0,r.jsx)(r.Fragment,{children:t?"TRUE":"FALSE"})},ee=e=>{let t=e.row[e.column.key];return null===t?(0,r.jsx)(q,{}):""===t?(0,r.jsx)(K,{}):(("object"==typeof t||Array.isArray(t))&&(t=JSON.stringify(t)),(0,r.jsx)(r.Fragment,{children:t}))};var et=n(44216),en=n(20170),er=n(28763),ea=n(68680),eo=n(10012);let es=e=>{var t;let{project:n}=(0,en.d2)(),{selectedSchema:a}=(0,eo.B)(),{projectRef:o,tableId:s,row:l,column:i}=e,c=s?Number(s):void 0,{data:d}=(0,E.iB)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString,id:c}),u=(0,S.N3)(d)?d:void 0,m=(null!==(t=null==u?void 0:u.relationships)&&void 0!==t?t:[]).find(e=>e.source_schema===(null==u?void 0:u.schema)&&e.source_table_name===(null==u?void 0:u.name)&&e.source_column_name===i.name),{data:f}=(0,ea.Bj)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString,schema:null==m?void 0:m.target_table_schema}),h=null==f?void 0:f.find(e=>e.schema===(null==m?void 0:m.target_table_schema)&&e.name===m.target_table_name),x=l[i.key];return(0,r.jsxs)("div",{className:"sb-grid-foreign-key-formatter flex justify-between","data-sentry-component":"ForeignKeyFormatter","data-sentry-source-file":"ForeignKeyFormatter.tsx",children:[(0,r.jsx)("span",{className:"sb-grid-foreign-key-formatter__text",children:null===x?(0,r.jsx)(q,{}):x}),void 0!==m&&void 0!==h&&null!==x&&(0,r.jsxs)(I.u,{delayDuration:0,children:[(0,r.jsx)(I.aJ,{asChild:!0,children:(0,r.jsx)(p.z,{asChild:!0,type:"default",size:"tiny",className:"translate-y-[2px]",style:{padding:"3px"},children:(0,r.jsx)(er.Sf,{href:"/project/".concat(o,"/editor/").concat(null==h?void 0:h.id,"?schema=").concat(a,"&filter=").concat(null==m?void 0:m.target_column_name,"%3Aeq%3A").concat(x),projectRef:o,id:h&&String(null==h?void 0:h.id),filters:[{column:m.target_column_name,operator:"=",value:String(x)}],children:(0,r.jsx)(et.Z,{size:14})})})}),(0,r.jsx)(I._v,{side:"bottom",children:"View referencing record"})]})]})},el=e=>{let t=e.row[e.column.key];if(null===t)return(0,r.jsx)(q,{});if(""===t)return(0,r.jsx)(K,{});if("string"==typeof t&&t.endsWith("..."))return(0,r.jsx)(r.Fragment,{children:t});try{let e=JSON.parse(t);return(0,r.jsx)(r.Fragment,{children:JSON.stringify(e)})}catch(e){return(0,r.jsx)(r.Fragment,{children:JSON.stringify(t)})}};var ei=n(81449);let ec={key:a.uZ,name:"",idx:999,width:100,maxWidth:100,resizable:!1,sortable:!1,frozen:!1,isLastFrozenColumn:!1,renderHeaderCell:()=>(0,r.jsx)(ed,{"aria-label":"Add New Row"}),renderCell:ee,parent:void 0,level:0,minWidth:0,draggable:!1},ed=e=>{let{}=e,{onAddColumn:t}=(0,o.Qq)();return(0,r.jsx)("div",{className:"sb-grid-add-column","data-sentry-component":"AddColumnHeader","data-sentry-source-file":"AddColumn.tsx",children:(0,r.jsx)(p.z,{block:!0,type:"text",onClick:t,icon:(0,r.jsx)(ei.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"AddColumn.tsx"})})};var eu=n(25741),em=n(67328),ef=n(34320),ep=n(17751),eh=n(37555),ex=n(74039),eg=n(58636),ey=n(54931);function ev(e){let{column:t,columnType:n,isPrimaryKey:a,isEncrypted:s,format:l,foreignKey:i}=e,c=(0,u.useRef)(null),d=(0,o.I0)(),m=t.idx,f=t.key,p="array"==n?"".concat(l.replace("_",""),"[]"):l,h=(0,o.Qq)(),x=t.name;(0,u.useEffect)(()=>{h.gridColumns[m].key!=f&&d({type:"UPDATE_COLUMN_IDX",payload:{columnKey:f,columnIdx:m}})},[f,m,h.gridColumns]);let[{isDragging:g},y]=(0,ep.c)({type:"column-header",item:()=>({key:f,index:m}),canDrag:()=>!t.frozen,collect:e=>({isDragging:e.isDragging()})}),[{handlerId:v},b]=(0,eh.L)({accept:"column-header",collect:e=>({handlerId:e.getHandlerId()}),hover(e,n){var r;if(!c.current||t.frozen)return;let a=e.index,o=e.key;if(a===m)return;let s=null===(r=c.current)||void 0===r?void 0:r.getBoundingClientRect(),l=(s.right-s.left)/2,i=n.getClientOffset().x-s.left;a<m&&i<l||a>m&&i>l||(j(o,f),e.index=m)}}),j=(e,t)=>{e!=t&&d({type:"MOVE_COLUMN",payload:{fromKey:e,toKey:t}})},_=t.frozen?"sb-grid-column-header--cursor":"";return y(b(c)),(0,r.jsx)("div",{ref:c,"data-handler-id":v,style:{opacity:g?0:1},className:"w-full","data-sentry-component":"ColumnHeader","data-sentry-source-file":"ColumnHeader.tsx",children:(0,r.jsxs)("div",{className:"sb-grid-column-header ".concat(_),children:[(0,r.jsxs)("div",{className:"sb-grid-column-header__inner",children:[function(e,t){let{name:n,foreignKey:a}=t;return"foreign_key"===e?(0,r.jsxs)(I.u,{children:[(0,r.jsx)(I.aJ,{children:(0,r.jsx)(ef.Z,{size:14,strokeWidth:2})}),(0,r.jsx)(I._v,{side:"bottom",children:(0,r.jsxs)("div",{className:"font-normal",children:[(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Foreign key relation:"}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("p",{className:"text-xs !text-foreground",children:n}),(0,r.jsx)(et.Z,{size:14,strokeWidth:1.5,className:"!text-foreground-light"}),(0,r.jsxs)("p",{className:"text-xs !text-foreground",children:[null==a?void 0:a.targetTableSchema,".",null==a?void 0:a.targetTableName,".",null==a?void 0:a.targetColumnName]})]}),(null==a?void 0:a.updateAction)!==eg.N.NO_ACTION&&(0,r.jsxs)("p",{className:"text-xs !text-foreground mt-1",children:["On update: ",(0,ex.s8)(null==a?void 0:a.updateAction)]}),(null==a?void 0:a.deletionAction)!==eg.N.NO_ACTION&&(0,r.jsxs)("p",{className:"text-xs !text-foreground mt-1",children:["On delete: ",(0,ex.s8)(null==a?void 0:a.deletionAction)]})]})})]}):null}(n,{name:t.name,foreignKey:i}),a&&(0,r.jsxs)(I.u,{children:[(0,r.jsx)(I.aJ,{children:(0,r.jsx)("div",{className:"sb-grid-column-header__inner__primary-key",children:(0,r.jsx)(eu.Z,{size:14,strokeWidth:2})})}),(0,r.jsx)(I._v,{side:"bottom",className:"font-normal",children:"Primary key"})]}),(0,r.jsx)("span",{className:"sb-grid-column-header__inner__name",title:x,children:t.name}),(0,r.jsx)("span",{className:"sb-grid-column-header__inner__format",children:p}),s&&(0,r.jsxs)(I.u,{children:[(0,r.jsx)(I.aJ,{children:(0,r.jsx)(em.Z,{size:14,strokeWidth:2})}),(0,r.jsx)(I._v,{side:"bottom",className:"font-normal",children:"Encrypted column"})]})]}),(0,r.jsx)(ey.ov,{column:t,isEncrypted:s,"data-sentry-element":"ColumnMenu","data-sentry-source-file":"ColumnHeader.tsx"})]})})}var eb=n(13948),ej=n(62836),e_=n(44914);let ew={key:a.W,name:"",idx:0,width:65,maxWidth:65,resizable:!1,sortable:!1,frozen:!0,isLastFrozenColumn:!1,renderHeaderCell:e=>{let[t,n]=(0,e_.Gt)();return(0,r.jsx)(eE,{"aria-label":"Select All",tabIndex:e.tabIndex,value:t,onChange:e=>n({type:"HEADER",checked:e})})},renderCell:e=>{let[t,n]=(0,e_.Gt)();return(0,r.jsx)(eC,{"aria-label":"Select",tabIndex:e.tabIndex,value:t,row:e.row,onChange:(t,r)=>{n({type:"ROW",row:e.row,checked:t,isShiftClick:r})},onClick:eN})},renderGroupCell:e=>{let[t,n]=(0,e_.Gt)();return(0,r.jsx)(eC,{"aria-label":"Select Group",tabIndex:e.tabIndex,value:t,onChange:t=>{n({type:"ROW",row:e.row,checked:t,isShiftClick:!1})},onClick:eN})},parent:void 0,level:0,minWidth:0,draggable:!1};function eN(e){e.stopPropagation()}function eC(e){let{row:t,value:n,tabIndex:a,disabled:s,onClick:l,onChange:i,"aria-label":c,"aria-labelledby":d}=e,{onEditRow:u}=(0,o.Qq)();return(0,r.jsxs)("div",{className:"sb-grid-select-cell__formatter","data-sentry-component":"SelectCellFormatter","data-sentry-source-file":"SelectColumn.tsx",children:[(0,r.jsx)("input",{"aria-label":c,"aria-labelledby":d,tabIndex:a,type:"checkbox",className:"rdg-row__select-column__select-action",disabled:s,checked:n,onChange:function(e){i(e.target.checked,e.nativeEvent.shiftKey)},onClick:l}),u&&t&&(0,r.jsxs)(eb.fC,{delayDuration:0,children:[(0,r.jsx)(eb.xz,{asChild:!0,children:(0,r.jsx)(p.z,{type:"text",size:"tiny",className:"px-1 rdg-row__select-column__edit-action",icon:(0,r.jsx)(ej.Z,{}),onClick:function(e){e.stopPropagation(),u&&t&&u(t)}})}),(0,r.jsx)(eb.h_,{children:(0,r.jsxs)(eb.VY,{side:"bottom",children:[(0,r.jsx)(eb.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,r.jsx)("span",{className:"text-xs text-foreground",children:"Expand row"})})]})})]})]})}function eE(e){let{disabled:t,tabIndex:n,value:a,onChange:s,onClick:l,"aria-label":i,"aria-labelledby":c}=e,{selectedRows:d,allRowsSelected:m}=(0,o.Qq)(),f=(0,u.useRef)(null),p=d.size>0&&!m;return(0,u.useEffect)(()=>{f.current&&(f.current.indeterminate=p)},[p]),(0,r.jsx)("div",{className:"sb-grid-select-cell__header","data-sentry-component":"SelectCellHeader","data-sentry-source-file":"SelectColumn.tsx",children:(0,r.jsx)("input",{ref:f,"aria-label":i,"aria-labelledby":c,tabIndex:n,type:"checkbox",className:"sb-grid-select-cell__header__input",disabled:t,checked:a,onChange:function(e){s(e.target.checked,e.nativeEvent.shiftKey)},onClick:l})})}var eS=n(68417);let ek=9;function eR(e,t){let n=[ew,...e.columns.map((e,n)=>{var o;let s=function(e){if((0,eS.Pm)(e))return"foreign_key";if((0,eS.v3)(e.dataType))return"number";if((0,eS.nr)(e.dataType))return"array";if((0,eS.om)(e.dataType))return"json";if((0,eS.II)(e.dataType))return"text";if((0,eS.kO)(e.format))return"citext";if((0,eS.VO)(e.format))return"date";else if((0,eS.LT)(e.format))return"time";else if((0,eS.Kp)(e.format))return"datetime";else if((0,eS.nL)(e.dataType))return"boolean";else if((0,eS.N8)(e.dataType))return"enum";else return"unknown"}(e),i=eA(e),c=(e.name.length+e.format.length)*ek,d=(null==t?void 0:t.defaultWidth)?t.defaultWidth:i<c?c:i;return{key:e.name,name:e.name,idx:n+1,resizable:!0,sortable:!0,width:d,minWidth:a.mr,frozen:e.isPrimaryKey||!1,isLastFrozenColumn:!1,renderHeaderCell:t=>(0,r.jsx)(ev,{...t,columnType:s,isPrimaryKey:e.isPrimaryKey,isEncrypted:e.isEncrypted,format:e.format,foreignKey:e.foreignKey}),renderEditCell:t?function(e,t,n,a,o){if(!n)return["array","json"].includes(t)?e=>(0,r.jsx)(F,{...e,isEditable:n,onExpandEditor:a}):["number","boolean"].includes(t)?void 0:e=>(0,r.jsx)($,{...e,isEditable:n,onExpandEditor:o});if(!e.isPrimaryKey&&e.isUpdatable)switch(t){case"boolean":return t=>(0,r.jsx)(l,{...t,isNullable:e.isNullable});case"date":return _("date",e.isNullable||!1);case"datetime":return e.format.endsWith("z")?_("datetimetz",e.isNullable||!1):_("datetime",e.isNullable||!1);case"time":return e.format.endsWith("z")?Q:G;case"enum":{let t=e.enum.map(e=>({label:e,value:e}));return n=>(0,r.jsx)(U,{...n,options:t,isNullable:e.isNullable})}case"array":case"json":return e=>(0,r.jsx)(F,{...e,onExpandEditor:a});case"number":return M;case"citext":case"text":return t=>(0,r.jsx)($,{...t,isEditable:n,isNullable:e.isNullable,onExpandEditor:o});default:return}}(e,s,null!==(o=null==t?void 0:t.editable)&&void 0!==o&&o,t.onExpandJSONEditor,t.onExpandTextEditor):void 0,renderCell:function(e,t,n){switch(t){case"boolean":return X;case"foreign_key":if(!e.isUpdatable)return ee;return e=>(0,r.jsx)(es,{...e,projectRef:n.projectRef,tableId:n.tableId});case"json":return el;default:return ee}}(e,s,{projectRef:null==t?void 0:t.projectRef,tableId:null==t?void 0:t.tableId}),parent:void 0,level:0,maxWidth:void 0,draggable:!1}})];return(null==t?void 0:t.onAddColumn)&&n.push(ec),n}function eA(e){return(0,eS.v3)(e.dataType)?120:(0,eS.Kp)(e.format)||(0,eS.VO)(e.format)||(0,eS.LT)(e.format)?150:(0,eS.nL)(e.dataType)?120:(0,eS.N8)(e.dataType)?150:250}},63635:function(e,t,n){n.d(t,{b:function(){return d}});var r=n(97458),a=n(52983),o=n(2054),s=n(19168),l=n(71904),i=n(43428),c=n(71794);let d=e=>{let{visible:t,onClose:n}=e;return(0,r.jsx)(o.Z,{size:"medium",visible:t,header:"Schemas managed by Supabase",customFooter:(0,r.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,r.jsx)(s.z,{type:"default",onClick:()=>n(),children:"Understood"})}),onCancel:()=>n(),"data-sentry-element":"Modal","data-sentry-component":"ProtectedSchemaModal","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,r.jsxs)(o.Z.Content,{className:"space-y-2","data-sentry-element":"unknown","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,r.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:i.s.map(e=>(0,r.jsx)("code",{className:"text-xs",children:e},e))}),(0,r.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,r.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]})})};t.Z=e=>{let{schema:t,entity:n}=e,[o,i]=(0,a.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.bZ,{"data-sentry-element":"Alert_Shadcn_","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,r.jsx)(c.Z,{strokeWidth:2,"data-sentry-element":"AlertCircle","data-sentry-source-file":"ProtectedSchemaWarning.tsx"}),(0,r.jsxs)(l.Cd,{"data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:["Currently viewing ",n," from a protected schema"]}),(0,r.jsxs)(l.X,{"data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,r.jsxs)("p",{className:"mb-2",children:["The ",(0,r.jsx)("code",{className:"text-xs",children:t})," schema is managed by Supabase and is read-only through the dashboard."]}),(0,r.jsx)(s.z,{type:"default",size:"tiny",onClick:()=>i(!0),"data-sentry-element":"Button","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Learn more"})]})]}),(0,r.jsx)(d,{visible:o,onClose:()=>i(!1),"data-sentry-element":"ProtectedSchemaModal","data-sentry-source-file":"ProtectedSchemaWarning.tsx"})]})}},56311:function(e,t,n){n.d(t,{U:function(){return o},h:function(){return s}});var r=n(97458),a=n(98261);let o=()=>(0,r.jsx)("div",{className:"p-2 col-span-full","data-sentry-component":"TableGridInnerLoadingState","data-sentry-source-file":"LoadingState.tsx",children:(0,r.jsx)(a.A,{"data-sentry-element":"GenericSkeletonLoader","data-sentry-source-file":"LoadingState.tsx"})}),s=()=>(0,r.jsxs)("div",{className:"flex flex-col","data-sentry-component":"TableGridSkeletonLoader","data-sentry-source-file":"LoadingState.tsx",children:[(0,r.jsx)("div",{className:"h-10 bg-dash-sidebar"}),(0,r.jsx)("div",{className:"h-9 border-y"}),(0,r.jsx)(o,{"data-sentry-element":"TableGridInnerLoadingState","data-sentry-source-file":"LoadingState.tsx"})]})},27818:function(e,t,n){n.d(t,{S:function(){return i},x:function(){return c}});var r=n(97458),a=n(13948),o=n(58636),s=n(39677),l=n(74039);let i=e=>e.map(e=>({id:e.id,name:e.constraint_name,tableId:e.target_id,schema:e.target_schema,table:e.target_table,columns:e.source_columns.map((t,n)=>({source:t,target:e.target_columns[n]})),deletionAction:e.deletion_action,updateAction:e.update_action})),c=(e,t,n)=>{var i;let c="update"===e?"Updating":"Deleting",d=null!==(i=(0,l.s8)(t))&&void 0!==i?i:"No action";switch(t){case o.N.NO_ACTION:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will"," ",(0,r.jsx)("span",{className:"text-amber-900 opacity-75",children:"raise an error"})," if there are records existing in this table that reference it"]});case o.N.CASCADE:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will"," ",(0,r.jsxs)("span",{className:"text-amber-900 opacity-75",children:["also ",e]})," any records that reference it in this table"]});case o.N.RESTRICT:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),(0,r.jsxs)(a.fC,{delayDuration:0,children:[(0,r.jsx)(a.xz,{className:"translate-y-[3px] mx-1",children:(0,r.jsx)(s.Z,{className:"text-foreground-light",size:16,strokeWidth:1.5})}),(0,r.jsx)(a.h_,{children:(0,r.jsxs)(a.VY,{side:"bottom",children:[(0,r.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-[300px] space-y-2 border border-background",children:(0,r.jsx)("p",{className:"text-xs text-foreground",children:"This is similar to no action, but the restrict check cannot be deferred till later in the transaction"})})]})})]}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will"," ",(0,r.jsxs)("span",{className:"text-amber-900 opacity-75",children:["prevent ",c.toLowerCase()]})," ","existing referencing rows from this table."]});case o.N.SET_DEFAULT:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will set the value of any existing records in this table referencing it to their"," ",(0,r.jsx)("span",{className:"text-amber-900 opacity-75",children:"default value"})]});case o.N.SET_NULL:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-foreground-light",children:d}),": ",c," a record from"," ",(0,r.jsx)("code",{className:"text-xs text-foreground-light",children:n})," will set the value of any existing records in this table referencing it"," ",(0,r.jsx)("span",{className:"text-amber-900 opacity-75",children:"to NULL"})]})}}},27614:function(e,t,n){var r=n(97458),a=n(13948),o=n(2552),s=n(19168);t.Z=e=>{let{title:t="",size:n="medium",children:l,ctaButtonLabel:i="",infoButtonLabel:c="",infoButtonUrl:d="",onClickCta:u=()=>{},loading:m=!1,disabled:f=!1,disabledMessage:p=""}=e,h=i&&u||d&&c;return(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center","data-sentry-component":"ProductEmptyState","data-sentry-source-file":"ProductEmptyState.tsx",children:(0,r.jsx)("div",{className:"flex space-x-4 rounded border bg-surface-100 p-6 shadow-md",children:(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsxs)("div",{className:"".concat("medium"===n?"w-80":"w-[400px]"," space-y-4"),children:[(0,r.jsx)("h5",{className:"text-foreground",children:t}),(0,r.jsx)("div",{className:"flex flex-col space-y-2 text-foreground-light",children:l}),h&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[i&&u&&(0,r.jsxs)(a.fC,{delayDuration:0,children:[(0,r.jsx)(a.xz,{asChild:!0,children:(0,r.jsx)(s.z,{type:"primary",onClick:u,loading:m,disabled:m||f,children:i})}),f&&p.length>0&&(0,r.jsx)(a.h_,{children:(0,r.jsxs)(a.VY,{side:"bottom",children:[(0,r.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,r.jsx)("span",{className:"text-xs text-foreground",children:p})})]})})]}),d&&c?(0,r.jsx)(s.z,{type:"default",icon:(0,r.jsx)(o.Z,{strokeWidth:1.5}),children:(0,r.jsx)("a",{target:"_blank",rel:"noreferrer",href:d,children:c})}):null]})]})})})})}},52065:function(e,t,n){var r=n(97458),a=n(71598),o=n(62836),s=n(2552),l=n(37669),i=n.n(l),c=n(52983),d=n(19168);let u=(0,c.forwardRef)((e,t)=>{let{icon:n,title:l,description:u,url:m,urlLabel:f="Read more",defaultVisibility:p=!1,hideCollapse:h=!1,button:x,className:g="",block:y=!1}=e,[v,b]=(0,c.useState)(p);return(0,r.jsx)("div",{ref:t,role:"alert",className:"".concat(y?"block w-full":"","\n      block w-full rounded-md border bg-surface-300/25 py-3 ").concat(g),children:(0,r.jsxs)("div",{className:"flex flex-col px-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[n&&(0,r.jsx)("span",{className:"text-foreground-lighter",children:n}),(0,r.jsx)("div",{className:"flex-grow",children:(0,r.jsx)("h5",{className:"text-sm text-foreground",children:l})})]}),u&&!h?(0,r.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>b(!v),children:v?(0,r.jsx)(a.Z,{size:14,strokeWidth:1.5}):(0,r.jsx)(o.Z,{size:14,strokeWidth:1.5})}):null]}),(u||m||x)&&(0,r.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(v?"mt-3":""),style:{maxHeight:v?500:0},children:[(0,r.jsx)("div",{className:"text-foreground-light text-sm",children:u}),m&&(0,r.jsx)("div",{children:(0,r.jsx)(d.z,{asChild:!0,type:"default",icon:(0,r.jsx)(s.Z,{}),children:(0,r.jsx)(i(),{href:m,target:"_blank",rel:"noreferrer",children:f})})}),x&&(0,r.jsx)("div",{children:x})]})]})})});u.displayName="InformationBox",t.Z=u},28763:function(e,t,n){n.d(t,{Sf:function(){return g},xg:function(){return h},yF:function(){return x}});var r=n(97458),a=n(36457),o=n(53995),s=n(52983),l=n(69468),i=n(4673),c=n(20170),d=n(59650),u=n(50853),m=n(15997),f=n(44190),p=n(11731);function h(e){let{queryClient:t,projectRef:n,connectionString:r,id:a,sorts:o,filters:s,impersonatedRole:c}=e;return(0,d.nq)(t,{projectRef:n,connectionString:r,id:a}).then(e=>{if(e){var d;let m=(0,i.NK)(e),{sorts:p=[],filters:h=[]}=null!==(d=(0,l.v)(n,e.name,e.schema))&&void 0!==d?d:{};(0,u.Ue)(t,{projectRef:n,connectionString:r,tableId:a,sorts:null!=o?o:(0,i.rg)(m.name,p),filters:null!=s?s:(0,i.Yb)(h),page:1,limit:f.Re,impersonatedRole:c})}})}function x(){let e=(0,o.useRouter)(),t=(0,a.NL)(),{project:n}=(0,c.d2)(),r=(0,m.fN)();return(0,s.useCallback)(a=>{let{id:o,filters:s,sorts:l}=a,i=o?Number(o):void 0;!n||!i||isNaN(i)||(e.prefetch("/project/".concat(n.ref,"/editor/").concat(i)),h({queryClient:t,projectRef:n.ref,connectionString:n.connectionString,id:i,sorts:l,filters:s,impersonatedRole:r.role}).catch(()=>{}))},[n,t,r.role,e])}function g(e){let{projectRef:t,id:n,sorts:a,filters:o,href:s,children:l,...i}=e,c=x();return(0,r.jsx)(p.Z,{href:s||"/project/".concat(t,"/editor/").concat(n),prefetcher:()=>c({id:n,sorts:a,filters:o}),...i,"data-sentry-element":"PrefetchableLink","data-sentry-component":"EditorTablePageLink","data-sentry-source-file":"project.$ref.editor.$id.tsx",children:l})}},23729:function(e,t,n){var r=n(97458),a=n(52983),o=n(19571),s=n(45094),l=n(29879),i=n(82188),c=n(41879);function d(e){let{autoComplete:t,autofocus:n,children:d,className:u,descriptionText:m,disabled:f,error:p,icon:h,id:x="",inputRef:g,label:y,afterLabel:v,beforeLabel:b,labelOptional:j,layout:_,name:w="",onChange:N,onBlur:C,placeholder:E,required:S,value:k,defaultValue:R,style:A,size:T="medium",borderless:L=!1,validation:I,...O}=e,{formContextOnChange:q,values:P,errors:D,handleBlur:z,touched:F,fieldLevelValidation:Z}=(0,c.G)();P&&!k&&(k=P[x]),p||(D&&!p&&(p=D[x||w]),p=F&&F[x||w]?p:void 0),(0,a.useEffect)(()=>{I&&Z(x,I(k))},[]);let M=(0,i.Z)("select"),U=[M.container];u&&U.push(u);let W=[M.base];return p&&W.push(M.variants.error),p||W.push(M.variants.standard),h&&W.push(M.with_icon),T&&W.push(M.size[T]),f&&W.push(M.disabled),(0,r.jsx)(o.l,{label:y,afterLabel:v,beforeLabel:b,labelOptional:j,layout:_,id:x,error:p,descriptionText:m,className:u,style:A,size:T,"data-sentry-element":"FormLayout","data-sentry-component":"Select","data-sentry-source-file":"Select.tsx",children:(0,r.jsxs)("div",{className:M.container,children:[(0,r.jsx)("select",{id:x,name:w,"data-size":T,defaultValue:R,autoComplete:t,autoFocus:n,className:W.join(" "),onChange:function(e){N&&N(e),q&&q(e),I&&Z(x,I(e.target.value))},onBlur:function(e){z&&z(e),C&&C(e)},ref:g,value:k,disabled:f,required:S,placeholder:E,...O,children:d}),h&&(0,r.jsx)(l.Z,{size:T,icon:h}),p&&(0,r.jsx)("div",{className:M.actions_container,children:p&&(0,r.jsx)(s.Z,{size:T})}),(0,r.jsx)("span",{className:M.chevron_container,children:(0,r.jsx)("svg",{className:M.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Select.tsx",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Select.tsx"})})})]})})}d.Option=function(e){let{value:t,children:n,selected:a}=e;return(0,r.jsx)("option",{value:t,selected:a,"data-sentry-component":"Option","data-sentry-source-file":"Select.tsx",children:n})},d.OptGroup=function(e){let{label:t,children:n}=e;return(0,r.jsx)("optgroup",{label:t,"data-sentry-component":"OptGroup","data-sentry-source-file":"Select.tsx",children:n})},t.ZP=d}}]);