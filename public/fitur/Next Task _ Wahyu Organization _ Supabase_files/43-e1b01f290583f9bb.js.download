!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="755862f4-d053-4cc4-90ea-e323edabd57f",e._sentryDebugIdIdentifier="sentry-dbid-755862f4-d053-4cc4-90ea-e323edabd57f")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43],{95091:function(e,t,s){s.d(t,{T:function(){return d}});var n=s(36457),a=s(64618),r=s(34549),i=s(61250),l=s(1133);async function o(e){let{projectRef:t,userId:s}=e,{data:n,error:a}=await (0,i.IV)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:t,id:s}}});return a&&(0,i.S3)(a),n}let d=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,n.NL)();return(0,a.D)(e=>o(e),{async onSuccess(t,s,n){let{projectRef:a,skipInvalidation:r=!1}=s;r||await Promise.all([i.invalidateQueries(l.o.usersInfinite(a)),i.invalidateQueries(l.o.usersCount(a))]),await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?r.Am.error("Failed to delete user: ".concat(e.message)):t(e,s,n)},...s})}},83154:function(e,t,s){s.d(t,{x7:function(){return d}});var n=s(90688),a=s(29020),r=s(51735),i=s(77946),l=s(1133);let o=e=>{let{page:t=0,verified:s,keywords:n,providers:a,sort:r,order:i}=e,l=[];n&&""!==n&&l.push("id::text like '%".concat(n,"%' or email like '%").concat(n,"%' or phone like '%").concat(n,"%'")),"verified"===s?l.push("email_confirmed_at IS NOT NULL or phone_confirmed_at IS NOT NULL"):"anonymous"===s?l.push("is_anonymous is true"):"unverified"===s&&l.push("email_confirmed_at IS NULL AND phone_confirmed_at IS NULL"),a&&a.length>0&&(a.includes("saml 2.0")?l.push("(select jsonb_agg(case when value ~ '^sso' then 'sso' else value end) from jsonb_array_elements_text((raw_app_meta_data ->> 'providers')::jsonb)) ?| array[".concat(a.map(e=>"saml 2.0"===e?"'sso'":"'".concat(e,"'")).join(", "),"]").trim()):l.push("(raw_app_meta_data->>'providers')::jsonb ?| array[".concat(a.map(e=>"'".concat(e,"'")).join(", "),"]")));let o=l.map(e=>"(".concat(e,")")).join(" and ");return"".concat("select * from auth.users").concat(l.length>0?" where ".concat(o):"",' order by "').concat(null!=r?r:"created_at",'" ').concat(null!=i?i:"desc"," nulls last limit ").concat(50," offset ").concat(50*t,";")},d=function(e){let{projectRef:t,connectionString:s,keywords:d,filter:c,providers:u,sort:m,order:x}=e,{enabled:h=!0,...f}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},p=(0,r.Vm)(),v=(null==p?void 0:p.status)===i.S.ACTIVE_HEALTHY;return(0,n.N)(l.o.usersInfinite(t,{keywords:d,filter:c,providers:u,sort:m,order:x}),e=>{let{signal:n,pageParam:r}=e;return(0,a.R)({projectRef:t,connectionString:s,sql:o({page:r,verified:c,keywords:d,providers:u,sort:null!=m?m:"created_at",order:null!=x?x:"desc"}),queryKey:l.o.usersInfinite(t)},n)},{enabled:h&&void 0!==t&&v,getNextPageParam(e,t){let s=t.length;if(e.result.length<=50)return s},...f})}},90984:function(e,t,s){s.d(t,{w:function(){return d}});var n=s(97458),a=s(72871),r=s(86316),i=s(5546),l=s(37506),o=s(62365);let d=e=>{var t,s,d;let{user:c}=e,u=(0,o.Gf)(c),m="-"!==u,x=null!==c.phone,h=c.is_anonymous;return(0,n.jsx)("div",{className:(0,i.cn)(l.l),"data-sentry-component":"UserHeader","data-sentry-source-file":"UserHeader.tsx",children:x?(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("p",{children:c.phone}),(0,n.jsx)(r.Z,{iconOnly:!0,type:"text",icon:(0,n.jsx)(a.Z,{}),className:"px-1",text:null!==(t=null==c?void 0:c.phone)&&void 0!==t?t:""})]}):h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:"Anonymous user"}),(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:c.id}),(0,n.jsx)(r.Z,{iconOnly:!0,type:"text",icon:(0,n.jsx)(a.Z,{}),className:"px-1",text:null!==(s=null==c?void 0:c.id)&&void 0!==s?s:""})]})]}):(0,n.jsxs)(n.Fragment,{children:[m&&(0,n.jsx)("p",{children:u}),(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("p",{className:(0,i.cn)(m?"text-foreground-light text-sm":"text-foreground"),children:c.email}),(0,n.jsx)(r.Z,{iconOnly:!0,type:"text",icon:(0,n.jsx)(a.Z,{}),className:"px-1",text:null!==(d=null==c?void 0:c.email)&&void 0!==d?d:""})]})]})})}},71608:function(e,t,s){s.d(t,{KU:function(){return ed},ah:function(){return eo},wC:function(){return el}});var n=s(97458),a=s(198),r=s(28977),i=s.n(r),l=s(45196),o=s(44887),d=s(41272),c=s(42128),u=s(17471),m=s(14415),x=s(72871),h=s(37669),f=s.n(h),p=s(52983),v=s(34549),y=s(45925),g=s(97881),j=s(86316),b=s(5552),w=s(64618),_=s(55410),N=s(77946);async function C(e){let{projectRef:t,userId:s}=e,n=await (0,_.$v)("".concat(N.T5,"/auth/").concat(t,"/users/").concat(s,"/factors"));if(n.error)throw n.error;return n}let S=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.D)(e=>C(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.Am.error("Failed to delete the user's MFA factors: ".concat(e.message)):t(e,s,n)},...s})};var U=s(95091);async function k(e){let{projectRef:t,user:s}=e,n=await (0,_.v_)("".concat(N.T5,"/auth/").concat(t,"/recover"),s);if(n.error)throw n.error;return n}let A=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.D)(e=>k(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.Am.error("Failed to reset user password: ".concat(e.message)):t(e,s,n)},...s})};async function D(e){let{projectRef:t,user:s}=e,n=await (0,_.v_)("".concat(N.T5,"/auth/").concat(t,"/magiclink"),s);if(n.error)throw n.error;return n}let T=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.D)(e=>D(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.Am.error("Failed to send magic link: ".concat(e.message)):t(e,s,n)},...s})};async function z(e){let{projectRef:t,user:s}=e,n=await (0,_.v_)("".concat(N.T5,"/auth/").concat(t,"/otp"),s);if(n.error)throw n.error;return n}let L=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.D)(e=>z(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.Am.error("Failed to send magic link: ".concat(e.message)):t(e,s,n)},...s})};var P=s(36457),O=s(61250),Z=s(1133);async function E(e){let{projectRef:t,userId:s,banDuration:n}=e,{data:a,error:r}=await (0,O.r$)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:t,id:s}},body:{ban_duration:"number"==typeof n?"".concat(n,"h"):n}});return r&&(0,O.S3)(r),a}let I=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,P.NL)();return(0,w.D)(e=>E(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(Z.o.usersInfinite(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?v.Am.error("Failed to update user: ".concat(e.message)):t(e,s,n)},...s})};var M=s(87790),F=s(47878),B=s(5546),R=s(44273),W=s(19168),H=s(61911),X=s(587),q=s(1026),K=s(78751),G=s(86848),V=s(5394),Y=s(2054),Q=s(40241),J=s(40347),$=s(84629),ee=s(54720);let et=e=>{let{visible:t,user:s,onClose:a}=e,{ref:r}=(0,y.UO)(),{mutate:l,isLoading:o}=I({onSuccess:(e,t)=>{let s=i()().add(Number(t.banDuration),"hours").format("DD MMM YYYY HH:mm (ZZ)");v.Am.success("User banned successfully until ".concat(s)),a()}}),d=V.Ry({value:V.Z_().min(1,{message:"Please provide a duration"}),unit:V.Km(["hours","days"])}),c={value:"24",unit:"hours"},u=(0,G.cI)({mode:"onBlur",reValidateMode:"onChange",resolver:(0,K.F)(d),defaultValues:c}),{value:m,unit:x}=u.watch(),h=i()().add(Number(m),x).format("DD MMM YYYY HH:mm (ZZ)");return(0,p.useEffect)(()=>{t&&u.reset(c)},[t]),(0,n.jsx)(Y.Z,{hideFooter:!0,visible:t,size:"small",header:"Confirm to ban user",onCancel:()=>a(),"data-sentry-element":"Modal","data-sentry-component":"BanUserModal","data-sentry-source-file":"BanUserModal.tsx",children:(0,n.jsx)(Q.l0,{...u,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"BanUserModal.tsx",children:(0,n.jsxs)("form",{onSubmit:u.handleSubmit(e=>{if(void 0===r)return console.error("Project ref is required");if(void 0===s.id)return v.Am.error("Failed to ban user: User ID not found");let t="hours"===e.unit?Number(e.value):24*Number(e.value);l({projectRef:r,userId:s.id,banDuration:t})}),children:[(0,n.jsxs)(Y.Z.Content,{className:"flex flex-col gap-y-3","data-sentry-element":"unknown","data-sentry-source-file":"BanUserModal.tsx",children:[(0,n.jsx)("p",{className:"text-sm",children:"This will revoke the user's access to your project and prevent them from logging in for a specified duration."}),(0,n.jsxs)("div",{className:"flex items-start gap-x-2 [&>div:first-child]:flex-grow",children:[(0,n.jsx)(Q.Wi,{control:u.control,name:"value",render:e=>{let{field:t}=e;return(0,n.jsx)(ee.E,{className:"[&>div>div]:mt-0",label:"Set a ban duration",children:(0,n.jsx)(Q.NI,{children:(0,n.jsx)(J.I,{...t})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"BanUserModal.tsx"}),(0,n.jsx)(Q.Wi,{control:u.control,name:"unit",render:e=>{let{field:t}=e;return(0,n.jsx)(ee.E,{className:"[&>div>div]:mt-0 mt-[33px]",children:(0,n.jsx)(Q.NI,{children:(0,n.jsxs)($.Ph,{...t,value:t.value,onValueChange:e=>u.setValue("unit",e),children:[(0,n.jsx)($.i4,{className:"capitalize w-24",children:t.value}),(0,n.jsxs)($.Bw,{children:[(0,n.jsx)($.Ql,{value:"hours",children:"Hours"}),(0,n.jsx)($.Ql,{value:"days",children:"Days"})]})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"BanUserModal.tsx"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-foreground-lighter",children:"This user will not be able to log in until:"}),(0,n.jsx)("p",{className:(0,B.cn)("text-sm",!m&&"text-foreground-light"),children:m?h:"Invalid duration set"})]})]}),(0,n.jsx)(R.Z,{"data-sentry-element":"Separator","data-sentry-source-file":"BanUserModal.tsx"}),(0,n.jsxs)(Y.Z.Content,{className:"flex justify-end gap-2","data-sentry-element":"unknown","data-sentry-source-file":"BanUserModal.tsx",children:[(0,n.jsx)(W.z,{type:"default",disabled:o,onClick:()=>a(),"data-sentry-element":"Button","data-sentry-source-file":"BanUserModal.tsx",children:"Cancel"}),(0,n.jsx)(W.z,{type:"warning",htmlType:"submit",loading:o,"data-sentry-element":"Button","data-sentry-source-file":"BanUserModal.tsx",children:"Confirm ban"})]})]})})})};var es=s(90984),en=s(37506),ea=s(62365);let er="DD MMM, YYYY HH:mm",ei=(0,B.cn)("bg-surface-100 border-default text-foreground flex items-center justify-between","gap-x-4 border px-5 py-4 text-sm first:rounded-tr first:rounded-tl last:rounded-br last:rounded-bl"),el=e=>{var t,s,r,m,x,h,g;let{user:j,onDeleteSuccess:w}=e,{ref:_}=(0,y.UO)(),C=null!==j.email,k=null!==j.phone,D=null!==j.banned_until,z=(null!==(s=null===(t=j.raw_app_meta_data)||void 0===t?void 0:t.providers)&&void 0!==s?s:[]).map(e=>({name:e.startsWith("sso")?"SAML":e,icon:"email"===e?"".concat(N.GW,"/img/icons/email-icon2.svg"):ea.Bn[e]?"".concat(N.GW,"/img/icons/").concat(ea.Bn[e],".svg"):void 0})),P=(0,M.Xo)(a.KA.AUTH_EXECUTE,"*"),O=(0,M.Xo)(a.KA.AUTH_EXECUTE,"send_magic_link"),Z=(0,M.Xo)(a.KA.AUTH_EXECUTE,"send_recovery"),E=(0,M.Xo)(a.KA.AUTH_EXECUTE,"send_otp"),K=(0,M.Xo)(a.KA.TENANT_SQL_DELETE,"auth.users"),G=(0,M.Xo)(a.KA.TENANT_SQL_DELETE,"auth.mfa_factors"),[V,Y]=(0,p.useState)(),[Q,J]=(0,p.useState)(!1),[$,ee]=(0,p.useState)(!1),[el,ec]=(0,p.useState)(!1),[eu,em]=(0,p.useState)(!1),{data:ex}=(0,b.$E)({projectRef:_}),eh=null!==(r=null==ex?void 0:ex.MAILER_OTP_EXP)&&void 0!==r?r:0,ef=Math.floor(eh/60),ep=Math.floor(eh%60),ev="".concat(eh>60?"".concat(ef," minute").concat(ef>1?"s":""," ").concat(ep>0?"and":""," "):"").concat(ep>0?"".concat(ep," second").concat(ep>1?"s":""):""),{mutate:ey,isLoading:eg}=A({onSuccess:(e,t)=>{Y("send_recovery"),v.Am.success("Sent password recovery to ".concat(t.user.email))},onError:e=>{v.Am.error("Failed to send password recovery: ".concat(e.message))}}),{mutate:ej,isLoading:eb}=T({onSuccess:(e,t)=>{Y("send_magic_link"),v.Am.success("Sent magic link to ".concat(t.user.email))},onError:e=>{v.Am.error("Failed to send magic link: ".concat(e.message))}}),{mutate:ew,isLoading:e_}=L({onSuccess:(e,t)=>{Y("send_otp"),v.Am.success("Sent OTP to ".concat(t.user.phone))},onError:e=>{v.Am.error("Failed to send OTP: ".concat(e.message))}}),{mutate:eN}=(0,U.T)({onSuccess:()=>{v.Am.success("Successfully deleted ".concat(null==j?void 0:j.email)),ec(!1),w()}}),{mutate:eC}=S({onSuccess:()=>{v.Am.success("Successfully deleted the user's factors"),em(!1)}}),{mutate:eS,isLoading:eU}=I({onSuccess:()=>{v.Am.success("Successfully unbanned user"),ee(!1)}}),ek=async()=>(await (0,F.Vs)(200),_)?void 0===j.id?v.Am.error("Failed to delete user: User ID not found"):void eN({projectRef:_,userId:j.id}):console.error("Project ref is required"),eA=async()=>{if(await (0,F.Vs)(200),!_)return console.error("Project ref is required");eC({projectRef:_,userId:j.id})},eD=()=>void 0===_?console.error("Project ref is required"):void 0===j.id?v.Am.error("Failed to ban user: User ID not found"):void eS({projectRef:_,userId:j.id,banDuration:"none"});return(0,p.useEffect)(()=>{if(void 0!==V){let e=setTimeout(()=>Y(void 0),5e3);return()=>clearTimeout(e)}},[V]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(es.w,{user:j,"data-sentry-element":"UserHeader","data-sentry-source-file":"UserOverview.tsx"}),D?(0,n.jsx)(H.J,{type:"warning",label:"User banned until ".concat(i()(j.banned_until).format(er)),className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0"}):(0,n.jsx)(R.Z,{}),(0,n.jsxs)("div",{className:(0,B.cn)("flex flex-col gap-1.5",en.l),children:[(0,n.jsx)(eo,{property:"User UID",value:j.id,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Created at",value:j.created_at?i()(j.created_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Updated at",value:j.updated_at?i()(j.updated_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Invited at",value:j.invited_at,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Confirmation sent at",value:j.confirmation_sent_at,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Confirmed at",value:j.confirmed_at?i()(j.confirmed_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"Last signed in",value:j.last_sign_in_at?i()(j.last_sign_in_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(eo,{property:"SSO",value:j.is_sso_user,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"})]}),(0,n.jsxs)("div",{className:(0,B.cn)("flex flex-col !pt-0",en.l),children:[(0,n.jsx)("p",{children:"Provider Information"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"The user has the following providers"})]}),(0,n.jsx)("div",{className:(0,B.cn)("flex flex-col -space-y-1 !pt-0",en.l),children:z.map(e=>{var t,s,a;let r=q.Wm.find(t=>t.title.toLowerCase()===("linkedin"===e.name?"linkedin (oidc)":e.name)),i=Object.keys(null!==(t=null==r?void 0:r.properties)&&void 0!==t?t:{}).find(e=>e.toLowerCase().endsWith("_enabled")),o="email"===e.name?"email":"linkedin"===e.name?"LinkedIn":null!==(s=null==r?void 0:r.title)&&void 0!==s?s:e.name,d=null!==(a=null==ex?void 0:ex[i])&&void 0!==a&&a;return(0,n.jsxs)("div",{className:(0,B.cn)(ei,"items-start justify-start"),children:[e.icon&&(0,n.jsx)("img",{width:16,src:e.icon,alt:"".concat(e.name," auth icon"),className:(0,B.cn)("mt-1.5","github"===e.name?"dark:invert":"")}),(0,n.jsxs)("div",{className:"flex-grow mt-0.5",children:[(0,n.jsx)("p",{className:"capitalize",children:o}),(0,n.jsxs)("p",{className:"text-xs text-foreground-light",children:["Signed in with a ",o," account via"," ","SAML"===o?"SSO":"OAuth"]}),(0,n.jsx)(W.z,{asChild:!0,type:"default",className:"mt-2",children:(0,n.jsxs)(f(),{href:"/project/".concat(_,"/auth/providers?provider=").concat("SAML"===e.name?"SAML 2.0":e.name),children:["Configure ",o," provider"]})})]}),d?(0,n.jsxs)("div",{className:"flex items-center gap-1 rounded-full border border-brand-400 bg-brand-200 py-1 px-1 text-xs text-brand",children:[(0,n.jsx)("span",{className:"rounded-full bg-brand p-0.5 text-xs text-brand-200",children:(0,n.jsx)(l.Z,{strokeWidth:2,size:12})}),(0,n.jsx)("span",{className:"px-1",children:"Enabled"})]}):(0,n.jsx)("div",{className:"rounded-md border border-strong bg-surface-100 py-1 px-3 text-xs text-foreground-lighter",children:"Disabled"})]},e.name)})}),(0,n.jsx)(R.Z,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsxs)("div",{className:(0,B.cn)("flex flex-col -space-y-1",en.l),children:[C&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ed,{title:"Reset password",description:"Send a password recovery email to the user",button:{icon:(0,n.jsx)(o.Z,{}),text:"Send password recovery",isLoading:eg,disabled:!Z,onClick:()=>{_&&ey({projectRef:_,user:j})}},success:"send_recovery"===V?{title:"Password recovery sent",description:"The link in the email is valid for ".concat(ev)}:void 0}),(0,n.jsx)(ed,{title:"Send magic link",description:"Passwordless login via email for the user",button:{icon:(0,n.jsx)(o.Z,{}),text:"Send magic link",isLoading:eb,disabled:!O,onClick:()=>{_&&ej({projectRef:_,user:j})}},success:"send_magic_link"===V?{title:"Magic link sent",description:"The link in the email is valid for ".concat(ev)}:void 0})]}),k&&(0,n.jsx)(ed,{title:"Send OTP",description:"Passwordless login via phone for the user",button:{icon:(0,n.jsx)(o.Z,{}),text:"Send OTP",isLoading:e_,disabled:!E,onClick:()=>{_&&ew({projectRef:_,user:j})}},success:"send_otp"===V?{title:"OTP sent",description:"The link in the OTP SMS is valid for ".concat(ev)}:void 0})]}),(0,n.jsx)(R.Z,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsxs)("div",{className:(0,B.cn)("flex flex-col",en.l),children:[(0,n.jsx)("p",{children:"Danger zone"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Be wary of the following features as they cannot be undone."})]}),(0,n.jsxs)("div",{className:(0,B.cn)("flex flex-col -space-y-1 !pt-0",en.l),children:[(0,n.jsx)(ed,{title:"Remove MFA factors",description:"This will log the user out of all active sessions",button:{icon:(0,n.jsx)(d.Z,{}),text:"Remove MFA factors",disabled:!G,onClick:()=>em(!0)},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(ed,{title:D?"User is banned until ".concat(i()(j.banned_until).format(er)):"Ban user",description:D?"User has no access to the project until after this date":"Revoke access to the project for a set duration",button:{icon:(0,n.jsx)(c.Z,{}),text:D?"Unban user":"Ban user",disabled:!P,onClick:()=>{D?ee(!0):J(!0)}},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(ed,{title:"Delete user",description:"User will no longer have access to the project",button:{icon:(0,n.jsx)(u.Z,{}),type:"danger",text:"Delete user",disabled:!K,onClick:()=>ec(!0)},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"})]})]}),(0,n.jsx)(X.Z,{visible:el,variant:"destructive",title:"Confirm to delete user",confirmLabel:"Delete",onCancel:()=>ec(!1),onConfirm:()=>ek(),alert:{title:"Deleting a user is irreversible",description:"This will remove the user from the project and all associated data."},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UserOverview.tsx",children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to delete the user"," ",(0,n.jsx)("span",{className:"text-foreground",children:null!==(x=null!==(m=j.email)&&void 0!==m?m:j.phone)&&void 0!==x?x:"this user"}),"?"]})}),(0,n.jsx)(X.Z,{visible:eu,variant:"warning",title:"Confirm to remove MFA factors",confirmLabel:"Remove factors",confirmLabelLoading:"Removing",onCancel:()=>em(!1),onConfirm:()=>eA(),alert:{base:{variant:"warning"},title:"Removing MFA factors is irreversible",description:"This will log the user out of all active sessions."},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UserOverview.tsx",children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to remove the MFA factors for the user"," ",(0,n.jsx)("span",{className:"text-foreground",children:null!==(g=null!==(h=j.email)&&void 0!==h?h:j.phone)&&void 0!==g?g:"this user"}),"?"]})}),(0,n.jsx)(et,{visible:Q,user:j,onClose:()=>J(!1),"data-sentry-element":"BanUserModal","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(X.Z,{variant:"warning",visible:$,title:"Confirm to unban user",loading:eU,confirmLabel:"Unban user",confirmLabelLoading:"Unbanning",onCancel:()=>ee(!1),onConfirm:()=>eD(),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UserOverview.tsx",children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"The user will have access to your project again once unbanned. Are you sure you want to unban this user?"})})]})},eo=e=>{let{property:t,value:s}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2 group justify-between",children:[(0,n.jsx)("p",{className:" text-foreground-lighter text-sm",children:t}),"boolean"==typeof s?(0,n.jsx)("div",{className:"h-[26px] flex items-center justify-center min-w-[70px]",children:s?(0,n.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,n.jsx)(l.Z,{size:10,className:"text-contrast",strokeWidth:4})}):(0,n.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,n.jsx)(m.Z,{size:10,className:"text-contrast",strokeWidth:4})})}):(0,n.jsxs)("div",{className:"flex items-center gap-x-2 h-[26px] font-mono min-w-[40px]",children:[(0,n.jsx)("p",{className:"text-sm",children:s||"-"}),!!s&&(0,n.jsx)(j.Z,{iconOnly:!0,type:"text",icon:(0,n.jsx)(x.Z,{}),className:"transition opacity-0 group-hover:opacity-100 px-1",text:s})]})]}),(0,n.jsx)(R.Z,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"})]})},ed=e=>{var t,s,a;let{title:r,description:i,button:o,success:d,className:c}=e,u=null!==(t=null==o?void 0:o.disabled)&&void 0!==t&&t;return(0,n.jsxs)("div",{className:(0,B.cn)(ei,c),"data-sentry-component":"RowAction","data-sentry-source-file":"UserOverview.tsx",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:d?d.title:r}),(0,n.jsx)("p",{className:"text-xs text-foreground-light",children:d?d.description:i})]}),(0,n.jsx)(g.u,{type:null!==(s=null==o?void 0:o.type)&&void 0!==s?s:"default",icon:d?(0,n.jsx)(l.Z,{className:"text-brand"}):o.icon,loading:null!==(a=o.isLoading)&&void 0!==a&&a,onClick:o.onClick,disabled:u,tooltip:{content:{side:"bottom",text:u?"You need additional permissions to ".concat(o.text.toLowerCase()):void 0}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"UserOverview.tsx",children:o.text})]})}},37506:function(e,t,s){s.d(t,{l:function(){return S},i:function(){return U}});var n=s(97458),a=s(95948),r=s(14415),i=s(52983),l=s(51790),o=s(19168),d=s(23066),c=s(5546),u=s(40347),m=s(71608),x=s(17542),h=s(37669),f=s.n(h),p=s(45925),v=s(70888),y=s(98261),g=s(21988),j=s(44273),b=s(55203),w=s(61911),_=s(60005),N=s(90984);let C=e=>{let{user:t}=e,{ref:s}=(0,p.UO)(),{logData:a,isSuccess:r,isLoading:l,filters:d,refresh:u,setFilters:m}=(0,g.Z)({projectRef:s,table:v.ae.auth,filterOverride:{search_query:t.id},limit:5});return(0,i.useEffect)(()=>{t.id&&m({...d,search_query:t.id})},[t.id]),(0,n.jsxs)("div",{"data-sentry-component":"UserLogs","data-sentry-source-file":"UserLogs.tsx",children:[(0,n.jsx)(N.w,{user:t,"data-sentry-element":"UserHeader","data-sentry-source-file":"UserLogs.tsx"}),(0,n.jsx)(j.Z,{"data-sentry-element":"Separator","data-sentry-source-file":"UserLogs.tsx"}),(0,n.jsxs)("div",{className:(0,c.cn)("flex flex-col gap-y-3",S),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:"Authentication logs"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Latest logs from authentication for this user in the past hour"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(o.z,{type:"status_code"in d?"default":"secondary",className:"rounded-r-none border-r-0",disabled:l,onClick:()=>m({search_query:t.id}),"data-sentry-element":"Button","data-sentry-source-file":"UserLogs.tsx",children:"Show all"}),(0,n.jsx)("div",{className:"border-button border border-l-0 py-3"}),(0,n.jsx)(o.z,{type:"status_code"in d?"secondary":"default",className:"rounded-l-none border-l-0",disabled:l,onClick:()=>m({search_query:t.id,status_code:{client_error:!0,server_error:!0}}),"data-sentry-element":"Button","data-sentry-source-file":"UserLogs.tsx",children:"Error only"})]}),(0,n.jsx)(o.z,{type:"default",loading:l,disabled:l,icon:(0,n.jsx)(x.Z,{}),onClick:()=>u(),"data-sentry-element":"Button","data-sentry-source-file":"UserLogs.tsx",children:"Refresh"})]}),l&&!r?(0,n.jsx)(y.A,{}):0===a.length?(0,n.jsx)(w.J,{type:"note",title:"No authentication logs available for this user",description:"Auth events such as logging in will be shown here"}):(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"border border-b-0 rounded-t divide-y",children:a.map(e=>{var t;let s=(null!==(t=e.status)&&void 0!==t?t:"-").toString(),a=s.startsWith("4"),r=s.startsWith("5");return(0,n.jsxs)("div",{className:"flex items-center transition font-mono px-2 py-1.5 bg-surface-100 divide-x",children:[(0,n.jsx)("p",{className:"text-xs text-foreground-light min-w-[125px] w-[125px] px-1",children:(0,n.jsx)(_.c,{utcTimestamp:e.timestamp/1e3})}),(0,n.jsx)("div",{className:"flex items-center text-xs text-foreground-light h-[22px] min-w-[70px] w-[70px] px-2",children:(0,n.jsxs)("div",{className:(0,c.cn)("flex items-center justify-center gap-x-1",!!e.status&&"border px-1 py-0.5 rounded",a?"text-warning border-warning bg-warning-300":r?"text-destructive border-destructive bg-destructive-300":""),children:[(a||r)&&(0,n.jsx)(b.ku,{hideBackground:!0,className:(0,c.cn)(a&&"text-warning-600")}),s]})}),(0,n.jsx)("p",{className:"text-xs text-foreground-light px-2 truncate",children:"".concat(e.path," | ").concat(e.msg)})]},e.id)})}),(0,n.jsx)(o.z,{block:!0,asChild:!0,type:"outline",className:"transition rounded-t-none text-foreground-light hover:text-foreground",children:(0,n.jsx)(f(),{href:"/project/".concat(s,"/logs/auth-logs?s=").concat(t.id),children:"See more logs"})})]})]})]})},S="px-5 py-5",U=e=>{let{selectedUser:t,onClose:s}=e,[x,h]=(0,i.useState)("overview"),[f,p]=(0,i.useState)(""),v=t?Object.entries(t).filter(e=>{let[t,s]=e;return t.toLowerCase().includes(f.toLowerCase())||"string"==typeof s&&s.toLowerCase().includes(f.toLowerCase())}).reduce((e,t)=>{let[s,n]=t;return void 0!==n&&(e[s]=n),e},{}):{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Dp,{withHandle:!0,"data-sentry-element":"ResizableHandle","data-sentry-source-file":"UserPanel.tsx"}),(0,n.jsxs)(l.ee,{defaultSize:30,maxSize:45,minSize:30,className:"bg-studio border-t","data-sentry-element":"ResizablePanel","data-sentry-source-file":"UserPanel.tsx",children:[(0,n.jsx)(o.z,{type:"text",className:"absolute top-3 right-3 px-1",icon:(0,n.jsx)(r.Z,{}),onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"UserPanel.tsx"}),(0,n.jsxs)(d.mQ,{value:x,className:"flex flex-col h-full",onValueChange:e=>h(e),"data-sentry-element":"Tabs_Shadcn_","data-sentry-source-file":"UserPanel.tsx",children:[(0,n.jsxs)(d.dr,{className:"px-5 flex gap-x-4 min-h-[46px]","data-sentry-element":"TabsList_Shadcn_","data-sentry-source-file":"UserPanel.tsx",children:[(0,n.jsx)(d.SP,{value:"overview",className:"px-0 pb-0 h-full text-xs  data-[state=active]:bg-transparent !shadow-none","data-sentry-element":"TabsTrigger_Shadcn_","data-sentry-source-file":"UserPanel.tsx",children:"Overview"}),(0,n.jsx)(d.SP,{value:"logs",className:"px-0 pb-0 h-full text-xs data-[state=active]:bg-transparent !shadow-none","data-sentry-element":"TabsTrigger_Shadcn_","data-sentry-source-file":"UserPanel.tsx",children:"Logs"}),(0,n.jsx)(d.SP,{value:"raw",className:"px-0 pb-0 h-full text-xs data-[state=active]:bg-transparent !shadow-none","data-sentry-element":"TabsTrigger_Shadcn_","data-sentry-source-file":"UserPanel.tsx",children:"Raw JSON"})]}),(0,n.jsx)(d.nU,{value:"overview",className:(0,c.cn)("mt-0 flex-grow min-h-0 overflow-y-auto"),"data-sentry-element":"TabsContent_Shadcn_","data-sentry-source-file":"UserPanel.tsx",children:t&&(0,n.jsx)(m.wC,{user:t,onDeleteSuccess:s})}),(0,n.jsx)(d.nU,{value:"logs",className:(0,c.cn)("mt-0 flex-grow min-h-0 overflow-y-auto"),"data-sentry-element":"TabsContent_Shadcn_","data-sentry-source-file":"UserPanel.tsx",children:t&&(0,n.jsx)(C,{user:t})}),(0,n.jsxs)(d.nU,{value:"raw",className:(0,c.cn)("mt-0 flex-grow min-h-0 overflow-y-auto",S),"data-sentry-element":"TabsContent_Shadcn_","data-sentry-source-file":"UserPanel.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center mb-2",children:[(0,n.jsx)(u.I,{autoFocus:!0,type:"text",placeholder:"Filter...",value:f,onChange:e=>p(e.target.value),className:"mr-2","data-sentry-element":"Input_Shadcn_","data-sentry-source-file":"UserPanel.tsx"}),(0,n.jsx)(o.z,{type:"text",disabled:!f,onClick:()=>p(""),className:"text-xs","data-sentry-element":"Button","data-sentry-source-file":"UserPanel.tsx",children:"Clear"})]}),(0,n.jsx)(a.c,{className:"javascript","data-sentry-element":"SimpleCodeBlock","data-sentry-source-file":"UserPanel.tsx",children:JSON.stringify(v,null,2)})]})]})]})]})}},62365:function(e,t,s){s.d(t,{Rs:function(){return D},Bi:function(){return b},E$:function(){return A},Gf:function(){return k},KG:function(){return j},Bn:function(){return N}});var n=s(97458),a=s(28977),r=s.n(a),i=s(98038),l=s(44914),o=s(77946),d=s(65497),c=s(5546),u=s(63204),m=s(30892),x=s(89451),h=s(52983),f=s(77518),p=s(19168);let v=e=>{let{col:t,setSortByValue:s}=e,a=(0,h.useRef)(0),[r,i]=(0,h.useState)(!1);return(0,h.useEffect)(()=>{a.current=Number(new Date)},[r]),(0,n.jsxs)("div",{className:"flex items-center justify-between font-normal text-xs w-full","data-sentry-component":"HeaderCell","data-sentry-source-file":"UsersGridComponents.tsx",children:[(0,n.jsx)("div",{className:"flex items-center gap-x-2",children:(0,n.jsx)("p",{className:"!text-foreground",children:t.name})}),["created_at","email","phone"].includes(t.id)&&(0,n.jsxs)(f.h_,{open:r,onOpenChange:e=>{!1===e&&Number(new Date)-a.current>100&&i(e)},children:[(0,n.jsx)(f.$F,{asChild:!0,children:(0,n.jsx)(p.z,{type:"text",icon:(0,n.jsx)(u.Z,{}),className:"p-0 h-5 w-5",onClick:()=>i(!r)})}),(0,n.jsxs)(f.AW,{className:"w-36",children:[(0,n.jsxs)(f.Xi,{className:"flex items-center gap-x-2",onClick:()=>{i(!1),s("".concat(t.id,":desc"))},children:[(0,n.jsx)(m.Z,{size:14}),"Sort descending"]}),(0,n.jsxs)(f.Xi,{className:"flex items-center gap-x-2",onClick:()=>{i(!1),s("".concat(t.id,":asc"))},children:[(0,n.jsx)(x.Z,{size:14}),"Sort ascending"]})]})]})]})};var y=s(82015);let g=["https://avatars.githubusercontent.com","https://lh3.googleusercontent.com"],j=e=>{let{currentTarget:t}=e;return t.scrollTop+10>=t.scrollHeight-t.clientHeight},b=e=>e.map(e=>{var t,s,n,a;let r=null!==(n=null===(t=e.raw_app_meta_data)||void 0===t?void 0:t.provider)&&void 0!==n?n:"",i=(null!==(a=null===(s=e.raw_app_meta_data)||void 0===s?void 0:s.providers)&&void 0!==a?a:[]).map(e=>e.startsWith("sso")?"SAML":e);return{id:e.id,email:e.email,phone:e.phone,created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,providers:e.is_anonymous?"-":i,provider_icons:i.map(e=>"email"===e?"".concat(o.GW,"/img/icons/email-icon2.svg"):"SAML"===e?"".concat(o.GW,"/img/icons/saml-icon.svg"):N[e]?"".concat(o.GW,"/img/icons/").concat(N[e],".svg"):void 0).filter(Boolean),provider_type:e.is_anonymous?"Anonymous":"email"===r?"-":C.includes(r)?"Social":S.includes(r)?"Phone":"-",img:A(e),name:k(e)}}),w=[{email:"email-icon2"},{apple:"apple-icon"},{azure:"microsoft-icon"},{bitbucket:"bitbucket-icon"},{discord:"discord-icon"},{facebook:"facebook-icon"},{figma:"figma-icon"},{github:"github-icon"},{gitlab:"gitlab-icon"},{google:"google-icon"},{kakao:"kakao-icon"},{keycloak:"keycloak-icon"},{linkedin:"linkedin-icon"},{notion:"notion-icon"},{twitch:"twitch-icon"},{twitter:"twitter-icon"},{slack:"slack-icon"},{spotify:"spotify-icon"},{workos:"workos-icon"},{zoom:"zoom-icon"}],_=[{twilio:"twilio-icon"},{messagebird:"messagebird-icon"},{textlocal:"messagebird-icon"},{vonage:"messagebird-icon"},{twilioverify:"twilio-verify-icon"}],N=Object.values([...w,..._]).reduce((e,t)=>{let[[s,n]]=Object.entries(t);return{...e,[s]:n}},{}),C=w.map(e=>{let[t]=Object.keys(e);return t}),S=_.map(e=>{let[t]=Object.keys(e);return t});function U(e){if(e){if("string"==typeof e)return e;if(Array.isArray(e))return e.map(e=>U(e)).join(" ");try{return JSON.stringify(e)}catch(e){}}}function k(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",{custom_claims:n,displayName:a,display_name:r,fullName:i,full_name:l,familyName:o,family_name:d,givenName:c,given_name:u,surname:m,lastName:x,last_name:h,firstName:f,first_name:p}=null!==(t=e.raw_user_meta_data)&&void 0!==t?t:{},{displayName:v,display_name:y,fullName:g,full_name:j,familyName:b,family_name:w,givenName:_,given_name:N,surname:C,lastName:S,last_name:k,firstName:A,first_name:D}=null!=n?n:{},T=U(o||d||m||x||h||b||w||C||S||k),z=U(c||u||f||p||_||N||A||D);return U(a||r||v||y||i||l||g||j||z&&T&&"".concat(z," ").concat(T)||T||z)||s}function A(e){var t;let{avatarUrl:s,avatarURL:n,avatar_url:a,profileUrl:r,profileURL:i,profile_url:l,profileImage:o,profile_image:d,profileImageUrl:c,profileImageURL:u,profile_image_url:m}=null!==(t=e.raw_user_meta_data)&&void 0!==t?t:{},x=s||n||a||o||d||r||i||l||c||u||m||"";if("string"==typeof x)return g.some(e=>x.startsWith(e))?x:void 0}let D=e=>{var t;let{config:s,users:a,visibleColumns:o=[],setSortByValue:u}=e,m=null!==(t=s.map(e=>e.id))&&void 0!==t?t:y.O.map(e=>e.id),x=y.O.map(e=>{var t,o,m;let x=s.find(t=>t.id===e.id);return{key:e.id,name:e.name,resizable:null===(t=e.resizable)||void 0===t||t,sortable:!1,draggable:!0,width:null!==(o=null==x?void 0:x.width)&&void 0!==o?o:e.width,minWidth:null!==(m=e.minWidth)&&void 0!==m?m:120,headerCellClass:"z-50 outline-none !shadow-none",renderHeaderCell:()=>{if("img"!==e.id)return(0,n.jsx)(v,{col:e,setSortByValue:u})},renderCell:t=>{let{row:s}=t,[o,u]=(0,l.Gt)(),m=null==s?void 0:s[e.id],x=null==a?void 0:a.find(e=>e.id===s.id),h=null!==m&&["created_at","last_sign_in_at"].includes(e.id)?r()(m).format("ddd DD MMM YYYY HH:mm:ss [GMT]ZZ"):Array.isArray(m)?m.join(", "):m,f=!!(null==x?void 0:x.confirmed_at);return"img"===e.id?(0,n.jsxs)("div",{className:"flex items-center justify-center gap-x-2",children:[(0,n.jsx)(d.X,{checked:o,onClick:e=>{e.stopPropagation(),u({row:s,type:"ROW",checked:!o,isShiftClick:e.shiftKey})}}),(0,n.jsx)("div",{className:(0,c.cn)("flex items-center justify-center w-6 h-6 rounded-full bg-center bg-cover bg-no-repeat",s.img?"border":"bg-selection"),style:{backgroundImage:s.img?"url('".concat(s.img,"')"):"none"},children:!s.img&&(0,n.jsx)(i.Z,{size:12})})]}):(0,n.jsxs)("div",{className:(0,c.cn)("w-full flex items-center text-xs",e.id.includes("provider")?"capitalize":""),children:["providers"===e.id&&s.provider_icons.map((e,t)=>{let a=s.providers[t];return(0,n.jsx)("div",{className:"min-w-6 min-h-6 rounded-full border flex items-center justify-center bg-surface-75",style:{marginLeft:0===t?0:"-8px",zIndex:s.provider_icons.length-t},children:(0,n.jsx)("img",{width:16,src:e,alt:"".concat(a," auth icon"),className:(0,c.cn)("github"===a&&"dark:invert")},"".concat(null==x?void 0:x.id,"-").concat(a))})}),"last_sign_in_at"!==e.id||f?(0,n.jsx)("p",{className:(0,c.cn)("providers"===e.id&&"ml-1"),children:null===h?"-":h}):(0,n.jsx)("p",{className:"text-foreground-lighter",children:"Waiting for verification"})]})}}}),h=x.find(e=>"img"===e.key);return m.length>0&&(x=x.filter(e=>m.includes(e.key)).sort((e,t)=>m.indexOf(e.key)-m.indexOf(t.key))),0===o.length?x:[h].concat(x.filter(e=>o.includes(e.key)))}},82015:function(e,t,s){s.d(t,{O:function(){return eb},r:function(){return ew}});var n=s(97458),a=s(52983),r=s(36457),i=s(12832),l=s(17471),o=s(14415),d=s(78854),c=s(51478),u=s(24544),m=s(17542),x=s(3755),h=s(70437),f=s(44914),p=s(34549),v=s(45925),y=s(17221),g=s(20170),j=s(61223),b=s(13430),w=s(97705),_=s(8504),N=s(1133),C=s(95091),S=s(28894),U=s(29020);let k=e=>{let{filter:t,keywords:s,providers:n}=e,a=[];s&&""!==s&&a.push("id::text ilike '%".concat(s,"%' or email ilike '%").concat(s,"%' or phone ilike '%").concat(s,"%'")),"verified"===t?a.push("email_confirmed_at IS NOT NULL or phone_confirmed_at IS NOT NULL"):"anonymous"===t?a.push("is_anonymous is true"):"unverified"===t&&a.push("email_confirmed_at IS NULL AND phone_confirmed_at IS NULL"),n&&n.length>0&&(n.includes("saml 2.0")?a.push("(select jsonb_agg(case when value ~ '^sso' then 'sso' else value end) from jsonb_array_elements_text((raw_app_meta_data ->> 'providers')::jsonb)) ?| array[".concat(n.map(e=>"saml 2.0"===e?"'sso'":"'".concat(e,"'")).join(", "),"]").trim()):a.push("(raw_app_meta_data->>'providers')::jsonb ?| array[".concat(n.map(e=>"'".concat(e,"'")).join(", "),"]")));let r=a.map(e=>"(".concat(e,")")).join(" and ");return"".concat("select count(*) from auth.users").concat(a.length>0?" where ".concat(r):"",";")};async function A(e,t){var s;let{projectRef:n,connectionString:a,keywords:r,filter:i,providers:l}=e,o=k({filter:i,keywords:r,providers:l}),{result:d}=await (0,U.R)({projectRef:n,connectionString:a,sql:o,queryKey:["users-count"]},t),c=null==d?void 0:null===(s=d[0])||void 0===s?void 0:s.count;if("number"!=typeof c)throw Error("Error fetching users count");return c}let D=function(e){let{projectRef:t,connectionString:s,keywords:n,filter:a,providers:r}=e,{enabled:i=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,S.a)(N.o.usersCount(t,{keywords:n,filter:a,providers:r}),e=>{let{signal:i}=e;return A({projectRef:t,connectionString:s,keywords:n,filter:a,providers:r},i)},{enabled:i&&void 0!==t,...l})};var T=s(83154),z=s(36421),L=s(77946),P=s(19168),O=s(84629),Z=s(5546),E=s(77518),I=s(5423),M=s(51790),F=s(30413),B=s(587),R=s(88586),W=s(198),H=s(63204),X=s(44887),q=s(23683),K=s(87790),G=s(82445),V=s(78751),Y=s(67328),Q=s(86848),J=s(5394),$=s(64618),ee=s(61250);async function et(e){let{projectRef:t,user:s}=e,{data:n,error:a}=await (0,ee.v_)("/platform/auth/{ref}/users",{params:{path:{ref:t}},body:{email:s.email,password:s.password,email_confirm:s.autoConfirmUser}});return a&&(0,ee.S3)(a),n}let es=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,r.NL)();return(0,$.D)(e=>et(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await Promise.all([n.invalidateQueries(N.o.usersInfinite(r)),n.invalidateQueries(N.o.usersCount(r))]),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?p.Am.error("Failed to create user: ".concat(e.message)):t(e,s,n)},...s})};var en=s(7208),ea=s(40241),er=s(40347),ei=s(65497);let el=J.Ry({email:J.Z_().min(1,"Email is required").email("Must be a valid email address"),password:J.Z_().min(1,"Password is required"),autoConfirmUser:J.O7()});var eo=e=>{let{visible:t,setVisible:s}=e,{ref:a}=(0,v.UO)(),r=(0,K.Xo)(W.KA.AUTH_EXECUTE,"create_user"),{mutate:i,isLoading:l}=es({onSuccess(e){p.Am.success("Successfully created user: ".concat(e.email)),d.reset({email:"",password:"",autoConfirmUser:!0}),s(!1)}}),o=async e=>{if(!a)return console.error("Project ref is required");i({projectRef:a,user:e})},d=(0,Q.cI)({resolver:(0,V.F)(el),defaultValues:{email:"",password:"",autoConfirmUser:!0}});return(0,n.jsx)(en.Vq,{open:t,onOpenChange:s,"data-sentry-element":"Dialog","data-sentry-component":"CreateUserModal","data-sentry-source-file":"CreateUserModal.tsx",children:(0,n.jsxs)(en.cZ,{size:"small","data-sentry-element":"DialogContent","data-sentry-source-file":"CreateUserModal.tsx",children:[(0,n.jsx)(en.fK,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateUserModal.tsx",children:(0,n.jsx)(en.$N,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateUserModal.tsx",children:"Create a new user"})}),(0,n.jsx)(en.P3,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"CreateUserModal.tsx"}),(0,n.jsx)(ea.l0,{...d,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateUserModal.tsx",children:(0,n.jsxs)("form",{id:"create-user",className:"flex flex-col gap-y-4 p-6",onSubmit:d.handleSubmit(o),children:[(0,n.jsx)(ea.Wi,{name:"email",control:d.control,render:e=>{let{field:t}=e;return(0,n.jsxs)(ea.xJ,{className:"flex flex-col gap-1",children:[(0,n.jsx)(ea.lX,{children:"Email address"}),(0,n.jsx)(ea.NI,{children:(0,n.jsxs)("div",{className:"items-center relative",children:[(0,n.jsx)(X.Z,{size:18,className:"absolute left-2 top-1/2 transform -translate-y-1/2",strokeWidth:1.5}),(0,n.jsx)(er.I,{autoFocus:!0,...t,autoComplete:"off",type:"email",name:"email",placeholder:"user@example.com",disabled:l,className:"pl-8"})]})}),(0,n.jsx)(ea.zG,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateUserModal.tsx"}),(0,n.jsx)(ea.Wi,{name:"password",control:d.control,render:e=>{let{field:t}=e;return(0,n.jsxs)(ea.xJ,{className:"flex flex-col gap-1",children:[(0,n.jsx)(ea.lX,{children:"User Password"}),(0,n.jsx)(ea.NI,{children:(0,n.jsxs)("div",{className:"items-center relative",children:[(0,n.jsx)(Y.Z,{size:18,className:"absolute left-2 top-1/2 transform -translate-y-1/2",strokeWidth:1.5}),(0,n.jsx)(er.I,{...t,autoComplete:"new-password",type:"password",name:"password",placeholder:"••••••••",disabled:l,className:"pl-8"})]})}),(0,n.jsx)(ea.zG,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateUserModal.tsx"}),(0,n.jsx)(ea.Wi,{name:"autoConfirmUser",control:d.control,render:e=>{let{field:t}=e;return(0,n.jsxs)(ea.xJ,{className:"flex items-center gap-x-2",children:[(0,n.jsx)(ea.NI,{children:(0,n.jsx)(ei.X,{checked:t.value,onCheckedChange:e=>t.onChange(e)})}),(0,n.jsx)(ea.lX,{children:"Auto Confirm User?"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateUserModal.tsx"}),(0,n.jsx)(ea.lX,{"data-sentry-element":"FormLabel_Shadcn_","data-sentry-source-file":"CreateUserModal.tsx",children:(0,n.jsx)("p",{className:"text-sm text-foreground-lighter",children:"A confirmation email will not be sent when creating a user via this form."})}),(0,n.jsx)(P.z,{block:!0,size:"small",htmlType:"submit",loading:l,disabled:!r||l,"data-sentry-element":"Button","data-sentry-source-file":"CreateUserModal.tsx",children:"Create user"})]})})]})})};async function ed(e){let{projectRef:t,email:s}=e,{data:n,error:a}=await (0,ee.v_)("/platform/auth/{ref}/invite",{params:{path:{ref:t}},body:{email:s}});return a&&(0,ee.S3)(a),n}let ec=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,r.NL)();return(0,$.D)(e=>ed(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await Promise.all([n.invalidateQueries(N.o.usersInfinite(r)),n.invalidateQueries(N.o.usersCount(r))]),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?p.Am.error("Failed to invite user: ".concat(e.message)):t(e,s,n)},...s})};var eu=s(2054),em=s(93009),ex=s(96789),eh=e=>{let{visible:t,setVisible:s}=e,{ref:a}=(0,v.UO)(),{mutate:r,isLoading:i}=ec({onSuccess:(e,t)=>{p.Am.success("Sent invite email to ".concat(t.email)),s(!1)}}),l=(0,K.Xo)(W.KA.AUTH_EXECUTE,"invite_user"),o=async e=>{if(!a)return console.error("Project ref is required");r({projectRef:a,email:e.email})};return(0,n.jsx)(eu.Z,{hideFooter:!0,size:"small",visible:t,header:"Invite a new user",onCancel:()=>s(!t),"data-sentry-element":"Modal","data-sentry-component":"InviteUserModal","data-sentry-source-file":"InviteUserModal.tsx",children:(0,n.jsx)(em.Z,{validateOnBlur:!1,initialValues:{email:""},validate:e=>{let t={};return 0===e.email.length?t.email="Please enter a valid email":/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e.email)||(t.email="".concat(e.email," is an invalid email")),t},onSubmit:o,"data-sentry-element":"Form","data-sentry-source-file":"InviteUserModal.tsx",children:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eu.Z.Content,{children:(0,n.jsx)(ex.Z,{id:"email",className:"w-full",label:"User email",icon:(0,n.jsx)(X.Z,{}),type:"email",name:"email",placeholder:"User email"})}),(0,n.jsx)(eu.Z.Content,{children:(0,n.jsx)(P.z,{block:!0,size:"small",htmlType:"submit",loading:i,disabled:!l||i,children:"Invite user"})})]})})},"invite-user-modal")},ef=()=>{let e=(0,K.Xo)(W.KA.AUTH_EXECUTE,"invite_user"),t=(0,K.Xo)(W.KA.AUTH_EXECUTE,"create_user"),[s,r]=(0,a.useState)(!1),[i,l]=(0,a.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(E.h_,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"AddUserDropdown.tsx",children:[(0,n.jsx)(E.$F,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"AddUserDropdown.tsx",children:(0,n.jsx)(P.z,{type:"primary",iconRight:(0,n.jsx)(H.Z,{size:14,strokeWidth:1.5}),"data-sentry-element":"Button","data-sentry-source-file":"AddUserDropdown.tsx",children:"Add user"})}),(0,n.jsxs)(E.AW,{side:"bottom",align:"end",className:"w-40","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"AddUserDropdown.tsx",children:[(0,n.jsxs)(G.u,{"data-sentry-element":"Tooltip_Shadcn_","data-sentry-source-file":"AddUserDropdown.tsx",children:[(0,n.jsx)(G.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger_Shadcn_","data-sentry-source-file":"AddUserDropdown.tsx",children:(0,n.jsxs)(E.Xi,{className:"space-x-2 !pointer-events-auto",disabled:!e,onClick:()=>{e&&r(!0)},"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"AddUserDropdown.tsx",children:[(0,n.jsx)(X.Z,{size:14,"data-sentry-element":"Mail","data-sentry-source-file":"AddUserDropdown.tsx"}),(0,n.jsx)("p",{children:"Send invitation"})]})}),!e&&(0,n.jsx)(G._v,{side:"left",children:"You need additional permissions to invite users"})]}),(0,n.jsxs)(G.u,{"data-sentry-element":"Tooltip_Shadcn_","data-sentry-source-file":"AddUserDropdown.tsx",children:[(0,n.jsx)(G.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger_Shadcn_","data-sentry-source-file":"AddUserDropdown.tsx",children:(0,n.jsxs)(E.Xi,{className:"space-x-2 !pointer-events-auto",disabled:!t,onClick:()=>{t&&l(!0)},"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"AddUserDropdown.tsx",children:[(0,n.jsx)(q.Z,{size:14,"data-sentry-element":"UserPlus","data-sentry-source-file":"AddUserDropdown.tsx"}),(0,n.jsx)("p",{children:"Create new user"})]})}),!t&&(0,n.jsx)(G._v,{side:"left",children:"You need additional permissions to create users"})]})]})]}),(0,n.jsx)(eh,{visible:s,setVisible:r,"data-sentry-element":"InviteUserModal","data-sentry-source-file":"AddUserDropdown.tsx"}),(0,n.jsx)(eo,{visible:i,setVisible:l,"data-sentry-element":"CreateUserModal","data-sentry-source-file":"AddUserDropdown.tsx"})]})},ep=s(37506),ev=s(1026);let ey=ev.Wm.map(e=>({name:e.title,value:"Slack (OIDC)"===e.title?"slack_oidc":"LinkedIn (OIDC)"===e.title?"linkedin_oidc":e.title.toLowerCase(),icon:"".concat(L.GW,"/img/icons/").concat(e.misc.iconKey,".svg"),iconClass:"GitHub"===e.title?"dark:invert":""})).concat(ev.Px.properties.SMS_PROVIDER.enum.map(e=>({name:e.label,value:e.value,icon:"".concat(L.GW,"/img/icons/").concat(e.icon),iconClass:""})));var eg=s(62365),ej=s(97881);let eb=[{id:"img",name:"",minWidth:95,width:95,resizable:!1},{id:"id",name:"UID",width:280},{id:"name",name:"Display name",minWidth:0,width:150},{id:"email",name:"Email",width:300},{id:"phone",name:"Phone"},{id:"providers",name:"Providers",minWidth:150},{id:"provider_type",name:"Provider type",minWidth:150},{id:"created_at",name:"Created at",width:260},{id:"last_sign_in_at",name:"Last sign in at",width:260}],ew=()=>{var e,t;let s=(0,r.NL)(),{ref:S}=(0,v.UO)(),{project:U}=(0,g.d2)(),k=(0,a.useRef)(null),A=(0,y.cg)(),[W,H]=(0,a.useState)([]),[X,q]=(0,a.useState)(""),[K,G]=(0,a.useState)("all"),[V,Y]=(0,a.useState)(""),[Q,J]=(0,a.useState)(new Set([])),[$,ee]=(0,a.useState)([]),[et,es]=(0,a.useState)([]),[en,ea]=(0,a.useState)(),[er,ei]=(0,a.useState)("created_at:desc"),[el,eo]=(0,a.useState)(!1),[ed,ec]=(0,a.useState)(!1),[eu,em,{isSuccess:ex,isError:eh,error:ev}]=(0,z.l)(L.dA.AUTH_USERS_COLUMNS_CONFIGURATION(null!=S?S:""),null),[ew,e_]=er.split(":"),{data:eN,error:eC,isSuccess:eS,isLoading:eU,isRefetching:ek,isError:eA,isFetchingNextPage:eD,refetch:eT,fetchNextPage:ez}=(0,T.x7)({projectRef:S,connectionString:null==U?void 0:U.connectionString,keywords:V,filter:"all"===K?void 0:K,providers:et,sort:ew,order:e_},{keepPreviousData:!!V}),{data:eL}=D({projectRef:S,connectionString:null==U?void 0:U.connectionString,keywords:V,filter:"all"===K?void 0:K,providers:et}),{mutateAsync:eP}=(0,C.T)(),eO=(0,a.useMemo)(()=>{var e;return null!==(e=null==eN?void 0:eN.pages.flatMap(e=>e.result))&&void 0!==e?e:[]},[null==eN?void 0:eN.pages]),eZ=eO.find(e=>e.id===[...Q][0]),eE=()=>{q(""),Y("")},eI=(e,t,s)=>{let n=e.slice(),[a]=n.splice(t,1);return n.splice(s,0,a),n},eM=(0,i.Z)((e,t)=>{"toggle"===e?em(t.columns.map(e=>({id:e.key,width:e.width}))):"resize"===e?em(W.map((e,s)=>({id:e.key,width:s===t.idx?t.width:e.width}))):"reorder"===e&&em(t.columns.map(e=>({id:e.key,width:e.width})))},500),eF=async()=>{if(!S)return console.error("Project ref is required");let e=[...Q];ec(!0);try{await Promise.all(e.map(e=>eP({projectRef:S,userId:e,skipInvalidation:!0}))),await Promise.all([s.invalidateQueries(N.o.usersInfinite(S)),s.invalidateQueries(N.o.usersCount(S))]),p.Am.success("Successfully deleted the selected ".concat(Q.size," user").concat(Q.size>1?"s":"")),eo(!1),J(new Set([])),e.includes(en)&&ea(void 0)}catch(e){p.Am.error("Failed to delete selected users: ".concat(e.message)),ec(!1)}};return(0,a.useEffect)(()=>{if(!ek&&(ex||eh&&ev.message.includes("data is undefined"))){let e=(0,eg.Rs)({config:null!=eu?eu:[],users:null!=eO?eO:[],visibleColumns:$,setSortByValue:ei});H(e),e.length<eb.length&&ee(e.filter(e=>"img"!==e.key).map(e=>e.key))}},[eS,ek,ex,eh,ev,eO,Q]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"h-full flex flex-col",children:[(0,n.jsx)(_.p,{className:"py-4 px-6 !mb-0",title:"Users","data-sentry-element":"FormHeader","data-sentry-source-file":"UsersV2.tsx"}),(0,n.jsx)("div",{className:"bg-surface-200 py-3 px-6 flex items-center justify-between border-t",children:Q.size>0?(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsxs)(P.z,{type:"default",icon:(0,n.jsx)(l.Z,{}),onClick:()=>eo(!0),children:["Delete ",Q.size," users"]}),(0,n.jsx)(ej.u,{type:"default",icon:(0,n.jsx)(o.Z,{}),className:"px-1.5",onClick:()=>J(new Set([])),tooltip:{content:{side:"bottom",text:"Cancel selection"}}})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(F.I,{size:"tiny",className:"w-52 pl-7 bg-transparent",iconContainerClassName:"pl-2",icon:(0,n.jsx)(d.Z,{size:14,className:"text-foreground-lighter"}),placeholder:"Search email, phone or UID",value:X,onChange:e=>q(e.target.value),onKeyDown:e=>{"Enter"===e.code&&(q(X.trim()),Y(X.trim().toLocaleLowerCase()))},actions:[X&&(0,n.jsx)(P.z,{size:"tiny",type:"text",icon:(0,n.jsx)(o.Z,{}),onClick:()=>eE(),className:"p-0 h-5 w-5"})]}),(0,n.jsxs)(O.Ph,{value:K,onValueChange:e=>G(e),children:[(0,n.jsx)(O.i4,{size:"tiny",className:(0,Z.cn)("w-[140px] !bg-transparent","all"===K&&"border-dashed"),children:(0,n.jsx)(O.ki,{})}),(0,n.jsx)(O.Bw,{children:(0,n.jsxs)(O.DI,{children:[(0,n.jsx)(O.Ql,{value:"all",className:"text-xs",children:"All users"}),(0,n.jsx)(O.Ql,{value:"verified",className:"text-xs",children:"Verified users"}),(0,n.jsx)(O.Ql,{value:"unverified",className:"text-xs",children:"Unverified users"}),(0,n.jsx)(O.Ql,{value:"anonymous",className:"text-xs",children:"Anonymous users"})]})})]}),(0,n.jsx)(w.E,{name:"Provider",options:ey,labelKey:"name",valueKey:"value",iconKey:"icon",activeOptions:et,labelClass:"text-xs",maxHeightClass:"h-[190px]",onSaveFilters:es}),(0,n.jsx)("div",{className:"border-r border-strong h-6"}),(0,n.jsx)(w.E,{name:0===$.length?"All columns":"Columns",title:"Select columns to show",buttonType:0===$.length?"dashed":"default",options:eb.slice(1),labelKey:"name",valueKey:"id",labelClass:"text-xs",maxHeightClass:"h-[190px]",clearButtonText:"Reset",activeOptions:$,onSaveFilters:e=>{let t=(null!=eu?eu:[]).slice();0===e.length?t=eb.map(e=>({id:e.id,width:e.width})):e.forEach(e=>{var s;t.find(t=>t.id===e)||t.push({id:e,width:null===(s=eb.find(t=>t.id===e))||void 0===s?void 0:s.width})});let s=(0,eg.Rs)({config:t,users:null!=eO?eO:[],visibleColumns:e,setSortByValue:ei});ee(e),H(s),eM("toggle",{columns:s})}}),(0,n.jsxs)(E.h_,{children:[(0,n.jsx)(E.$F,{asChild:!0,children:(0,n.jsxs)(P.z,{icon:"desc"===e_?(0,n.jsx)(c.Z,{}):(0,n.jsx)(u.Z,{}),children:["Sorted by ",ew.replaceAll("_"," ")]})}),(0,n.jsx)(E.AW,{className:"w-44",align:"start",children:(0,n.jsxs)(E._x,{value:er,onValueChange:ei,children:[(0,n.jsxs)(E.Ph,{children:[(0,n.jsx)(E.kt,{children:"Sort by created at"}),(0,n.jsxs)(E.TG,{children:[(0,n.jsx)(E.qB,{value:"created_at:asc",children:"Ascending"}),(0,n.jsx)(E.qB,{value:"created_at:desc",children:"Descending"})]})]}),(0,n.jsxs)(E.Ph,{children:[(0,n.jsx)(E.kt,{children:"Sort by last sign in at"}),(0,n.jsxs)(E.TG,{children:[(0,n.jsx)(E.qB,{value:"last_sign_in_at:asc",children:"Ascending"}),(0,n.jsx)(E.qB,{value:"last_sign_in_at:desc",children:"Descending"})]})]}),(0,n.jsxs)(E.Ph,{children:[(0,n.jsx)(E.kt,{children:"Sort by email"}),(0,n.jsxs)(E.TG,{children:[(0,n.jsx)(E.qB,{value:"email:asc",children:"Ascending"}),(0,n.jsx)(E.qB,{value:"email:desc",children:"Descending"})]})]}),(0,n.jsxs)(E.Ph,{children:[(0,n.jsx)(E.kt,{children:"Sort by phone"}),(0,n.jsxs)(E.TG,{children:[(0,n.jsx)(E.qB,{value:"phone:asc",children:"Ascending"}),(0,n.jsx)(E.qB,{value:"phone:desc",children:"Descending"})]})]})]})})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[A&&(0,n.jsx)(b.Z,{section:["user-management"]}),(0,n.jsx)(P.z,{size:"tiny",icon:(0,n.jsx)(m.Z,{}),type:"default",loading:ek&&!eD,onClick:()=>eT(),children:"Refresh"}),(0,n.jsx)(ef,{})]})]})}),(0,n.jsx)(I.O,{loading:eU||ek||eD,"data-sentry-element":"LoadingLine","data-sentry-source-file":"UsersV2.tsx"}),(0,n.jsxs)(M.pO,{direction:"horizontal",className:"relative flex flex-grow bg-alternative min-h-0",autoSaveId:"query-performance-layout-v1","data-sentry-element":"ResizablePanelGroup","data-sentry-source-file":"UsersV2.tsx",children:[(0,n.jsx)(M.ee,{defaultSize:1,"data-sentry-element":"ResizablePanel","data-sentry-source-file":"UsersV2.tsx",children:(0,n.jsx)("div",{className:"flex flex-col w-full h-full",children:(0,n.jsx)(f.ZP,{ref:k,className:"flex-grow border-t-0",rowHeight:44,headerRowHeight:36,columns:W,rows:(0,eg.Bi)(null!=eO?eO:[]),rowClass:e=>{let t=e.id===en;return["".concat(t?"bg-surface-300 dark:bg-surface-300":"bg-200"," cursor-pointer"),"[&>.rdg-cell]:border-box [&>.rdg-cell]:outline-none [&>.rdg-cell]:shadow-none","[&>.rdg-cell:first-child>div]:ml-4"].join(" ")},rowKeyGetter:e=>e.id,selectedRows:Q,onScroll:e=>{!eU&&(0,eg.KG)(e)&&ez()},onSelectedRowsChange:e=>{e.size>20?(0,p.Am)("Only up to ".concat(20," users can be selected at a time")):J(e)},onColumnResize:(e,t)=>eM("resize",{idx:e,width:t}),onColumnsReorder:(e,t)=>{let s=W.findIndex(t=>t.key===e),n=W.findIndex(e=>e.key===t),a=eI(W,s,n);H(a),eM("reorder",{columns:a})},renderers:{renderRow:(e,t)=>(0,a.createElement)(f.X2,{...t,key:t.row.id,onClick:()=>{var s,n;let a=eO.indexOf(null!==(s=eO.find(t=>t.id===e))&&void 0!==s?s:{});t.row.id&&(ea(t.row.id),null===(n=k.current)||void 0===n||n.scrollToCell({idx:0,rowIdx:a}))}}),noRowsFallback:eU?(0,n.jsx)("div",{className:"absolute top-14 px-6 w-full",children:(0,n.jsx)(R.A,{})}):eA?(0,n.jsx)("div",{className:"absolute top-14 px-6 flex flex-col items-center justify-center w-full",children:(0,n.jsx)(j.Z,{subject:"Failed to retrieve users",error:eC})}):(0,n.jsxs)("div",{className:"absolute top-20 px-6 flex flex-col items-center justify-center w-full gap-y-2",children:[(0,n.jsx)(x.Z,{className:"text-foreground-lighter",strokeWidth:1}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-foreground",children:"all"!==K||V.length>0?"No users found":"No users in your project"}),(0,n.jsx)("p",{className:"text-foreground-light",children:"all"!==K||V.length>0?"There are currently no users based on the filters applied":"There are currently no users who signed up to your project"})]})]})},"data-sentry-element":"DataGrid","data-sentry-source-file":"UsersV2.tsx"})})}),void 0!==en&&(0,n.jsx)(ep.i,{selectedUser:eO.find(e=>e.id===en),onClose:()=>ea(void 0)})]}),(0,n.jsxs)("div",{className:"flex justify-between min-h-9 h-9 overflow-hidden items-center px-6 w-full border-t text-xs text-foreground-light",children:[eU||ek?"Loading users...":"Total: ".concat(null!=eL?eL:0," users"),(eU||ek||eD)&&(0,n.jsxs)("span",{className:"flex items-center gap-2",children:[(0,n.jsx)(h.Z,{size:14,className:"animate-spin"})," Loading..."]})]})]}),(0,n.jsx)(B.Z,{visible:el,variant:"destructive",title:"Confirm to delete ".concat(Q.size," user").concat(Q.size>1?"s":""),loading:ed,confirmLabel:"Delete",onCancel:()=>eo(!1),onConfirm:()=>eF(),alert:{title:"Deleting ".concat(1===Q.size?"a user":"users"," is irreversible"),description:"This will remove the selected ".concat(1===Q.size?"":"".concat(Q.size," "),"user").concat(Q.size>1?"s":""," from the project and all associated data.")},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UsersV2.tsx",children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to delete the"," ",1===Q.size?"":"selected ".concat(Q.size," "),"user",Q.size>1?"s":"",1===Q.size?(0,n.jsxs)("span",{className:"text-foreground",children:[" ",null!==(t=null!==(e=null==eZ?void 0:eZ.email)&&void 0!==e?e:null==eZ?void 0:eZ.phone)&&void 0!==t?t:"this user"]}):null,"?"]})})]})}},13430:function(e,t,s){var n=s(97458),a=s(5007),r=s(70559),i=s(19168);t.Z=e=>{let{section:t}=e,s=(0,r.WZ)();return(0,n.jsx)(i.z,{size:"tiny",type:"default",onClick:()=>{t&&s.setActiveDocsSection(t),s.setShowProjectApiDocs(!0)},icon:(0,n.jsx)(a.Z,{strokeWidth:1.5,className:"text-foreground-muted"}),"data-sentry-element":"Button","data-sentry-component":"APIDocsButton","data-sentry-source-file":"APIDocsButton.tsx",children:"API Docs"})}},97705:function(e,t,s){s.d(t,{E:function(){return u}});var n=s(97458),a=s(52983),r=s(41341),i=s(19168),l=s(89861),o=s(65497),d=s(27037),c=s(5546);let u=e=>{let{title:t,options:s=[],activeOptions:u=[],valueKey:m,labelKey:x,iconKey:h="icon",name:f="default",variant:p="rectangular",buttonType:v,disabled:y,labelClass:g,maxHeightClass:j="h-[205px]",clearButtonText:b="Clear",onSaveFilters:w}=e,[_,N]=(0,a.useState)(!1),[C,S]=(0,a.useState)([]),U=u.map(e=>{let t=s.find(t=>t[m]===e);return t&&t[x]?t[x]:""});return(0,a.useEffect)(()=>{!_&&u.length>0&&S(u)},[_,u]),(0,n.jsxs)(r.J2,{open:_,onOpenChange:N,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"FilterPopover","data-sentry-source-file":"FilterPopover.tsx",children:[(0,n.jsx)(r.xo,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:(0,n.jsx)(i.z,{asChild:!0,disabled:y,type:null!=v?v:u.length>0?"default":"dashed",onClick:()=>N(!1),className:"rounded"===p?"rounded-full":"","data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:f}),u.length>0&&(0,n.jsx)("span",{className:"mr-1",children:":"}),u.length>=3?(0,n.jsxs)("span",{children:[U[0]," and ",u.length-1," others"]}):u.length>0?(0,n.jsx)("span",{children:U.join(", ")}):null]})})}),(0,n.jsxs)(r.yk,{className:"p-0 w-44",align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:[(0,n.jsx)("div",{className:"border-b border-overlay bg-surface-200 rounded-t pb-1 px-3",children:(0,n.jsx)("span",{className:"text-xs text-foreground-light",children:null!=t?t:"Select ".concat(f.toLowerCase())})}),(0,n.jsx)(l.x,{className:s.length>7?j:"","data-sentry-element":"ScrollArea","data-sentry-source-file":"FilterPopover.tsx",children:(0,n.jsx)("div",{className:"p-3 flex flex-col gap-y-2",children:s.map(e=>{let t=e[m],s=h?e[h]:void 0;return(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(o.X,{id:t,checked:C.includes(t),onCheckedChange:()=>{C.includes(t)?S(C.filter(e=>e!==t)):S(C.concat(t))}}),(0,n.jsxs)(d._,{htmlFor:e[m],className:(0,c.cn)("flex items-center gap-x-2",g),children:[s&&(0,n.jsx)("img",{src:s,alt:e[x],className:(0,c.cn)("w-4 h-4",e.iconClass)}),(0,n.jsx)("span",{children:e[x]})]})]},t)})})}),(0,n.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-overlay bg-surface-200 py-2 px-3",children:[(0,n.jsx)(i.z,{size:"tiny",type:"default",onClick:()=>{w([]),S([]),N(!1)},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:b}),(0,n.jsx)(i.z,{type:"primary",onClick:()=>{let e=s.map(e=>e[m]);w(C.sort((t,s)=>e.indexOf(t)-e.indexOf(s))),N(!1)},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:"Save"})]})]})]})}},5423:function(e,t,s){s.d(t,{O:function(){return r}});var n=s(97458),a=s(5546);let r=e=>{let{loading:t}=e;return(0,n.jsx)("div",{className:"relative overflow-hidden w-full h-px bg-border m-auto","data-sentry-component":"LoadingLine","data-sentry-source-file":"LoadingLine.tsx",children:(0,n.jsx)("span",{className:(0,a.cn)("absolute w-[80px] h-px ml-auto mr-auto left-0 right-0 text-center block top-0","transition-all","line-loading-bg-light dark:line-loading-bg",t&&"animate-line-loading-slower opacity-100",t?"opacity-100":"opacity-0")})})}}}]);