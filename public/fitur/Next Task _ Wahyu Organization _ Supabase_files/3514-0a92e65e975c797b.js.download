!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3d614d86-c19d-4685-a981-302693efb941",e._sentryDebugIdIdentifier="sentry-dbid-3d614d86-c19d-4685-a981-302693efb941")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3514],{69457:function(e,t,a){a.d(t,{Z:function(){return i}});let i=(0,a(67634).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},73514:function(e,t,a){a.d(t,{Z:function(){return eu}});var i=a(97458),l=a(45925),s=a(52983),n=a(34549),r=a(58035),o=a(51735),c=a(23385),d=a(77946),u=a(97667),m=a(85394),p=a(198),h=a(18656),x=a(68056),f=a(37669),y=a.n(f),b=a(53995),j=a(23382),v=a(63204),g=a(45373),_=a(70590),k=a(75138),w=a(36457),N=a(64618),S=a(55410),C=a(17311);async function z(e){let{projectRef:t,id:a,isPublic:i,file_size_limit:l,allowed_mime_types:s}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let n=await (0,S.v_)("".concat(d.T5,"/storage/").concat(t,"/buckets"),{id:a,public:i,file_size_limit:l,allowed_mime_types:s});if(n.error)throw n.error;return n}let Z=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,w.NL)();return(0,N.D)(e=>z(e),{async onSuccess(t,a,l){let{projectRef:s}=a;await i.invalidateQueries(C.m.buckets(s)),await (null==e?void 0:e(t,a,l))},async onError(e,a,i){void 0===t?n.Am.error("Failed to create bucket: ".concat(e.message)):t(e,a,i)},...a})};var M=a(2054),E=a(93009),B=a(96789),T=a(25084),I=a(41888),P=a(48653),R=a(5546),F=a(83571),A=a(19168),O=e=>{var t;let{visible:a,onClose:r}=e,{ref:o}=(0,l.UO)(),c=(0,b.useRouter)(),{mutate:u,isLoading:m}=Z({onSuccess:e=>{n.Am.success("Successfully created bucket ".concat(e.name)),c.push("/project/".concat(o,"/storage/buckets/").concat(e.name)),r()}}),{data:p}=(0,k.k)({projectRef:o},{enabled:d.Qy}),{value:h,unit:x}=(0,_.Ku)(null!==(t=null==p?void 0:p.fileSizeLimit)&&void 0!==t?t:0),f="".concat(h," ").concat(x),[j,w]=(0,s.useState)(g.b.BYTES),[N,S]=(0,s.useState)(!1),C=async e=>{if(!o)return console.error("Project ref is required");u({projectRef:o,id:e.name,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,_.Fm)(e.formatted_size_limit,j):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null})};return(0,s.useEffect)(()=>{a&&(w(g.b.BYTES),S(!1))},[a]),(0,i.jsx)(M.Z,{hideFooter:!0,visible:a,size:"medium",header:"Create storage bucket",onCancel:()=>r(),"data-sentry-element":"Modal","data-sentry-component":"CreateBucketModal","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,i.jsx)(E.Z,{validateOnBlur:!1,initialValues:{name:"",public:!1,file_size_limit:0,allowed_mime_types:"",has_file_size_limit:!1,formatted_size_limit:0},validate:e=>{let t={};return e.name||(t.name="Please provide a name for your bucket"),e.name&&e.name.endsWith(" ")&&(t.name="The name of the bucket cannot end with a whitespace"),e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),"public"===e.name&&(t.name='"public" is a reserved name. Please choose another name'),t},onSubmit:C,"data-sentry-element":"Form","data-sentry-source-file":"CreateBucketModal.tsx",children:e=>{let{values:t}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(M.Z.Content,{children:[(0,i.jsx)(B.Z,{id:"name",name:"name",type:"text",className:"w-full",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",descriptionText:"Only lowercase letters, numbers, dots, and hyphens"}),(0,i.jsxs)("div",{className:"space-y-2 mt-6",children:[(0,i.jsx)(T.Z,{id:"public",name:"public",layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"}),t.public&&(0,i.jsxs)(I.b,{title:"Public buckets are not protected",variant:"warning",withIcon:!0,children:[(0,i.jsx)("p",{className:"mb-2",children:"Users can read objects in public buckets without any authorization."}),(0,i.jsx)("p",{children:"Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]})]})]}),(0,i.jsxs)(P.ZP,{open:N,onOpenChange:()=>S(!N),children:[(0,i.jsx)(P.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,i.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,i.jsx)(v.Z,{size:18,strokeWidth:2,className:(0,R.cn)("text-foreground-light",N&&"rotate-180")})]})}),(0,i.jsx)(P.ZP.Content,{className:"py-4",children:(0,i.jsxs)("div",{className:"w-full space-y-5 px-5",children:[(0,i.jsxs)("div",{className:"space-y-5",children:[(0,i.jsx)(T.Z,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,i.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,i.jsx)("div",{className:"col-span-8",children:(0,i.jsx)(B.Z,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,_.Fm)(t.formatted_size_limit,j).toLocaleString()," bytes.")})}),(0,i.jsx)("div",{className:"col-span-4",children:(0,i.jsx)(F.Z,{id:"size_limit_units",disabled:!1,value:j,onChange:w,children:Object.values(g.b).map(e=>(0,i.jsx)(F.Z.Option,{label:e,value:e,children:(0,i.jsx)("div",{children:e})},e))})}),d.Qy&&(0,i.jsx)("div",{className:"col-span-12",children:(0,i.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket uploads will still be capped at the"," ",(0,i.jsx)(y(),{href:"/project/".concat(o,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",f]})})]})]}),(0,i.jsx)(B.Z,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,i.jsx)(M.Z.Separator,{}),(0,i.jsxs)(M.Z.Content,{className:"flex items-center space-x-2 justify-end",children:[(0,i.jsx)(A.z,{type:"default",htmlType:"button",disabled:m,onClick:()=>r(),children:"Cancel"}),(0,i.jsx)(A.z,{type:"primary",htmlType:"submit",loading:m,disabled:m,children:"Save"})]})]})}})})};async function L(e){let{projectRef:t,id:a,isPublic:i,file_size_limit:l,allowed_mime_types:s}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let n=await (0,S.r$)("".concat(d.T5,"/storage/").concat(t,"/buckets/").concat(a),{public:i,file_size_limit:l,allowed_mime_types:s});if(n.error)throw n.error;return n}let D=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,w.NL)();return(0,N.D)(e=>L(e),{async onSuccess(t,a,l){let{projectRef:s}=a;await i.invalidateQueries(C.m.buckets(s)),await (null==e?void 0:e(t,a,l))},async onError(e,a,i){void 0===t?n.Am.error("Failed to update bucket: ".concat(e.message)):t(e,a,i)},...a})};var q=e=>{var t;let{visible:a,bucket:r,onClose:o}=e,{ref:c}=(0,l.UO)(),{mutate:u,isLoading:m}=D({onSuccess:()=>{n.Am.success('Successfully updated bucket "'.concat(null==r?void 0:r.name,'"')),o()}}),{data:p}=(0,k.k)({projectRef:c},{enabled:d.Qy}),{value:h,unit:x}=(0,_.Ku)(null!==(t=null==p?void 0:p.fileSizeLimit)&&void 0!==t?t:0),f="".concat(h," ").concat(x),[b,j]=(0,s.useState)(g.b.BYTES),[w,N]=(0,s.useState)(!1),S=async e=>void 0===r?console.error("Bucket is required"):void 0===c?console.error("Project ref is required"):void u({projectRef:c,id:r.id,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,_.Fm)(e.formatted_size_limit,b):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null});return(0,s.useEffect)(()=>{if(a){var e;let{unit:t}=(0,_.Ku)(null!==(e=null==r?void 0:r.file_size_limit)&&void 0!==e?e:0);j(t),N(!1)}},[a]),(0,i.jsx)(M.Z,{hideFooter:!0,visible:a,size:"medium",header:'Edit bucket "'.concat(null==r?void 0:r.name,'"'),onCancel:o,"data-sentry-element":"Modal","data-sentry-component":"EditBucketModal","data-sentry-source-file":"EditBucketModal.tsx",children:(0,i.jsx)(E.Z,{validateOnBlur:!1,initialValues:{},validate:e=>{let t={};return e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),t},onSubmit:S,"data-sentry-element":"Form","data-sentry-source-file":"EditBucketModal.tsx",children:e=>{let{values:t,resetForm:l}=e;return(0,s.useEffect)(()=>{if(a&&void 0!==r){var e,t,i;let{value:a}=(0,_.Ku)(null!==(e=r.file_size_limit)&&void 0!==e?e:0),s={name:null!==(t=r.name)&&void 0!==t?t:"",public:r.public,file_size_limit:r.file_size_limit,allowed_mime_types:(null!==(i=r.allowed_mime_types)&&void 0!==i?i:[]).join(", "),has_file_size_limit:null!==r.file_size_limit,formatted_size_limit:null!=a?a:0};l({values:s,initialValues:s})}},[a]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(M.Z.Content,{children:[(0,i.jsx)(B.Z,{disabled:!0,id:"name",name:"name",type:"text",className:"w-full",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created."}),(0,i.jsxs)("div",{className:"space-y-2 mt-6",children:[(0,i.jsx)(T.Z,{id:"public",name:"public",layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"}),(null==r?void 0:r.public)!==t.public&&(0,i.jsx)(I.b,{title:(null==r?void 0:r.public)||!t.public?(null==r?void 0:r.public)&&!t.public?"Warning: Making bucket private":"":"Warning: Making bucket public",variant:"warning",withIcon:!0,children:(0,i.jsx)("p",{className:"mb-2",children:(null==r?void 0:r.public)||!t.public?(null==r?void 0:r.public)&&!t.public?'All objects in "'.concat(null==r?void 0:r.name,'" will be made private and will only be accessible via signed URLs or downloaded with the right authorisation headers'):"":'This will make all objects in the bucket "'.concat(null==r?void 0:r.name,'" public')})})]})]}),(0,i.jsxs)(P.ZP,{open:w,onOpenChange:()=>N(!w),children:[(0,i.jsx)(P.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,i.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,i.jsx)(v.Z,{size:18,strokeWidth:2,className:(0,R.cn)("text-foreground-light",w&&"rotate-180")})]})}),(0,i.jsx)(P.ZP.Content,{className:"py-4",children:(0,i.jsxs)("div",{className:"w-full space-y-4 px-5",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(T.Z,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,i.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,i.jsx)("div",{className:"col-span-8",children:(0,i.jsx)(B.Z,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,_.Fm)(t.formatted_size_limit,b).toLocaleString()," bytes.")})}),(0,i.jsx)("div",{className:"col-span-4",children:(0,i.jsx)(F.Z,{id:"size_limit_units",disabled:!1,value:b,onChange:j,children:Object.values(g.b).map(e=>(0,i.jsx)(F.Z.Option,{label:e,value:e,children:(0,i.jsx)("div",{children:e})},e))})}),d.Qy&&(0,i.jsx)("div",{className:"col-span-12 mt-2",children:(0,i.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket upload will still be capped at the"," ",(0,i.jsx)(y(),{href:"/project/".concat(c,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",f]})})]})]}),(0,i.jsx)(B.Z,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,i.jsx)(M.Z.Separator,{}),(0,i.jsxs)(M.Z.Content,{className:"flex items-center space-x-2 justify-end",children:[(0,i.jsx)(A.z,{type:"default",disabled:m,onClick:()=>o(),children:"Cancel"}),(0,i.jsx)(A.z,{type:"primary",htmlType:"submit",loading:m,disabled:m,children:"Save"})]})]})}})})},W=a(53781),K=a(61250);async function U(e){let{projectRef:t,id:a}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let{data:i,error:l}=await (0,K.v_)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{id:a,ref:t}}});return l&&(0,K.S3)(l),i}let V=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,w.NL)();return(0,N.D)(e=>U(e),{async onSuccess(t,a,l){let{projectRef:s}=a;await i.invalidateQueries(C.m.buckets(s)),await (null==e?void 0:e(t,a,l))},async onError(e,a,i){void 0===t?n.Am.error("Failed to empty bucket: ".concat(e.message)):t(e,a,i)},...a})};var Q=a(587);let X=e=>{let{visible:t=!1,bucket:a,onClose:s}=e,{ref:r}=(0,l.UO)(),{fetchFolderContents:o}=(0,u.H)(),{mutate:c,isLoading:d}=V({onSuccess:async()=>{void 0!==a&&(await o(a.id,a.name,-1),n.Am.success("Successfully deleted bucket ".concat(a.name)),s())}}),m=async()=>r?a?void c({projectRef:r,id:a.id}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,i.jsx)(Q.Z,{variant:"destructive",size:"small",title:"Confirm to delete all contents from ".concat(null==a?void 0:a.name),confirmLabel:"Empty bucket",visible:t,onCancel:()=>s(),onConfirm:m,alert:{title:"This action cannot be undone",description:"The contents of your bucket cannot be recovered once deleted"},"data-sentry-element":"ConfirmationModal","data-sentry-component":"EmptyBucketModal","data-sentry-source-file":"EmptyBucketModal.tsx",children:(0,i.jsxs)("p",{className:"text-sm",children:['Are you sure you want to empty the bucket "',null==a?void 0:a.name,'"?']})})};var Y=a(97881),G=a(98261),H=a(65197),$=a(87790),J=a(90537),ee=a(71904),et=a(97834),ea=a(71607),ei=a.n(ea),el=a(21068),es=a(69457),en=a(17471),er=a(28436),eo=a(77518),ec=e=>{let{bucket:t,projectRef:a="",isSelected:l=!1,onSelectEmptyBucket:s=ei(),onSelectDeleteBucket:n=ei(),onSelectEditBucket:r=ei()}=e,o=(0,$.Xo)(p.KA.STORAGE_WRITE,"*");return(0,i.jsxs)("div",{className:(0,R.cn)("group flex items-center justify-between rounded-md",l&&"text-foreground bg-surface-100"),"data-sentry-component":"BucketRow","data-sentry-source-file":"BucketRow.tsx",children:[(0,i.jsx)(y(),{href:"/project/".concat(a,"/storage/buckets/").concat(encodeURIComponent(t.id)),className:(0,R.cn)("py-1 px-3",l?"w-[88%]":"w-full"),"data-sentry-element":"Link","data-sentry-source-file":"BucketRow.tsx",children:(0,i.jsxs)("div",{className:"flex items-center justify-between space-x-2 truncate w-full",children:[(0,i.jsx)("p",{className:"text-sm group-hover:text-foreground transition truncate ".concat(l?"text-foreground":"text-foreground-light"),title:t.name,children:t.name}),t.public&&(0,i.jsx)(er.C,{variant:"warning",children:"Public"})]})}),o&&l?(0,i.jsxs)(eo.h_,{children:[(0,i.jsx)(eo.$F,{asChild:!0,children:(0,i.jsx)(A.z,{type:"text",icon:(0,i.jsx)(v.Z,{}),className:"mr-1 p-0.5"})}),(0,i.jsxs)(eo.AW,{side:"bottom",align:"start",children:[(0,i.jsxs)(eo.Xi,{className:"space-x-2",onClick:()=>r(),children:[(0,i.jsx)(el.Z,{size:14}),(0,i.jsx)("p",{children:"Edit bucket"})]},"toggle-private"),(0,i.jsx)(eo.VD,{}),(0,i.jsxs)(eo.Xi,{className:"space-x-2",onClick:()=>s(),children:[(0,i.jsx)(es.Z,{size:14}),(0,i.jsx)("p",{children:"Empty bucket"})]},"empty-bucket"),(0,i.jsxs)(eo.Xi,{className:"space-x-2",onClick:()=>n(),children:[(0,i.jsx)(en.Z,{size:14}),(0,i.jsx)("p",{children:"Delete bucket"})]},"delete-bucket")]})]}):(0,i.jsx)("div",{className:"w-5"})]},t.id)},ed=()=>{let e=(0,b.useRouter)(),{ref:t,bucketId:a}=(0,l.UO)(),n=(0,o.Vm)(),r=(null==n?void 0:n.parent_project_ref)!==void 0,[c,d]=(0,s.useState)(""),[u,m]=(0,s.useState)(!1),[f,v]=(0,s.useState)(),[g,_]=(0,s.useState)(),[k,w]=(0,s.useState)(),N=(0,$.Xo)(p.KA.STORAGE_WRITE,"*"),[S,C]=(0,j._)("storage-explorer-sort","created-at"),z=e.pathname.split("/")[4],{data:Z,error:M,isLoading:E,isError:B,isSuccess:T}=(0,H.K)({projectRef:t}),I=null!=Z?Z:[],P="alphabetical"===S?I.sort((e,t)=>e.name.toLowerCase().trim().localeCompare(t.name.toLowerCase().trim())):I.sort((e,t)=>new Date(t.created_at)>new Date(e.created_at)?-1:1),R=c.length>1?P.filter(e=>e.name.includes(c.trim())):P,F=(null==M?void 0:M.message.includes("Tenant config"))&&r;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(J.ZP,{type:"pills",className:"my-6 flex flex-grow flex-col","data-sentry-element":"Menu","data-sentry-source-file":"StorageMenu.tsx",children:[(0,i.jsxs)("div",{className:"mb-6 mx-5 flex flex-col gap-y-1.5",children:[(0,i.jsx)(Y.u,{block:!0,type:"default",icon:(0,i.jsx)(h.Z,{}),disabled:!N,style:{justifyContent:"start"},onClick:()=>m(!0),tooltip:{content:{side:"bottom",text:N?void 0:"You need additional permissions to create buckets"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"StorageMenu.tsx",children:"New bucket"}),(0,i.jsx)(et.nM,{className:"px-0","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"StorageMenu.tsx",children:(0,i.jsx)(et.nn,{name:"search-buckets","aria-labelledby":"Search buckets",placeholder:"Search buckets...",value:c,onChange:e=>{d(e.target.value)},"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"StorageMenu.tsx",children:(0,i.jsxs)(et.ZY,{value:S,onValueChange:e=>C(e),"data-sentry-element":"InnerSideBarFilterSortDropdown","data-sentry-source-file":"StorageMenu.tsx",children:[(0,i.jsx)(et.IR,{value:"alphabetical",className:"flex gap-2","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Alphabetical"},"alphabetical"),(0,i.jsx)(et.IR,{value:"created-at","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Created at"},"created-at")]})})})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"mx-3",children:[(0,i.jsx)(J.ZP.Group,{title:(0,i.jsx)("span",{className:"uppercase font-mono",children:"All buckets"}),"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx"}),E&&(0,i.jsxs)("div",{className:"space-y-2 mx-2",children:[(0,i.jsx)(G.Z,{className:"!py-2.5"}),(0,i.jsx)(G.Z,{className:"!py-2.5"}),(0,i.jsx)(G.Z,{className:"!py-2.5"})]}),B&&(0,i.jsx)("div",{className:"px-2",children:(0,i.jsxs)(ee.bZ,{variant:F?"default":"warning",children:[(0,i.jsx)(ee.Cd,{className:"text-xs tracking-normal",children:F?"Storage is not available on preview branches for now":"Failed to fetch buckets"}),(0,i.jsx)(ee.X,{className:"text-xs",children:F?"We're actively looking into making this available on preview branches":"Please refresh to try again"})]})}),T&&(0,i.jsxs)(i.Fragment,{children:[0===I.length&&(0,i.jsx)(et.Cf,{className:"mx-2",title:"No buckets available",description:"Buckets that you create will appear here"}),c.length>0&&0===R.length&&(0,i.jsx)(et.Cf,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(c,'" did not return any results')}),R.map((e,l)=>{let s=a===e.id;return(0,i.jsx)(ec,{bucket:e,projectRef:t,isSelected:s,onSelectEmptyBucket:()=>_(e),onSelectDeleteBucket:()=>w(e),onSelectEditBucket:()=>v(e)},"".concat(l,"_").concat(e.id))})]})]}),(0,i.jsx)("div",{className:"h-px w-full bg-border"}),(0,i.jsxs)("div",{className:"mx-3",children:[(0,i.jsx)(J.ZP.Group,{title:(0,i.jsx)("span",{className:"uppercase font-mono",children:"Configuration"}),"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx"}),(0,i.jsx)(y(),{href:"/project/".concat(t,"/storage/policies"),legacyBehavior:!0,"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,i.jsx)(J.ZP.Item,{rounded:!0,active:"policies"===z,"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx",children:(0,i.jsx)("p",{className:"truncate",children:"Policies"})})}),(0,i.jsx)(y(),{href:"/project/".concat(t,"/settings/storage"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,i.jsx)(J.ZP.Item,{rounded:!0,"data-sentry-element":"unknown","data-sentry-source-file":"StorageMenu.tsx",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"truncate",children:"Settings"}),(0,i.jsx)(x.Z,{strokeWidth:1,className:"h-4 w-4","data-sentry-element":"ArrowUpRight","data-sentry-source-file":"StorageMenu.tsx"})]})})})]})]})]}),(0,i.jsx)(O,{visible:u,onClose:()=>m(!1),"data-sentry-element":"CreateBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,i.jsx)(q,{visible:void 0!==f,bucket:f,onClose:()=>v(void 0),"data-sentry-element":"EditBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,i.jsx)(X,{visible:void 0!==g,bucket:g,onClose:()=>_(void 0),"data-sentry-element":"EmptyBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,i.jsx)(W.Iw,{visible:void 0!==k,bucket:k,onClose:()=>w(void 0),"data-sentry-element":"DeleteBucketModal","data-sentry-source-file":"StorageMenu.tsx"})]})},eu=(0,c.Q)(e=>{var t;let{title:a,children:c}=e,{ref:p}=(0,l.UO)(),h=(0,o.Vm)(),x=(0,u.H)(),{data:f,isLoading:y}=(0,r.zR)({projectRef:p}),b=null==f?void 0:null===(t=f.app_config)||void 0===t?void 0:t.endpoint,{serviceKey:j}=(0,r.Pb)(f),v=(null==h?void 0:h.status)===d.S.INACTIVE;(0,s.useEffect)(()=>{!y&&b&&(null==j?void 0:j.api_key)&&g(b,j.api_key)},[y,p,b,null==j?void 0:j.api_key]);let g=async(e,t)=>{if(!v){if(e){var a,i;let l=null!==(i=null==f?void 0:null===(a=f.app_config)||void 0===a?void 0:a.protocol)&&void 0!==i?i:"https";x.initStore(p,e,t,l)}else n.Am.error("Failed to fetch project configuration. Try refreshing your browser, or reach out to us at support@supabase.io")}};return(0,i.jsx)(m.Z,{title:a||"Storage",product:"Storage",productMenu:(0,i.jsx)(ed,{}),"data-sentry-element":"ProjectLayout","data-sentry-component":"StorageLayout","data-sentry-source-file":"StorageLayout.tsx",children:c})})},48653:function(e,t,a){var i=a(97458),l=a(99517);a(52983);var s=a(82188);let n=e=>{let{open:t,children:a,className:s,...n}=e;return(0,i.jsx)(l.fC,{asChild:n.asChild,defaultOpen:n.defaultOpen,open:t,onOpenChange:n.onOpenChange,disabled:n.disabled,className:s,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:a})};n.Trigger=function(e){let{children:t,asChild:a}=e;return(0,i.jsx)(l.xz,{asChild:a,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},n.Content=function(e){let{asChild:t,children:a,className:n}=e,r=(0,s.Z)("collapsible");return(0,i.jsx)(l.VY,{asChild:t,className:[r.content,n].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:a})},t.ZP=n}}]);