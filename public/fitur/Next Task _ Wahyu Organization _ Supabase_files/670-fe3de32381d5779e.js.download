!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="30f6e42e-836b-4141-a95d-bf7cbc79fcb5",e._sentryDebugIdIdentifier="sentry-dbid-30f6e42e-836b-4141-a95d-bf7cbc79fcb5")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[670],{10670:function(e,t,a){a.d(t,{yV:function(){return nT},IV:function(){return tJ},d2:function(){return s5},q$:function(){return t7},iB:function(){return au},ny:function(){return aC},G3:function(){return aD},ZI:function(){return n7},cN:function(){return sQ},l1:function(){return nc}});var n,s,r=a(97458),i=a(45925),l=a(7004),o=a(55604),d=a(64071),c=a(198),u=a(52983),m=a(34549),p=a(61223),h=a(50060),x=a(49154),g=a(93252),y=a(33778),f=a(6166),v=a(98261),j=a(28894),b=a(61250),S=a(87790),N=a(31053);async function w(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let{data:n,error:s}=await (0,b.U2)("/platform/organizations/{slug}/customer",{params:{path:{slug:a}},signal:t});return s&&(0,b.S3)(s),n}let _=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,S.Xo)(c.KA.BILLING_READ,"stripe.customer");return(0,j.a)(N.O.customerProfile(t),e=>{let{signal:a}=e;return w({slug:t},a)},{enabled:a&&s&&void 0!==t,...n})};var C=a(36457),A=a(64618);async function I(e){let{slug:t,address:a}=e;if(!t)return console.error("Slug is required");let{data:n,error:s}=await (0,b.gz)("/platform/organizations/{slug}/customer",{params:{path:{slug:t}},body:{address:a}});if(s)throw(0,b.S3)(s);return n}let T=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>I(e),{async onSuccess(t,a,s){let{address:r,slug:i}=a;n.setQueriesData(N.O.customerProfile(i),e=>e?{...e,address:r}:e),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to update customer profile: ".concat(e.message)):t(e,a,n)},...a})};var k=a(80398),E=a(93009),M=a(96789),P=a(83571);let R=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Cura\xe7ao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"CI",name:"C\xf4te d'Ivoire"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard & McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"RE",name:"R\xe9union"},{code:"BL",name:"Saint Barth\xe9lemy"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SH",name:"St Helena"},{code:"KN",name:"St Kitts and Nevis"},{code:"LC",name:"St Lucia"},{code:"MF",name:"St Martin"},{code:"PM",name:"St Pierre and Miquelon"},{code:"VC",name:"St Vincent and the Grenadines"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard & Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad & Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks & Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"VI",name:"US Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States of America"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WF",name:"Wallis & Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"},{code:"AX",name:"\xc5land Islands"}];var z=()=>{var e;let{slug:t}=(0,i.UO)(),a=(0,k.l)(),n=(0,S.Xo)(c.KA.BILLING_READ,"stripe.customer"),s=(0,S.Xo)(c.KA.BILLING_WRITE,"stripe.customer"),{data:o,error:d,isLoading:j,isSuccess:b,isError:N}=_({slug:t},{enabled:n}),{mutate:w,isLoading:C}=T(),A="billing-address-form",{city:I,country:z,line1:Z,line2:D,postal_code:O,state:L}=null!==(e=null==o?void 0:o.address)&&void 0!==e?e:{},U=async(e,a)=>{let{resetForm:n}=a;if(!t)return console.error("Slug is required");w({slug:t,address:e.line1?e:null},{onSuccess:()=>{m.Am.success("Successfully updated billing address"),n({values:e,initialValues:e})}})};return(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"BillingAddress","data-sentry-source-file":"BillingAddress.tsx",children:[(0,r.jsx)(l.g$,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"BillingAddress.tsx",children:(0,r.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,r.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Address"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"This will be reflected in every upcoming invoice, past invoices are not affected"})]})}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"BillingAddress.tsx",children:(null==a?void 0:a.managed_by)!==void 0&&(null==a?void 0:a.managed_by)!=="supabase"?(0,r.jsx)(f.Z,{partner:null==a?void 0:a.managed_by,resource:"Billing Addresses",cta:{installationId:null==a?void 0:a.partner_id}}):n?(0,r.jsxs)(r.Fragment,{children:[j&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),N&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve organization customer profile",error:d}),b&&(0,r.jsx)(E.Z,{validateOnBlur:!0,id:A,initialValues:{city:I,country:z,line1:Z,line2:D,postal_code:O,state:L},validate:e=>{let t={};return(e.line1||e.line2||e.postal_code||e.state||e.city)&&!e.country&&(t.country="Please select a country"),(e.country||e.line2||e.postal_code||e.state||e.city)&&!e.line1&&(t.line1="Please provide an address line"),t},onSubmit:U,children:e=>{let{values:t,initialValues:a,handleReset:n,resetForm:i}=e,l=JSON.stringify(t)!==JSON.stringify(a);return(0,u.useEffect)(()=>{if(b&&void 0!==o){var e;let{city:t,country:a,line1:n,line2:s,postal_code:r,state:l}=null!==(e=null==o?void 0:o.address)&&void 0!==e?e:{},d={city:t,country:a,line1:n,line2:s,postal_code:r,state:l};i({values:d,initialValues:d})}},[b]),(0,r.jsx)(x.by,{footer:(0,r.jsx)("div",{className:"flex py-4 px-8",children:(0,r.jsx)(h.i,{form:A,isSubmitting:C,hasChanges:l,handleReset:n,helper:s?void 0:"You need additional permissions to manage this organization's billing address"})}),children:(0,r.jsx)(g.hj,{children:(0,r.jsxs)(g.B4,{fullWidth:!0,loading:!1,className:"!gap-2",children:[(0,r.jsx)(M.Z,{id:"line1",name:"line1",placeholder:"Address line 1",disabled:!s}),(0,r.jsx)(M.Z,{id:"line2",name:"line2",placeholder:"Address line 2",disabled:!s}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)(P.Z,{className:"w-full",id:"country",name:"country",placeholder:"Country",disabled:!s,children:[(0,r.jsx)(P.Z.Option,{label:"---",value:"",children:"---"},"empty"),R.map(e=>(0,r.jsx)(P.Z.Option,{label:e.name,value:e.code,children:e.name},e.code))]}),(0,r.jsx)(M.Z,{className:"w-full",id:"postal_code",name:"postal_code",placeholder:"Postal code",disabled:!s})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(M.Z,{className:"w-full",id:"city",name:"city",placeholder:"City",disabled:!s}),(0,r.jsx)(M.Z,{className:"w-full",id:"state",name:"state",placeholder:"State",disabled:!s})]})]})})})}})]}):(0,r.jsx)(y.Z,{resourceText:"view this organization's billing address"})})]})},Z=a(28977),D=a.n(Z),O=a(37669),L=a.n(O),U=a(79429),B=a(92197),F=a(65083);async function G(e,t){let{orgSlug:a}=e;if(!a)throw Error("orgSlug is required");let{data:n,error:s}=await (0,b.U2)("/platform/organizations/{slug}/billing/invoices/upcoming",{params:{path:{slug:a}},headers:{Version:"2"},signal:t});return s&&(0,b.S3)(s),n}let Y=function(e){let{orgSlug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(F.Y.orgUpcomingPreview(t),e=>{let{signal:a}=e;return G({orgSlug:t},a)},{enabled:a&&void 0!==t,...n})};var V=a(47878),H=a(19168),q=a(48653),W=a(5546),X=a(82445),K=a(18687);let Q=[K.tk.DATABASE_SIZE,K.tk.EGRESS,K.tk.STORAGE_SIZE],J=[K.tk.FUNCTION_INVOCATIONS,K.tk.LOG_DRAIN_EVENTS,K.tk.MONTHLY_ACTIVE_USERS,K.tk.MONTHLY_ACTIVE_SSO_USERS,K.tk.MONTHLY_ACTIVE_THIRD_PARTY_USERS,K.tk.REALTIME_MESSAGE_COUNT,K.tk.REALTIME_PEAK_CONNECTIONS,K.tk.STORAGE_IMAGES_TRANSFORMED],$=(e,t)=>{if(Q.includes(e)){let e=+(t.usage/1e9).toFixed(2).toLocaleString();return t.usage>0&&0===e?"<0.01":e}return t.hours&&!J.includes(e)?t.usage.toLocaleString()+" ("+Math.round(t.usage/t.hours).toLocaleString()+"x"+t.hours.toLocaleString()+" hours)":t.usage.toLocaleString()},ee=e=>Q.includes(e)?"GB":e.startsWith("COMPUTE_HOURS")||[K.tk.CUSTOM_DOMAIN,K.tk.IPV4,K.tk.PITR_7,K.tk.PITR_14,K.tk.PITR_28,K.tk.LOG_DRAIN,K.tk.AUTH_MFA_PHONE,K.tk.AUTH_MFA_WEB_AUTHN].includes(e)?"Hours":null,et=(e,t)=>{let a=["Current plan limits are not enough for me","I want better customer support from Supabase","I am migrating from a previous project"];return void 0===e||void 0===t||("free"===e&&"pro"===t?(a.push("Need more compute"),a.push("I want access to additional features like branching, daily backups, custom domain and PITR")):"team"===t&&a.push("I want access to SOC2 and HIPAA compliance")),a.push("None of the above"),a},ea=[{identifier:"COMPUTE",text:"Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the compute size of your project. Paused projects do not incur compute costs.",linkRef:"https://supabase.com/docs/guides/platform/org-based-billing#billing-for-compute-compute-hours"}],en=e=>{let{text:t,linkRef:a}=e;return(0,r.jsxs)(X.u,{"data-sentry-element":"Tooltip_Shadcn_","data-sentry-component":"InvoiceTooltip","data-sentry-source-file":"UpcomingInvoice.tsx",children:[(0,r.jsx)(X.aJ,{"data-sentry-element":"TooltipTrigger_Shadcn_","data-sentry-source-file":"UpcomingInvoice.tsx",children:(0,r.jsx)(B.Z,{size:12,strokeWidth:2,"data-sentry-element":"Info","data-sentry-source-file":"UpcomingInvoice.tsx"})}),(0,r.jsx)(X._v,{side:"bottom",className:"min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto","data-sentry-element":"TooltipContent_Shadcn_","data-sentry-source-file":"UpcomingInvoice.tsx",children:(0,r.jsxs)("p",{children:[t," ",a&&(0,r.jsx)(L(),{href:a,target:"_blank",rel:"noopener noreferrer",className:"transition text-brand hover:text-brand-600 underline",children:"Read more"})]})})]})};var es=e=>{var t,a;let{slug:n}=e,{data:s,error:i,isLoading:l,isError:o,isSuccess:d}=Y({orgSlug:n}),[c,m]=(0,u.useState)([]),h=(0,u.useMemo)(()=>((null==s?void 0:s.lines)||[]).find(e=>e.description.startsWith("Compute Credits")),[s]),x=(0,u.useMemo)(()=>((null==s?void 0:s.lines)||[]).filter(e=>e!==h&&(!e.breakdown||!e.breakdown.length)).sort((e,t)=>Number(e.proration)-Number(t.proration)),[s,h]),g=(0,u.useMemo)(()=>((null==s?void 0:s.lines)||[]).filter(e=>{var t;return null===(t=e.breakdown)||void 0===t?void 0:t.length}).sort((e,t)=>Number(e.usage_based)-Number(t.usage_based)||t.amount-e.amount),[s]),y=e=>{m([...c,e])},f=e=>{m(c.filter(t=>t!==e))},j=(0,u.useMemo)(()=>g.length===c.length,[g,c]);return(0,r.jsxs)(r.Fragment,{children:[l&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),o&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve upcoming invoice",error:i}),d&&(0,r.jsxs)("div",{children:[g.length>0&&(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(H.z,{size:"tiny",type:"default",onClick:()=>{j?m([]):m(g.map(e=>e.description))},children:j?"Collapse All":"Expand All"})}),(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("th",{className:"py-2 font-medium text-left text-sm text-foreground-light max-w-[200px]",children:"Item"}),(0,r.jsx)("th",{className:"py-2 font-medium text-right text-sm text-foreground-light pr-4",children:"Usage"}),(0,r.jsx)("th",{className:"py-2 pr-2 font-medium text-left text-sm text-foreground-light max-w-[200px]",children:"Unit price"}),(0,r.jsx)("th",{className:"py-2 font-medium text-right text-sm text-foreground-light",children:"Cost"})]})}),(0,r.jsx)("tbody",{children:x.map(e=>{var t,a;return(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsxs)("td",{className:"py-2 text-sm max-w-[200px]",colSpan:e.proration?3:1,children:[null!==(a=e.description)&&void 0!==a?a:"Unknown",e.usage_metric&&ee(e.usage_metric)&&" (".concat(ee(e.usage_metric),")")]}),!e.proration&&(0,r.jsx)("td",{className:"py-2 text-sm text-right pr-4",children:null===(t=e.quantity)||void 0===t?void 0:t.toLocaleString()}),!e.proration&&(0,r.jsx)("td",{className:"py-2 pr-2 text-sm max-w-[200px]",children:0===e.unit_price?"FREE":e.unit_price?(0,V.xG)(e.unit_price):"".concat(e.unit_price_desc)}),(0,r.jsx)("td",{className:"py-2 text-sm text-right",children:(0,V.xG)(e.amount)})]},e.description)})}),g.length>0&&g.map(e=>{var t,a;return(0,r.jsx)(q.ZP,{asChild:!0,open:c.includes(e.description),onOpenChange:t=>t?y(e.description):f(e.description),children:(0,r.jsxs)("tbody",{children:[(0,r.jsx)(q.ZP.Trigger,{asChild:!0,children:(0,r.jsxs)("tr",{className:c.includes(e.description)?"":"border-b",style:{WebkitAppearance:"initial"},children:[(0,r.jsxs)("td",{className:"py-2 text-sm max-w-[200px]",children:[(0,r.jsx)(H.z,{type:"text",className:"!px-1",icon:(0,r.jsx)(U.Z,{className:(0,W.cn)("transition",c.includes(e.description)&&"rotate-90")})})," ",(0,r.jsxs)("span",{className:"mr-2",children:[e.description,e.usage_metric&&ee(e.usage_metric)&&" (".concat(ee(e.usage_metric),")")]}),(()=>{let t=ea.find(t=>{var a;return null===(a=e.usage_metric)||void 0===a?void 0:a.startsWith(t.identifier)});return t?(0,r.jsx)(en,{text:t.text,linkRef:t.linkRef}):null})()]}),(0,r.jsx)("td",{className:"py-2 pr-4 text-sm text-right tabular-nums max-w-[100px]",children:e.usage_original?"".concat($(e.usage_metric,{usage:e.usage_original})):e.quantity?e.quantity:null}),(0,r.jsx)("td",{className:"py-2 text-sm",children:e.unit_price_desc?"".concat(e.unit_price_desc):e.unit_price?(0,V.xG)(e.unit_price):null}),(0,r.jsx)("td",{className:"py-2 text-sm text-right max-w-[70px]",children:null!==(a=(0,V.xG)(e.amount))&&void 0!==a?a:(0,V.xG)(0)})]},e.description)}),(0,r.jsx)(q.ZP.Content,{asChild:!0,children:(0,r.jsx)(r.Fragment,{children:null===(t=e.breakdown)||void 0===t?void 0:t.map(t=>(0,r.jsxs)("tr",{className:"last:border-b cursor-pointer",style:{WebkitAppearance:"initial"},children:[(0,r.jsx)("td",{className:"pb-1 text-xs pl-8 max-w-[200px]",children:t.project_name}),(0,r.jsx)("td",{className:"pb-1 text-xs tabular-nums text-right pr-4",children:$(e.usage_metric,t)}),(0,r.jsx)("td",{}),(0,r.jsx)("td",{})]},t.project_ref))})})]})},e.description)}),h&&(0,r.jsx)("tbody",{children:(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsxs)("td",{className:"py-2 text-sm max-w-[200px]",children:[(0,r.jsx)("span",{className:"mr-2",children:h.description}),(0,r.jsx)(en,{text:"Paid plans come with $10 in Compute Credits to cover one Micro instance or parts of any other instance. Compute Credits are given to you every month and do not stack up while you are on a paid plan.",linkRef:"https://supabase.com/docs/guides/platform/org-based-billing#compute-credits"})]}),(0,r.jsx)("td",{className:"py-2 text-sm text-right",colSpan:3,children:(0,V.xG)(h.amount)})]})}),(0,r.jsxs)("tfoot",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{className:"py-4 text-sm font-medium",children:[(0,r.jsx)("span",{className:"mr-2",children:"Current Costs"}),(0,r.jsx)(en,{text:"Costs accumulated from the beginning of the billing cycle up to now."})]}),(0,r.jsx)("td",{className:"py-4 text-sm text-right font-medium",colSpan:3,children:null!==(t=(0,V.xG)(null==s?void 0:s.amount_total))&&void 0!==t?t:"-"})]}),(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{className:"text-sm font-medium",children:[(0,r.jsx)("span",{className:"mr-2",children:"Projected Costs"}),(0,r.jsx)(en,{text:"Projected costs at the end of the billing cycle. Includes predictable costs for Compute Hours, IPv4, Custom Domain and Point-In-Time-Recovery, but no costs for metrics like MAU, storage or function invocations. Final amounts may vary depending on your usage."})]}),(0,r.jsx)("td",{className:"text-sm text-right font-medium",colSpan:3,children:null!==(a=(0,V.xG)(null==s?void 0:s.amount_projected))&&void 0!==a?a:"-"})]})]})]})]})]})},er=()=>{var e,t;let{slug:a}=(0,i.UO)(),n=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:s,error:u,isLoading:m,isError:h}=(0,d.Gl)({orgSlug:a},{enabled:n}),x=(0,o.N)("billing:invoices"),g=D().unix(null!==(e=null==s?void 0:s.current_period_start)&&void 0!==e?e:0).utc(),f=D().unix(null!==(t=null==s?void 0:s.current_period_end)&&void 0!==t?t:0).utc();return(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"BillingBreakdown","data-sentry-source-file":"BillingBreakdown.tsx",children:[(0,r.jsx)(l.g$,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"BillingBreakdown.tsx",children:(0,r.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,r.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Breakdown"}),(0,r.jsxs)("p",{className:"text-sm text-foreground-light m-0",children:["Current billing cycle: ",g.format("MMM DD")," -"," ",f.format("MMM DD")]}),(0,r.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"It may take up to an hour for addon changes or new projects to show up."})]})}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"BillingBreakdown.tsx",children:n?(0,r.jsxs)(r.Fragment,{children:[m&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),h&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:u}),x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{className:"prose text-sm",children:["The table shows your upcoming invoice, excluding credits. This invoice will continue updating until the end of your billing period on"," ",f.format("MMMM DD"),". See"," ",(0,r.jsx)(L(),{href:"/org/".concat(a,"/usage"),children:"usage page"})," for a more detailed usage breakdown."]}),(0,r.jsx)(es,{slug:a})]})]}):(0,r.jsx)(y.Z,{resourceText:"view this organization's billing breakdown"})})]})},ei=a(27296),el=a(11100),eo=()=>{let{slug:e}=(0,i.UO)(),t=(0,C.NL)(),a=(0,k.l)(),{name:n,billing_email:s}=null!=a?a:{},o="org-billing-email",d=(0,S.Xo)(c.KA.UPDATE,"organizations"),p=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{mutate:y,isLoading:f}=(0,ei.k)(),v=async(a,s)=>{let{resetForm:r}=s;return d?e?n?void y({slug:e,name:n,billing_email:a.billing_email},{onSuccess:e=>{let{billing_email:a}=e;r({values:{billing_email:a},initialValues:{billing_email:a}}),(0,el.aL)(t),m.Am.success("Successfully saved settings")}}):console.error("Organization name is required"):console.error("Slug is required"):m.Am.error("You do not have the required permissions to update this organization")};return p?(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"BillingEmail","data-sentry-source-file":"BillingEmail.tsx",children:[(0,r.jsx)(l.g$,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"BillingEmail.tsx",children:(0,r.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,r.jsx)("p",{className:"text-foreground text-base m-0",children:"Email Recipient"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"All billing correspondence will go to this email"})]})}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"BillingEmail.tsx",children:(0,r.jsx)(E.Z,{id:o,initialValues:{billing_email:null!=s?s:""},onSubmit:v,"data-sentry-element":"Form","data-sentry-source-file":"BillingEmail.tsx",children:t=>{let{handleReset:a,values:n,initialValues:i,resetForm:l}=t,c=JSON.stringify(n)!==JSON.stringify(i);return(0,u.useEffect)(()=>{let e={billing_email:null!=s?s:""};l({values:e,initialValues:e})},[e]),(0,r.jsx)(x.by,{footer:(0,r.jsx)("div",{className:"flex py-4 px-8",children:(0,r.jsx)(h.i,{form:o,isSubmitting:f,hasChanges:c,handleReset:a,helper:d?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,r.jsx)(g.hj,{children:(0,r.jsx)(g.B4,{fullWidth:!0,loading:!1,children:(0,r.jsx)(M.Z,{id:"billing_email",size:"small",label:"Email address",type:"text",disabled:!d})})})})}})})]}):null},ed=a(2552),ec=a(98809),eu=a(82899),em=a.n(eu),ep=a(67983),eh=a(77946),ex=a(56752),eg=a(41888),ey=a(32905),ef=a(99658),ev=a(53230),ej=a(29616);async function eb(e){let{slug:t,tier:a,paymentMethod:n}=e;if(!t)throw Error("slug is required");if(!a)throw Error("tier is required");let s={tier:a};void 0!==n&&(s.payment_method=n);let{error:r,data:i}=await (0,b.gz)("/platform/organizations/{slug}/billing/subscription",{body:{payment_method:s.payment_method,tier:s.tier},params:{path:{slug:t}}});return r&&(0,b.S3)(r),i}let eS=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>eb(e),{async onSuccess(t,a,s){let{slug:r}=a;await new Promise(e=>setTimeout(e,2e3)),await Promise.all([n.invalidateQueries(ej.U.orgSubscription(r)),n.invalidateQueries(ej.U.orgPlans(r)),n.invalidateQueries(ev.Z.orgUsage(r)),n.invalidateQueries(F.Y.orgUpcomingPreview(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to update subscription: ".concat(e.message)):t(e,a,n)},...a})};var eN=a(17806),ew=a(86977);let e_=[{name:"Spend cap enabled",value:"on",imageUrl:"".concat(eh.GW,"/img/spend-cap-on.png"),imageUrlLight:"".concat(eh.GW,"/img/spend-cap-on--light.png")},{name:"Spend cap disabled",value:"off",imageUrl:"".concat(eh.GW,"/img/spend-cap-off.png"),imageUrlLight:"".concat(eh.GW,"/img/spend-cap-off--light.png")}];var eC=()=>{var e;let{slug:t}=(0,i.UO)(),{resolvedTheme:a}=(0,ec.F)(),[n,s]=(0,u.useState)(!1),[l,o]=(0,u.useState)(),p=(0,S.Xo)(c.KA.BILLING_WRITE,"stripe.subscriptions"),h=(0,ex.Wu)(),x="costControl"===h.panelKey,g=()=>h.setPanelKey(void 0),{data:y,isLoading:f}=(0,d.Gl)({orgSlug:t}),{mutate:v,isLoading:j}=eS({onSuccess:()=>{m.Am.success("Successfully ".concat(w?"enabled":"disabled"," spend cap")),g()},onError:e=>{m.Am.error("Failed to toggle spend cap: ".concat(e.message))}}),b=(null==y?void 0:null===(e=y.plan)||void 0===e?void 0:e.id)==="free",N=!(null==y?void 0:y.usage_billing_enabled),w=!N&&"on"===l,_=l!==(N?"on":"off");(0,u.useEffect)(()=>{x&&void 0!==y&&o(N?"on":"off")},[x,f,y,N]);let C=async()=>{if(!t)return console.error("Org slug is required");v({slug:t,tier:"on"===l?eh.ev.PRO:eh.ev.PAYG})};return(0,r.jsx)(ew.ZP,{size:"large",loading:f||j,disabled:b||f||!_||j||!p,visible:x,onCancel:g,onConfirm:C,header:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h4",{children:"Spend cap"}),(0,r.jsx)(H.z,{asChild:!0,type:"default",icon:(0,r.jsx)(ed.Z,{strokeWidth:1.5}),children:(0,r.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer",children:"About spend cap"})})]}),tooltip:p?void 0:"You do not have permission to update spend cap","data-sentry-element":"SidePanel","data-sentry-component":"SpendCapSidePanel","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,r.jsx)(ew.ZP.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,r.jsxs)("div",{className:"py-6 space-y-4",children:[(0,r.jsx)("p",{className:"text-sm",children:"Use the spend cap to manage project usage and costs, and control whether the project can exceed the included quota allowance of any billed line item in a billing cycle"}),(0,r.jsxs)(q.ZP,{open:n,onOpenChange:s,"data-sentry-element":"Collapsible","data-sentry-source-file":"SpendCapSidePanel.tsx",children:[(0,r.jsx)(q.ZP.Trigger,{asChild:!0,"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,r.jsx)(U.Z,{strokeWidth:1.5,size:16,className:n?"rotate-90":"","data-sentry-element":"ChevronRight","data-sentry-source-file":"SpendCapSidePanel.tsx"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"How are each resource charged after exceeding the included quota?"})]})}),(0,r.jsx)(q.ZP.Content,{asChild:!0,"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,r.jsx)(ef.Z,{className:"mt-4",head:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ef.Z.th,{children:(0,r.jsx)("p",{className:"text-xs",children:"Item"})}),(0,r.jsx)(ef.Z.th,{children:(0,r.jsx)("p",{className:"text-xs",children:"Rate"})})]}),body:["database","auth","storage","realtime","edge_functions"].map(e=>{let t=eN.D[e],a=t.features.filter(e=>e.usage_based);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(ef.Z.tr,{children:[(0,r.jsx)(ef.Z.td,{children:(0,r.jsx)("p",{className:"text-xs text-foreground",children:t.title})}),(0,r.jsx)(ef.Z.td,{children:null})]},e),a.map(e=>(0,r.jsxs)(ef.Z.tr,{children:[(0,r.jsx)(ef.Z.td,{children:(0,r.jsx)("p",{className:"text-xs pl-4",children:e.title})}),(0,r.jsx)(ef.Z.td,{children:(0,r.jsx)("p",{className:"text-xs pl-4",children:e.plans.pro})})]},e.title))]})}),"data-sentry-element":"Table","data-sentry-source-file":"SpendCapSidePanel.tsx"})})]}),b&&(0,r.jsx)(eg.b,{withIcon:!0,variant:"info",title:"Toggling of the spend cap is only available on the Pro Plan",actions:(0,r.jsx)(H.z,{type:"default",onClick:()=>h.setPanelKey("subscriptionPlan"),children:"View available plans"}),children:"Upgrade your plan to disable the spend cap"}),(0,r.jsx)("div",{className:"!mt-8 pb-4",children:(0,r.jsx)("div",{className:"flex gap-3",children:e_.map(e=>{let t=l===e.value;return(0,r.jsxs)("div",{className:(0,W.cn)("col-span-4 group space-y-1",b&&"opacity-75"),onClick:()=>!b&&o(e.value),children:[(0,r.jsx)(em(),{alt:"Spend Cap",className:(0,W.cn)("relative rounded-xl transition border bg-no-repeat bg-center bg-cover w-[160px] h-[96px]",t?"border-foreground":"border-foreground-muted opacity-50 group-hover:border-foreground-lighter group-hover:opacity-100",!b&&"cursor-pointer",!b&&!t&&"group-hover:border-foreground-light"),width:160,height:96,src:(null==a?void 0:a.includes("dark"))?e.imageUrl:e.imageUrlLight}),(0,r.jsx)("p",{className:(0,W.cn)("text-sm transition",!b&&"group-hover:text-foreground",t?"text-foreground":"text-foreground-light"),children:e.name})]},e.value)})})}),"on"===l?(0,r.jsx)(eg.b,{withIcon:!0,variant:"warning",title:"Your projects could become unresponsive or enter read only mode",children:"Exceeding the included quota allowance with spend cap enabled can cause your projects to become unresponsive or enter read only mode."}):(0,r.jsx)(eg.b,{withIcon:!0,variant:"info",title:"Charges apply for usage beyond included quota allowance",children:"Your projects will always remain responsive and active, and charges only apply when exceeding the included quota limit."}),_&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-sm",children:"on"===l?"Upon clicking confirm, spend cap will be enabled for your organization and you will no longer be charged any extra for usage.":"Upon clicking confirm, spend cap will be disabled for your organization and you will be charged for any usage beyond the included quota."}),(0,r.jsx)("p",{className:"text-sm",children:"Toggling spend cap triggers an invoice and there might be prorated charges for any usage beyond the Pro Plans quota during this billing cycle."})]})]})})})},eA=e=>{var t;let{}=e,{slug:a}=(0,i.UO)(),{resolvedTheme:n}=(0,ec.F)(),s=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),o=(0,ex.Wu)(),u=(0,ep.P)("disableProjectCreationAndUpdate"),{data:m,error:h,isLoading:x,isSuccess:g,isError:f}=(0,d.Gl)({orgSlug:a},{enabled:s}),j=null==m?void 0:m.plan,b=null!==(t=null==m?void 0:m.usage_billing_enabled)&&void 0!==t&&t,N=!u&&!["team","enterprise"].includes((null==j?void 0:j.id)||"");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"CostControl.tsx",children:[(0,r.jsx)(l.g$,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"CostControl.tsx",children:(0,r.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-foreground text-base m-0",children:"Cost Control"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Control whether to use beyond your plans included quota"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,r.jsx)("div",{children:(0,r.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer","data-sentry-element":"Link","data-sentry-source-file":"CostControl.tsx",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,r.jsx)("p",{className:"text-sm m-0",children:"Spend cap"}),(0,r.jsx)(ed.Z,{size:16,strokeWidth:1.5,"data-sentry-element":"ExternalLink","data-sentry-source-file":"CostControl.tsx"})]})})})]})]})}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"CostControl.tsx",children:s?(0,r.jsxs)(r.Fragment,{children:[x&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),f&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:h}),g&&(0,r.jsxs)("div",{className:"space-y-6",children:[["team","enterprise"].includes((null==j?void 0:j.id)||"")?(0,r.jsxs)(eg.b,{withIcon:!0,variant:"info",title:"You will be charged for any additional usage on the ".concat((null==j?void 0:j.name)||""," plan"),children:[(null==j?void 0:j.name)||""," plan requires you to have spend cap off at all times. Your projects will never become unresponsive. Only when your"," ",(0,r.jsx)(L(),{href:"/org/".concat(a,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included usage"})," ","is exceeded will you be charged for any additional usage."]}):(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["You can control whether your organization is charged for additional usage beyond the"," ",(0,r.jsx)(L(),{href:"/org/".concat(a,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included quota"})," ","of your subscription plan. If you need to go beyond the included quota, simply switch off your spend cap to pay for additional usage."]}),(0,r.jsxs)("div",{className:"flex space-x-6",children:[(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"rounded-md bg-surface-200 w-[160px] h-[96px] shadow",children:(0,r.jsx)(em(),{alt:"Spend Cap",width:160,height:96,src:b?"".concat(eh.GW,"/img/spend-cap-off").concat((null==n?void 0:n.includes("dark"))?"":"--light",".png?v=3"):"".concat(eh.GW,"/img/spend-cap-on").concat((null==n?void 0:n.includes("dark"))?"":"--light",".png?v=3")})})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"mb-1",children:["Spend cap is ",b?"disabled":"enabled"]}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:b?(0,r.jsx)("span",{children:"You will be charged for any usage above the included quota."}):(0,r.jsx)("span",{children:"You won't be charged any extra for usage. However, your projects could become unresponsive or enter read only mode if you exceed the included quota."})}),b&&(0,r.jsx)("p",{className:"text-sm text-foreground-light mt-1",children:"Your projects will never become unresponsive. Only when your usage reaches the quota limit will you be charged for any excess usage."}),(0,r.jsx)(ey.Z,{projectUpdateDisabled:u,children:(0,r.jsx)(H.z,{type:"default",className:"mt-4 pointer-events-auto",disabled:!N,onClick:()=>o.setPanelKey("costControl"),children:"Change spend cap"})})]})]})]})]}):(0,r.jsx)(y.Z,{resourceText:"update this organization's cost control"})})]}),(0,r.jsx)(eC,{"data-sentry-element":"SpendCapSidePanel","data-sentry-source-file":"CostControl.tsx"})]})},eI=a(28436),eT=()=>{var e;let{slug:t}=(0,i.UO)(),a=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:n,error:s,isLoading:o,isError:u,isSuccess:m}=(0,d.Gl)({orgSlug:t},{enabled:a}),h=(null!==(e=null==n?void 0:n.customer_balance)&&void 0!==e?e:0)/100,x=h<0,g=h>0,f=x&&0!==h?h.toFixed(2).toString().replace("-",""):h.toFixed(2);return(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"CreditBalance","data-sentry-source-file":"CreditBalance.tsx",children:[(0,r.jsx)(l.g$,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"CreditBalance.tsx",children:(0,r.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-foreground text-base m-0",children:"Credit Balance"}),x&&(0,r.jsx)(eI.C,{children:"You have credits available"}),g&&(0,r.jsx)(eI.C,{variant:"destructive",children:"Outstanding payments"})]}),(0,r.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Charges will be deducted from your balance first"})]})}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"CreditBalance.tsx",children:a?(0,r.jsxs)(r.Fragment,{children:[o&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),u&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve organization customer profile",error:s}),m&&(0,r.jsxs)("div",{className:"flex items-end space-x-1",children:[g&&(0,r.jsx)("h4",{className:"opacity-50",children:"-"}),(0,r.jsx)("h4",{className:"opacity-50",children:"$"}),(0,r.jsx)("h2",{className:"text-4xl relative top-[2px]",children:f}),x&&(0,r.jsx)("h4",{className:"opacity-50",children:"/credits"})]})]}):(0,r.jsx)(y.Z,{resourceText:"view this organization's credits"})})]})},ek=a(95846),eE=a(34726),eM=a(22155),eP=a(2054);async function eR(e){let{slug:t,hcaptchaToken:a}=e,{data:n,error:s}=await (0,b.v_)("/platform/organizations/{slug}/payments/setup-intent",{params:{path:{slug:t}},body:{hcaptchaToken:a}});return s&&(0,b.S3)(s),n}let ez=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,A.D)(e=>eR(e),{async onSuccess(t,a,n){await (null==e?void 0:e(t,a,n))},async onError(e,a,n){void 0===t?m.Am.error("Failed to setup intent: ".concat(e.message)):t(e,a,n)},...a})};var eZ=a(9127);async function eD(e){let{slug:t,paymentMethodId:a}=e;if(!t)throw Error("Slug is required");let{data:n,error:s}=await (0,b.gz)("/platform/organizations/{slug}/payments/default",{body:{payment_method_id:a},params:{path:{slug:t}}});if(s)throw(0,b.S3)(s);return n}let eO=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>eD(e),{async onSuccess(t,a,s){let{slug:r,paymentMethodId:i}=a;n.setQueriesData(N.O.paymentMethods(r),e=>e?{...e,defaultPaymentMethodId:i,data:e.data.map(e=>({...e,is_default:e.id===i}))}:e),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to mark payment method as default: ".concat(e.message)):t(e,a,n)},...a})};var eL=a(65497),eU=a(27037),eB=e=>{let{returnUrl:t,onCancel:a,onConfirm:n,showSetDefaultCheckbox:s=!1,autoMarkAsDefaultPaymentMethod:i=!1}=e,l=(0,eE.useStripe)(),o=(0,eE.useElements)(),d=(0,k.l)(),[c,p]=(0,u.useState)(!1),[h,x]=(0,u.useState)(s),g=(0,C.NL)(),{mutateAsync:y}=eO(),f=async e=>{if(e.preventDefault(),!l||!o){console.error("Stripe.js has not loaded");return}p(!0),void 0!==document&&document.body.classList.add("!pointer-events-auto");let{error:a,setupIntent:s}=await l.confirmSetup({elements:o,redirect:"if_required",confirmParams:{return_url:t}});if(a){var r;p(!1),m.Am.error(null!==(r=null==a?void 0:a.message)&&void 0!==r?r:" Failed to save card details")}else{if((h||i)&&d&&"string"==typeof(null==s?void 0:s.payment_method))try{await y({slug:d.slug,paymentMethodId:s.payment_method}),await g.invalidateQueries(N.O.paymentMethods(d.slug)),g.setQueriesData(N.O.paymentMethods(d.slug),e=>e?{...e,defaultPaymentMethodId:s.payment_method,data:e.data.map(e=>({...e,is_default:e.id===s.payment_method}))}:e)}catch(e){m.Am.error("Failed to set payment method as default")}else d&&await g.invalidateQueries(N.O.paymentMethods(d.slug));p(!1),n()}void 0!==document&&document.body.classList.remove("!pointer-events-auto")};return(0,r.jsxs)("form",{onSubmit:f,"data-sentry-component":"AddPaymentMethodForm","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:[(0,r.jsxs)(eP.Z.Content,{className:"transition ".concat(c?"pointer-events-none opacity-75":"opacity-100"),"data-sentry-element":"unknown","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:[(0,r.jsx)(eE.PaymentElement,{className:"[.p-LinkAutofillPrompt]:pt-0","data-sentry-element":"PaymentElement","data-sentry-source-file":"AddPaymentMethodForm.tsx"}),s&&(0,r.jsxs)("div",{className:"flex items-center gap-x-2 mt-4 mb-2",children:[(0,r.jsx)(eL.X,{id:"save-as-default",checked:h,onCheckedChange:e=>{"boolean"==typeof e&&x(e)}}),(0,r.jsx)(eU._,{htmlFor:"save-as-default",className:"text-foreground-light",children:"Save as default payment method"})]})]}),(0,r.jsx)(eP.Z.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"AddPaymentMethodForm.tsx"}),(0,r.jsxs)(eP.Z.Content,{className:"flex items-center space-x-2","data-sentry-element":"unknown","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:[(0,r.jsx)(H.z,{htmlType:"button",size:"small",type:"default",onClick:a,block:!0,disabled:c,"data-sentry-element":"Button","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:"Cancel"}),(0,r.jsx)(H.z,{block:!0,htmlType:"submit",size:"small",type:"primary",loading:c,disabled:c,"data-sentry-element":"Button","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:"Add payment method"})]})]})};let eF=(0,eM.J)(eh.Yw);var eG=e=>{let{visible:t,returnUrl:a,onCancel:n,onConfirm:s,showSetDefaultCheckbox:i,autoMarkAsDefaultPaymentMethod:l}=e,{resolvedTheme:o}=(0,ec.F)(),[d,c]=(0,u.useState)(),p=(0,k.l)(),h=(0,eZ.Y)(),[x,g]=(0,u.useState)(null),[y,f]=(0,u.useState)(null),{mutate:v}=ez({onSuccess:e=>{c(e)},onError:e=>{m.Am.error("Failed to setup intent: ".concat(e.message))}}),j=(0,u.useCallback)(e=>{f(e)},[]);(0,u.useEffect)(()=>{let e=async e=>{let t=null==p?void 0:p.slug;return t?e?void(c(void 0),v({slug:t,hcaptchaToken:e})):console.error("HCaptcha token required"):console.error("Slug is required")};(async()=>{if(t&&y&&h){let t=x;try{if(!t){var a;let e=await y.execute({async:!0});t=null!==(a=null==e?void 0:e.response)&&void 0!==a?a:null}}catch(e){return}await e(null!=t?t:void 0),b()}})()},[t,y,h]);let b=()=>{g(null),null==y||y.resetCaptcha()},S={clientSecret:d?d.client_secret:"",appearance:{theme:(null==o?void 0:o.includes("dark"))?"night":"flat",labels:"floating"}},N=()=>(c(void 0),n());return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ek.Z,{ref:j,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{N(),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:e=>{g(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>{g(null)},"data-sentry-element":"HCaptcha","data-sentry-source-file":"AddNewPaymentMethodModal.tsx"}),(0,r.jsx)(eP.Z,{hideFooter:!0,size:"medium",visible:t&&void 0!==d,header:"Add new payment method",onCancel:N,className:"PAYMENT","data-sentry-element":"Modal","data-sentry-source-file":"AddNewPaymentMethodModal.tsx",children:(0,r.jsx)(eE.Elements,{stripe:eF,options:S,"data-sentry-element":"Elements","data-sentry-source-file":"AddNewPaymentMethodModal.tsx",children:(0,r.jsx)(eB,{returnUrl:a,onCancel:N,onConfirm:()=>(c(void 0),s()),showSetDefaultCheckbox:i,autoMarkAsDefaultPaymentMethod:l,"data-sentry-element":"AddPaymentMethodForm","data-sentry-source-file":"AddNewPaymentMethodModal.tsx"})})})]})};async function eY(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let{data:n,error:s}=await (0,b.U2)("/platform/organizations/{slug}/payments",{params:{path:{slug:a}},headers:{Version:"2"},signal:t});return s&&(0,b.S3)(s),n}let eV=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,S.Xo)(c.KA.BILLING_READ,"stripe.payment_methods");return(0,j.a)(N.O.paymentMethods(t),e=>{let{signal:a}=e;return eY({slug:t},a)},{enabled:a&&void 0!==t&&s,...n})};var eH=a(81449),eq=a(74822),eW=e=>{var t,a;let{selectedPaymentMethod:n,onClose:s}=e,{slug:l}=(0,i.UO)(),{mutate:o,isLoading:d}=eO({onSuccess:()=>{m.Am.success("Successfully changed payment method to the card ending with ".concat(n.card.last4)),s()},onError:e=>{m.Am.error("Failed to change payment method: ".concat(e.message))}}),c=async()=>l?n?void o({slug:l,paymentMethodId:n.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,r.jsx)(eP.Z,{visible:void 0!==n,size:"medium",header:"Confirm to use payment method ending with ".concat(null==n?void 0:null===(t=n.card)||void 0===t?void 0:t.last4),onCancel:()=>s(),customFooter:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(H.z,{type:"default",disabled:d,onClick:()=>s(),children:"Cancel"}),(0,r.jsx)(H.z,{type:"primary",disabled:d,loading:d,onClick:c,children:"Confirm"})]}),"data-sentry-element":"Modal","data-sentry-component":"ChangePaymentMethodModal","data-sentry-source-file":"ChangePaymentMethodModal.tsx",children:(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"ChangePaymentMethodModal.tsx",children:(0,r.jsxs)("p",{className:"text-sm",children:["Upon clicking confirm, all future charges will be deducted from the card ending with"," ",null==n?void 0:null===(a=n.card)||void 0===a?void 0:a.last4,". There are no immediate charges."]})})})},eX=a(51233),eK=a(24267),eQ=a(77518),eJ=e=>{var t,a,n,s;let{paymentMethod:i,canUpdatePaymentMethods:l=!0,paymentMethodType:o,setSelectedMethodForUse:d,setSelectedMethodToDelete:c}=e,u=i.is_default,m=null!==(n=null===(t=i.card)||void 0===t?void 0:t.exp_year)&&void 0!==n?n:0,p=null!==(s=null===(a=i.card)||void 0===a?void 0:a.exp_month)&&void 0!==s?s:0,h=new Date().getMonth()+1,x=new Date().getFullYear();return i.card?(0,r.jsxs)("div",{className:"flex items-center justify-between gap-8","data-sentry-component":"CreditCard","data-sentry-source-file":"CreditCard.tsx",children:[(0,r.jsxs)("div",{className:"flex items-center gap-8",children:[(0,r.jsx)("img",{alt:"Credit card brand",src:"".concat(eh.GW,"/img/payment-methods/").concat(i.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,r.jsxs)("p",{className:"prose text-sm font-mono",children:["**** **** **** ",i.card.last4]}),(0,r.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",i.card.exp_month,"/",i.card.exp_year]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[m===x&&p===h&&(0,r.jsx)(eI.C,{variant:"warning",children:"Expiring soon"}),(m<x||m===x&&p<h)&&(0,r.jsx)(eI.C,{variant:"destructive",children:"Expired"}),u&&(0,r.jsx)(eI.C,{variant:"brand",children:"Active"}),l&&(0,r.jsxs)(eQ.h_,{children:[(0,r.jsx)(eQ.$F,{asChild:!0,children:(0,r.jsx)(H.z,{type:"outline",className:"hover:border-muted px-1",icon:(0,r.jsx)(eX.Z,{}),"aria-label":"More options"})}),(0,r.jsxs)(eQ.AW,{align:"end",className:"w-36",children:["card"===o&&!u&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eQ.Xi,{onClick:()=>null==d?void 0:d(i),children:(0,r.jsx)("p",{children:"Use this card"})},"make-default"),(0,r.jsx)(eQ.VD,{})]}),(0,r.jsx)(eK._,{disabled:u,className:"!pointer-events-auto",onClick:()=>null==c?void 0:c(i),tooltip:{content:{side:"left",text:u?"Unable to delete a card that is currently active":void 0}},children:(0,r.jsx)("p",{children:"Delete card"})},"delete-method")]})]})]})]},i.id):null};async function e$(e){let{slug:t,cardId:a}=e,{data:n,error:s}=await (0,b.IV)("/platform/organizations/{slug}/payments",{body:{card_id:a},params:{path:{slug:t}}});return s&&(0,b.S3)(s),n}let e0=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>e$(e),{async onSuccess(t,a,s){let{slug:r}=a;await n.invalidateQueries(N.O.paymentMethods(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to delete payment method: ".concat(e.message)):t(e,a,n)},...a})};var e1=a(61911),e2=e=>{var t;let{selectedPaymentMethod:a,onClose:n}=e,{slug:s}=(0,i.UO)(),{mutate:l,isLoading:o}=e0({onSuccess:()=>{var e;m.Am.success("Successfully removed payment method ending with ".concat(null==a?void 0:null===(e=a.card)||void 0===e?void 0:e.last4)),n()}}),d=async()=>s?a?void l({slug:s,cardId:a.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,r.jsx)(eP.Z,{visible:void 0!==a,size:"medium",header:"Confirm to delete payment method ending with ".concat(null==a?void 0:null===(t=a.card)||void 0===t?void 0:t.last4),onCancel:()=>n(),customFooter:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(H.z,{type:"default",disabled:o,onClick:()=>n(),children:"Cancel"}),(0,r.jsx)(H.z,{type:"primary",disabled:o,loading:o,onClick:d,children:"Confirm"})]}),"data-sentry-element":"Modal","data-sentry-component":"DeletePaymentMethodModal","data-sentry-source-file":"DeletePaymentMethodModal.tsx",children:(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"DeletePaymentMethodModal.tsx",children:(0,r.jsx)(e1.J,{type:"default",title:"This will permanently delete your payment method.",description:"You can re-add the payment method any time.","data-sentry-element":"Admonition","data-sentry-source-file":"DeletePaymentMethodModal.tsx"})})})},e4=()=>{var e,t,a;let{slug:n}=(0,i.UO)(),s=(0,k.l)(),[o,h]=(0,u.useState)(),[j,b]=(0,u.useState)(),[N,w]=(0,u.useState)(!1),{data:_}=(0,d.Gl)({orgSlug:n}),{data:C,error:A,isLoading:I,isError:T,isSuccess:E}=eV({slug:n}),M=(0,S.Xo)(c.KA.BILLING_READ,"stripe.payment_methods"),P=(0,S.Xo)(c.KA.BILLING_WRITE,"stripe.payment_methods");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"PaymentMethods.tsx",children:[(0,r.jsx)(l.g$,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"PaymentMethods.tsx",children:(0,r.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,r.jsx)("p",{className:"text-foreground text-base m-0",children:"Payment Methods"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light mb-2 pr-4 m-0",children:"Payments for your subscription are made using the default card."})]})}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"PaymentMethods.tsx",children:(null==s?void 0:s.managed_by)!==void 0&&(null==s?void 0:s.managed_by)!=="supabase"?(0,r.jsx)(f.Z,{partner:null==s?void 0:s.managed_by,resource:"Payment Methods",cta:{installationId:null==s?void 0:s.partner_id}}):M?(0,r.jsxs)(r.Fragment,{children:[I&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),T&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve payment methods",error:A}),E&&(0,r.jsxs)(r.Fragment,{children:[(null==_?void 0:_.payment_method_type)==="invoice"&&(0,r.jsx)(eg.b,{withIcon:!0,variant:"info",title:"Payment is currently by invoice",actions:[(0,r.jsx)(H.z,{asChild:!0,type:"default",children:(0,r.jsx)(L(),{href:"/support/new?category=billing&subject=Request%20to%20change%20payment%20method",target:"_blank",rel:"noreferrer",className:"ml-3",children:"Contact support"})},"payment-method-support")],children:"You get a monthly invoice and payment link via email. To change your payment method, please contact us via our support form."}),(0,r.jsx)(x.by,{footer:(0,r.jsxs)("div",{className:"flex items-center justify-between py-4 px-8",children:[P?(0,r.jsx)("div",{}):(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to manage payment methods"}),(0,r.jsx)(H.z,{type:"default",icon:(0,r.jsx)(eH.Z,{}),disabled:!P,onClick:()=>w(!0),children:"Add new card"})]}),children:(0,r.jsx)(g.hj,{children:(0,r.jsx)(g.B4,{fullWidth:!0,loading:!1,children:(null!==(a=null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.length)&&void 0!==a?a:0)===0?(0,r.jsxs)("div",{className:"flex items-center gap-2 opacity-50",children:[(0,r.jsx)(eq.Z,{size:16,strokeWidth:1.5}),(0,r.jsx)("p",{className:"text-sm",children:"No payment methods"})]}):(0,r.jsx)("div",{className:"space-y-3",children:null==C?void 0:null===(t=C.data)||void 0===t?void 0:t.map(e=>(0,r.jsx)(eJ,{paymentMethod:e,canUpdatePaymentMethods:P,paymentMethodType:null==_?void 0:_.payment_method_type,setSelectedMethodForUse:h,setSelectedMethodToDelete:b},e.id))})})})})]})]}):(0,r.jsx)(y.Z,{resourceText:"view this organization's payment methods"})})]}),(0,r.jsx)(eG,{visible:N,returnUrl:"".concat((0,V.Ax)(),"/org/").concat(n,"/billing"),onCancel:()=>w(!1),onConfirm:()=>{w(!1),m.Am.success("Successfully added new payment method")},showSetDefaultCheckbox:!0,"data-sentry-element":"AddNewPaymentMethodModal","data-sentry-source-file":"PaymentMethods.tsx"}),(0,r.jsx)(eW,{selectedPaymentMethod:o,onClose:()=>h(void 0),"data-sentry-element":"ChangePaymentMethodModal","data-sentry-source-file":"PaymentMethods.tsx"}),(0,r.jsx)(e2,{selectedPaymentMethod:j,onClose:()=>b(void 0),"data-sentry-element":"DeletePaymentMethodModal","data-sentry-source-file":"PaymentMethods.tsx"})]})},e5=a(59262),e3=a(85517),e6=a(71904),e8=a(55203);let e7=()=>{let e=(0,k.l)(),{data:t,isSuccess:a}=(0,e3.v)({orgSlug:null==e?void 0:e.slug}),{data:n,isSuccess:s}=(0,d.Gl)({orgSlug:null==e?void 0:e.slug}),i=!!(null==t?void 0:t.usages.find(e=>{var t;return e.metric!==K.tk.DISK_SIZE_GB_HOURS_GP3&&!e.unlimited&&e.capped&&e.usage>(null!==(t=null==e?void 0:e.pricing_free_units)&&void 0!==t?t:0)}));if(!a||!s||!e)return null;let l=null;return(n&&i&&!(null==e?void 0:e.restriction_status)?l="exceededLimits":(null==e?void 0:e.restriction_status)==="grace_period"?l="gracePeriod":(null==e?void 0:e.restriction_status)==="grace_period_over"?l="gracePeriodOver":(null==e?void 0:e.restriction_status)==="restricted"&&(l="restricted"),null===l)?null:(0,r.jsxs)(r.Fragment,{children:["exceededLimits"===l&&(0,r.jsxs)(e6.bZ,{variant:"destructive",children:[(0,r.jsx)(e8.ku,{}),(0,r.jsx)(e6.Cd,{children:"Your organization's usage has exceeded its included quota"}),(0,r.jsxs)(e6.X,{children:[(0,r.jsxs)("p",{children:["Your projects can become unresponsive or enter read-only mode."," ","free"===n.plan.id?"Please upgrade to the Pro Plan to ensure that your projects remain available.":"Please disable spend cap to ensure that your projects remain available."]}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,r.jsx)(H.z,{asChild:!0,type:"default",children:(0,r.jsx)(L(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=").concat("free"===n.plan.id?"subscriptionPlan":"costControl"),children:"free"===n.plan.id?"Upgrade plan":"Change spend cap"})},"upgrade-button"),(0,r.jsx)(H.z,{asChild:!0,type:"default",icon:(0,r.jsx)(ed.Z,{}),children:(0,r.jsx)("a",{href:"https://supabase.com/docs/guides/platform/spend-cap",children:"About spend cap"})})]})]})]}),"gracePeriod"===l&&(0,r.jsxs)(e6.bZ,{variant:"warning",children:[(0,r.jsx)(e8.aN,{}),(0,r.jsx)(e6.Cd,{children:"Your grace period has started."}),(0,r.jsxs)(e6.X,{children:[(0,r.jsxs)("p",{className:"leading-tight",children:["Your organization is over its quota. You can continue with your projects until your grace period ends on"," ",(0,r.jsx)("span",{className:"text-foreground",children:D()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". After that, the Fair Use Policy will apply. If you plan to maintain this level of usage, upgrade your plan to avoid any restrictions. If restrictions are applied, requests to your projects will return a 402 status code."]}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,r.jsx)(H.z,{asChild:!0,type:"default",children:(0,r.jsx)(L(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button"),(0,r.jsx)(H.z,{asChild:!0,type:"default",icon:(0,r.jsx)(ed.Z,{}),children:(0,r.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]}),"gracePeriodOver"===l&&(0,r.jsxs)(e6.bZ,{variant:"warning",children:[(0,r.jsx)(e8.aN,{}),(0,r.jsx)(e6.Cd,{children:"Your grace period is over."}),(0,r.jsxs)(e6.X,{children:[(0,r.jsxs)("p",{children:["Your grace period ended on"," ",(0,r.jsx)("span",{className:"text-foreground",children:D()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". Fair Use Policy applies now. Stay below your plan’s quota or upgrade your plan if you expect to exceed it. If you exceed your quota, requests will respond with a 402 status code."]}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,r.jsx)(H.z,{asChild:!0,type:"default",children:(0,r.jsx)(L(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button"),(0,r.jsx)(H.z,{asChild:!0,type:"default",icon:(0,r.jsx)(ed.Z,{}),children:(0,r.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]}),"restricted"===l&&(0,r.jsxs)(e6.bZ,{variant:"destructive",children:[(0,r.jsx)(e8.ku,{}),(0,r.jsx)(e6.Cd,{children:"All services are restricted."}),(0,r.jsxs)(e6.X,{children:[(0,r.jsxs)("p",{children:["Fair Use Policy applies and your service is restricted. Your projects are not able to serve requests and will respond with a 402 status code. You have exceeded your plan’s quota and your grace period ended on"," ",(0,r.jsx)("span",{className:"text-foreground",children:D()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". Upgrade to lift restrictions or wait until your quota refills."]}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,r.jsx)(H.z,{asChild:!0,type:"default",children:(0,r.jsx)(L(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button"),(0,r.jsx)(H.z,{asChild:!0,type:"default",icon:(0,r.jsx)(ed.Z,{}),children:(0,r.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]})]})};var e9=a(55589),te=a.n(e9),tt=a(45196),ta=a(53995),tn=a(61932),ts=a(97881),tr=a(52065),ti=a(47150);async function tl(e){let{organizationSlug:t,tier:a}=e;if(!t)throw Error("organizationSlug is required");if(!a)throw Error("tier is required");let{data:n,error:s}=await (0,b.v_)("/platform/organizations/{slug}/billing/subscription/preview",{params:{path:{slug:t}},body:{tier:a},headers:{Version:"2"}});return s&&(0,b.S3)(s),n}let to=function(e){let{organizationSlug:t,tier:a}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(N.O.subscriptionPreview(t,a),()=>tl({organizationSlug:t,tier:a}),{enabled:n&&void 0!==t&&void 0!==a,...s,retry:(e,t)=>("object"!=typeof t||null===t||!("code"in t)||400!==t.code)&&e<3})};var td=a(19726),tc=a(37417);async function tu(e,t){let{orgSlug:a}=e;if(!a)throw Error("orgSlug is required");let{error:n,data:s}=await (0,b.U2)("/platform/organizations/{slug}/billing/plans",{params:{path:{slug:a}},signal:t});return n&&(0,b.S3)(n),s}let tm=function(e){let{orgSlug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions");return(0,j.a)(ej.U.orgPlans(t),e=>{let{signal:a}=e;return tu({orgSlug:t},a)},{enabled:a&&void 0!==t&&s,...n})};var tp=a(81980),th=a(77308),tx=a(77880);let tg=e=>{let{projectAddon:t}=e,a=t.addons.find(e=>"compute_instance"===e.type),n=t.addons.filter(e=>!["log_drain","auth_mfa_phone"].includes(e.type)).map(e=>"compute_instance"===e.type?"".concat(e.variant.name," Compute Instance"):e.variant.name);return(0,r.jsxs)("li",{className:"list-disc ml-6","data-sentry-component":"ProjectDowngradeListItem","data-sentry-source-file":"DowngradeModal.tsx",children:[t.name,": ",n.join(", ")," will be removed.",a?(0,r.jsxs)(r.Fragment,{children:[" ","Project will also ",(0,r.jsx)("span",{className:"font-bold",children:"need to be restarted"})," due to change in compute instance"]}):""]})};var ty=e=>{var t;let{visible:a,selectedPlan:n,subscription:s,onClose:i,onConfirm:l,projects:o}=e,d=(null==s?void 0:s.project_addons.flatMap(e=>{let t=e.addons.filter(e=>"ci_micro"!==e.variant.identifier);return t.length?{...e,addons:t}:[]}))||[],c=o.some(e=>"micro"===e.infra_compute_size),u=(null==s?void 0:s.nano_enabled)===!0;return(0,r.jsx)(eP.Z,{size:"large",alignFooter:"right",variant:"warning",visible:a,onCancel:i,onConfirm:l,header:"Confirm to downgrade to ".concat(null==n?void 0:n.name," plan"),"data-sentry-element":"Modal","data-sentry-component":"DowngradeModal","data-sentry-source-file":"DowngradeModal.tsx",children:(0,r.jsxs)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"DowngradeModal.tsx",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(e1.J,{type:"warning",title:"Downgrading to the Free Plan will lead to reductions in your organization's quota",description:"If you're already past the limits of the Free Plan, your projects could become unresponsive or enter read only mode.","data-sentry-element":"Admonition","data-sentry-source-file":"DowngradeModal.tsx"}),((null!==(t=d.length)&&void 0!==t?t:0)>0||c&&u)&&(0,r.jsx)(e1.J,{type:"warning",title:"Projects affected by the downgrade",children:(0,r.jsxs)("ul",{className:"space-y-1 max-h-[100px] overflow-y-auto",children:[d.map(e=>(0,r.jsx)(tg,{projectAddon:e},e.ref)),o.filter(e=>"micro"===e.infra_compute_size).map(e=>(0,r.jsxs)("li",{className:"list-disc ml-6",children:[e.name,": Compute will be downgraded. Project will also"," ",(0,r.jsx)("span",{className:"font-bold",children:"need to be restarted"}),"."]},e.ref))]})})]}),(0,r.jsxs)("ul",{className:"mt-4 space-y-5 text-sm",children:[(0,r.jsxs)("li",{className:"flex items-center gap-3",children:[(0,r.jsx)(th.Z,{size:18,"data-sentry-element":"PauseCircle","data-sentry-source-file":"DowngradeModal.tsx"}),(0,r.jsx)("span",{children:"Projects will be paused after a week of inactivity"})]}),(0,r.jsxs)("li",{className:"flex items-center gap-3 mb-2",children:[(0,r.jsx)(tx.Z,{size:18,"data-sentry-element":"MinusCircle","data-sentry-source-file":"DowngradeModal.tsx"}),(0,r.jsx)("span",{children:"Add ons from all projects under this organization will be removed."})]}),(0,r.jsx)("li",{className:"flex gap-3",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("strong",{children:["Before you downgrade to the ",null==n?void 0:n.name," plan, consider:"]}),(0,r.jsxs)("ul",{className:"space-y-2 mt-2",children:[(0,r.jsx)("li",{className:"list-disc ml-6 text-foreground-light",children:"Your projects no longer require their respective add ons."}),(0,r.jsxs)("li",{className:"list-disc ml-6 text-foreground-light",children:["Your resource consumption are well within the ",null==n?void 0:n.name," plan's quota."]}),(0,r.jsx)("li",{className:"list-disc ml-6 text-foreground-light",children:"Alternatively, you may also transfer projects across organizations."})]})]})})]}),(null==s?void 0:s.billing_via_partner)===!0&&"fly"===s.billing_partner&&(0,r.jsx)("p",{className:"mt-4 text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]})})},tf=e=>{let{plan:t,isCurrentPlan:a,billingPartner:n}=e,s=(0,tp.g_)(t,n);return(0,r.jsxs)("div",{className:(0,W.cn)("grid grid-cols-1 md:grid-cols-3 border rounded-md bg-studio","py-4 col-span-12 justify-between gap-x-8"),"data-sentry-component":"EnterpriseCard","data-sentry-source-file":"EnterpriseCard.tsx",children:[(0,r.jsxs)("div",{className:"flex flex-col justify-center px-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:(0,W.cn)("text-brand text-sm uppercase"),children:t.name}),a?(0,r.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):t.nameBadge?(0,r.jsx)("div",{className:"text-xs bg-surface-200 text-brand rounded px-2 py-0.5",children:t.nameBadge}):null]}),(0,r.jsx)("p",{className:"text-sm mt-2 mb-4",children:t.description}),(0,r.jsx)("a",{href:t.href,className:"hidden md:block",target:"_blank",children:(0,r.jsx)(H.z,{block:!0,type:"default",size:"tiny","data-sentry-element":"Button","data-sentry-source-file":"EnterpriseCard.tsx",children:t.cta})})]}),(0,r.jsxs)("div",{className:"flex flex-col justify-center col-span-2 px-4 md:px-0",children:[(0,r.jsx)("ul",{role:"list",className:"text-xs text-foreground-light md:grid md:grid-cols-2 md:gap-x-10",children:s.map(e=>(0,r.jsxs)("li",{className:"flex items-center py-2 first:mt-0",children:[(0,r.jsx)(tt.Z,{className:"text-brand h-4 w-4","aria-hidden":"true",strokeWidth:3}),(0,r.jsx)("span",{className:"text-foreground mb-0 ml-3 ",children:"string"==typeof e?e:e[0]})]},"string"==typeof e?e:e[0]))}),(0,r.jsx)("a",{href:t.href,className:"visible md:hidden mt-8",target:"_blank",children:(0,r.jsx)(H.z,{block:!0,type:"default",size:"tiny","data-sentry-element":"Button","data-sentry-source-file":"EnterpriseCard.tsx",children:t.cta})})]})]},t.id)},tv=a(42876),tj=a.n(tv),tb=a(92238),tS=a.n(tb),tN=a(69916);let tw=["Pricing","My project isn't getting traction","Poor customer service","Missing feature","I didn't see the value","Supabase didn't meet my needs","Dashboard is too complicated","Postgres is too complicated","Problem not solved","Too many bugs/issues","I decided to use something else","My work has finished/discontinued","I’m migrating to/starting a new project","None of the above"];var t_=e=>{let{visible:t,subscription:a,projects:n,onClose:s}=e,{slug:l}=(0,i.UO)(),o=(0,u.useRef)(null),[d,c]=(0,u.useState)(""),[p,h]=(0,u.useState)(null),[x,g]=(0,u.useReducer)(function(e,t){return tj()(e,t.target.value)?tS()(e,t.target.value):[...e,t.target.value]},[]),y=(0,ep.P)("disableProjectCreationAndUpdate"),{mutate:f,isLoading:v}=eS({onError:e=>{_(),m.Am.error("Failed to downgrade project: ".concat(e.message))}}),{mutateAsync:j,isLoading:b}=(0,tN.S)(),S=v||b,N=n.filter(e=>{let t=["nano"];return(null==a?void 0:a.nano_enabled)===!1&&t.push("micro"),!t.includes(e.infra_compute_size)}),w=N.length>0,_=()=>{var e;h(null),null===(e=o.current)||void 0===e||e.resetCaptcha()},C=async()=>{if(0===x.length)return m.Am.error("Please select at least one reason for canceling your subscription");let e=p;if(!e){var t,a;let n=await (null===(t=o.current)||void 0===t?void 0:t.execute({async:!0}));e=null!==(a=null==n?void 0:n.response)&&void 0!==a?a:null,await A()}},A=async()=>{if(!l)return console.error("Slug is required");f({slug:l,tier:"tier_free"},{onSuccess:async()=>{_();try{await j({orgSlug:l,reasons:x.reduce((e,t)=>"".concat(e,"- ").concat(t,"\n"),""),message:d,exitAction:"downgrade"})}catch(e){}finally{m.Am.success(w?"Successfully downgraded organization to the Free Plan. Your projects are currently restarting to update their compute instances.":"Successfully downgraded organization to the Free Plan",{duration:w?8e3:4e3}),s(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"self-center",children:(0,r.jsx)(ek.Z,{ref:o,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onVerify:e=>{h(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>h(null),onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{void 0!==document&&document.body.classList.remove("!pointer-events-auto")},"data-sentry-element":"HCaptcha","data-sentry-source-file":"ExitSurveyModal.tsx"})}),(0,r.jsxs)(eP.Z,{hideFooter:!0,size:"xlarge",visible:t,onCancel:s,header:"Help us improve.","data-sentry-element":"Modal","data-sentry-source-file":"ExitSurveyModal.tsx",children:[(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"ExitSurveyModal.tsx",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"We always strive to improve Supabase as much as we can. Please let us know the reasons you are canceling your subscription so that we can improve in the future."}),(0,r.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:tw.map(e=>{let t=x.find(t=>t===e);return(0,r.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(t?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,r.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:g}),(0,r.jsx)("div",{children:e})]},e)})}),(0,r.jsx)("div",{className:"text-area-text-sm",children:(0,r.jsx)(M.Z.TextArea,{id:"message",name:"message",value:d,onChange:e=>c(e.target.value),label:"Anything else that we can improve on?","data-sentry-element":"unknown","data-sentry-source-file":"ExitSurveyModal.tsx"})})]}),w&&(0,r.jsxs)(eg.b,{withIcon:!0,variant:"warning",title:"".concat(N.length," of your projects will be restarted upon clicking confirm,"),children:["This is due to changes in compute instances from the downgrade. Affected projects include ",N.map(e=>e.name).join(", "),"."]})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between border-t px-4 py-4",children:[(0,r.jsx)("p",{className:"text-xs text-foreground-lighter",children:"The unused amount for the remaining time of your billing cycle will be refunded as credits"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(H.z,{type:"default",onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"ExitSurveyModal.tsx",children:"Cancel"}),(0,r.jsx)(ey.Z,{projectUpdateDisabled:y,"data-sentry-element":"ProjectUpdateDisabledTooltip","data-sentry-source-file":"ExitSurveyModal.tsx",children:(0,r.jsx)(H.z,{type:"danger",className:"pointer-events-auto",loading:S,disabled:y||S,onClick:C,"data-sentry-element":"Button","data-sentry-source-file":"ExitSurveyModal.tsx",children:"Confirm downgrade"})})]})]})]})]})},tC=e=>{let{visible:t,onClose:a}=e,n=(0,k.l)(),s=null==n?void 0:n.slug,{data:i}=(0,ti.u)({slug:s});return(0,r.jsxs)(eP.Z,{hideFooter:!0,visible:t,size:"medium",header:"Your organization has members who have exceeded their free project limits",onCancel:a,"data-sentry-element":"Modal","data-sentry-component":"MembersExceedLimitModal","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:[(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"The following members have reached their maximum limits for the number of active free plan projects within organizations where they are an administrator or owner:"}),(0,r.jsx)("ul",{className:"pl-5 text-sm list-disc text-foreground-light",children:(i||[]).map((e,t)=>(0,r.jsxs)("li",{children:[e.username||e.primary_email," (Limit: ",e.free_project_limit," free projects)"]},"member-".concat(t)))}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"These members will need to either delete, pause, or upgrade one or more of these projects before you're able to downgrade this project."})]})}),(0,r.jsx)(eP.Z.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"MembersExceedLimitModal.tsx"}),(0,r.jsx)(eP.Z.Content,{className:"flex items-center gap-2","data-sentry-element":"unknown","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:(0,r.jsx)(H.z,{htmlType:"button",type:"default",onClick:a,block:!0,"data-sentry-element":"Button","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:"Understood"})})]})},tA=a(13948),tI=a(53445),tT=a(71794),tk=e=>{let{selectedPaymentMethod:t,onSelectPaymentMethod:a,layout:n="vertical"}=e,s=(0,k.l)(),i=null==s?void 0:s.slug,[l,o]=(0,u.useState)(!1),{data:d,isLoading:p,refetch:h}=eV({slug:i}),x=(0,S.Xo)(c.KA.BILLING_WRITE,"stripe.payment_methods");return(0,u.useEffect)(()=>{if((null==d?void 0:d.data)&&d.data.length>0){let e=d.data.some(e=>e.id===t);if(!t||!e){let e=d.data.find(e=>e.is_default);void 0!==e?a(e.id):a(d.data[0].id)}}},[t,d,a]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:p?(0,r.jsxs)("div",{className:"flex items-center px-4 py-2 space-x-4 border rounded-md border-strong bg-surface-200",children:[(0,r.jsx)(tI.Z,{className:"animate-spin",size:14}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Retrieving payment methods"})]}):(null==d?void 0:d.data.length)===0?(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border border-dashed rounded-md bg-alternative",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-foreground-light",children:[(0,r.jsx)(tT.Z,{size:16,strokeWidth:1.5}),(0,r.jsx)("p",{className:"text-sm",children:"No saved payment methods"})]}),(0,r.jsxs)(tA.fC,{delayDuration:0,children:[(0,r.jsx)(tA.xz,{asChild:!0,children:(0,r.jsx)(H.z,{type:"default",disabled:!x,icon:(0,r.jsx)(eq.Z,{}),onClick:()=>o(!0),htmlType:"button",children:"Add new"})}),!x&&(0,r.jsx)(tA.h_,{children:(0,r.jsxs)(tA.VY,{side:"bottom",children:[(0,r.jsx)(tA.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-48 border border-background text-center",children:(0,r.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to add new payment methods to this organization"})})]})})]})]}):(0,r.jsxs)(P.Z,{layout:n,label:"Payment method",value:t,onChange:a,className:"flex items-center",children:[null==d?void 0:d.data.map(e=>{let t="•••• •••• •••• ".concat(e.card.last4);return(0,r.jsx)(P.Z.Option,{label:t,value:e.id,addOnBefore:()=>(0,r.jsx)("img",{alt:"Credit Card Brand",src:"".concat(eh.GW,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),children:(0,r.jsx)("div",{children:t})},e.id)}),(0,r.jsxs)("div",{className:"flex items-center px-3 py-2 space-x-2 transition cursor-pointer group hover:bg-surface-300",onClick:()=>o(!0),children:[(0,r.jsx)(eH.Z,{size:16}),(0,r.jsx)("p",{className:"transition text-foreground-light group-hover:text-foreground",children:"Add new payment method"})]})]})}),(0,r.jsx)(eG,{visible:l,returnUrl:"".concat((0,V.Ax)(),"/org/").concat(null==s?void 0:s.slug,"/billing?panel=subscriptionPlan"),onCancel:()=>o(!1),autoMarkAsDefaultPaymentMethod:!0,onConfirm:async()=>{var e;o(!1),m.Am.success("Successfully added new payment method");let{data:t}=await h();(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.length)&&a((null==t?void 0:t.data.reduce((e,t)=>e.created>t.created?e:t,t.data[0])).id)},"data-sentry-element":"AddNewPaymentMethodModal","data-sentry-source-file":"PaymentMethodSelection.tsx"})]})};async function tE(e){let{orgSlug:t,prevPlan:a,currentPlan:n,reasons:s,message:r}=e,{data:i,error:l}=await (0,b.v_)("/platform/feedback/upgrade",{body:{...void 0!==t&&{orgSlug:t},...void 0!==a&&{prevPlan:a},...void 0!==n&&{currentPlan:n},reasons:s,...void 0!==r&&{additionalFeedback:r}}});return l&&(0,b.S3)(l),i}let tM=function(){let{onError:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,A.D)(e=>tE(e),{async onError(t,a,n){void 0===e?m.Am.error("Failed to submit upgrade survey: ".concat(t.message)):e(t,a,n)},...t})};var tP=e=>{let{visible:t,originalPlan:a,subscription:n,onClose:s}=e,{slug:l}=(0,i.UO)(),[o,d]=(0,u.useState)(""),[c,p]=(0,u.useReducer)(function(e,t){return tj()(e,t.target.value)?tS()(e,t.target.value):[...e,t.target.value]},[]),h=et(a,null==n?void 0:n.plan.id),{mutate:x,isLoading:g}=tM({onError:e=>{m.Am.error("Failed to submit survey: ".concat(e.message))},onSuccess:()=>{s(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}),y=async()=>{var e;if(0===c.length)return m.Am.error("Please select at least one reason for upgrading your subscription");x({orgSlug:l,prevPlan:a,currentPlan:null==n?void 0:null===(e=n.plan)||void 0===e?void 0:e.id,reasons:c,message:o.trim()||void 0})};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(eP.Z,{alignFooter:"right",size:"xlarge",loading:g,visible:t,onCancel:s,onConfirm:y,cancelText:"Skip",header:"We're excited for your upgrade","data-sentry-element":"Modal","data-sentry-source-file":"UpgradeModal.tsx",children:(0,r.jsxs)(eP.Z.Content,{className:"space-y-4","data-sentry-element":"unknown","data-sentry-source-file":"UpgradeModal.tsx",children:[(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"What reasons motivated your decision to upgrade? Your feedback helps us improve Supabase as much as we can."}),(0,r.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:h.map(e=>{let t=c.find(t=>t===e);return(0,r.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(t?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,r.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:p}),(0,r.jsx)("div",{children:e})]},e)})}),(0,r.jsx)("div",{className:"text-area-text-sm",children:(0,r.jsx)(M.Z.TextArea,{id:"message",name:"message",value:o,onChange:e=>d(e.target.value),label:"Anything else that we can improve on?","data-sentry-element":"unknown","data-sentry-source-file":"UpgradeModal.tsx"})})]})]})})})},tR=()=>{var e,t,a,n;let s=(0,ta.useRouter)(),i=(0,k.l)(),l=null==i?void 0:i.slug,o=(0,C.NL)(),h=(0,u.useRef)(),x=(0,ep.P)("allowOrioleDb"),[g,y]=(0,u.useState)(!1),[f,j]=(0,u.useState)(!1),[b,w]=(0,u.useState)(),[_,A]=(0,u.useState)(!1),[I,T]=(0,u.useState)(),[E,M]=(0,u.useState)([]),P=(0,S.Xo)(c.KA.BILLING_WRITE,"stripe.subscriptions"),{data:R}=(0,tc.Sy)(),z=(R||[]).filter(e=>e.organization_id===(null==i?void 0:i.id)),{data:Z}=(0,td.Tk)({slug:l},{enabled:x}),D=!x&&!!(null==Z?void 0:Z.has_oriole_project),O=(0,ex.Wu)(),F="subscriptionPlan"===O.panelKey,G=()=>{let{panel:e,...t}=s.query;s.push({pathname:s.pathname,query:t},void 0,{shallow:!0}),O.setPanelKey(void 0)},{data:Y,isSuccess:q}=(0,d.Gl)({orgSlug:l}),{data:X,isLoading:K}=tm({orgSlug:l}),{data:Q}=(0,ti.u)({slug:l}),{mutate:J,isLoading:$}=eS({onSuccess:()=>{m.Am.success("Successfully updated subscription to ".concat(null==ec?void 0:ec.name,"!")),T(void 0),G(),window.scrollTo({top:0,left:0,behavior:"smooth"}),(null==ey?void 0:ey.change_type)==="upgrade"&&j(!0)},onError:e=>{m.Am.error("Unable to update subscription: ".concat(e.message))}}),ee=(null==Y?void 0:Y.billing_via_partner)===!0,et=null==Y?void 0:Y.billing_partner,ea=(null==Y?void 0:Y.payment_method_type)==="invoice",{data:en,error:es,isLoading:er,isSuccess:ei}=to({tier:I,organizationSlug:l}),el=null!==(a=null==X?void 0:X.plans)&&void 0!==a?a:[],eo=(Q||[]).length>0&&z.filter(e=>"INACTIVE"!==e.status&&"GOING_DOWN"!==e.status).length>0,ec=tp.z5.find(e=>e.id===I),eu=e=>{M([...E,e])},em=e=>{M(E.filter(t=>t!==e))};(0,u.useEffect)(()=>{F&&T(void 0)},[F]),(0,u.useEffect)(()=>{F&&q&&(h.current=Y.plan.id)},[F,q]);let eg=async()=>{var e;return l?I?b||ea?void(b&&o.setQueriesData(N.O.paymentMethods(l),e=>e?{...e,defaultPaymentMethodId:b,data:e.data.map(e=>({...e,is_default:e.id===b}))}:e),J({slug:l,tier:(null==Y?void 0:null===(e=Y.plan)||void 0===e?void 0:e.id)==="team"&&I===eh.ev.PRO?eh.ev.PAYG:I,paymentMethod:b})):m.Am.error("Please select a payment method"):console.error("Selected plan is required"):console.error("org slug is required")},ey=I?el.find(e=>e.id===I.split("tier_")[1]):null;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ew.ZP,{hideFooter:!0,size:"xxlarge",visible:F,onCancel:()=>G(),header:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h4",{children:["Change subscription plan for ",null==i?void 0:i.name]}),(0,r.jsx)(H.z,{asChild:!0,type:"default",icon:(0,r.jsx)(ed.Z,{}),children:(0,r.jsx)("a",{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:"Pricing"})})]}),"data-sentry-element":"SidePanel","data-sentry-source-file":"PlanUpdateSidePanel.tsx",children:(0,r.jsx)(ew.ZP.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"PlanUpdateSidePanel.tsx",children:(0,r.jsx)("div",{className:"py-6 grid grid-cols-12 gap-3",children:tp.z5.map(e=>{var t,a,n,s;let i=el.find(t=>t.id===e.id.split("tier_")[1]),l=null!==(s=null==i?void 0:i.price)&&void 0!==s?s:0,o=(null==i?void 0:i.change_type)==="downgrade",d=(null==i?void 0:i.id)===(null==Y?void 0:null===(t=Y.plan)||void 0===t?void 0:t.id),c=(0,tp.g_)(e,et),u=(0,tp.nq)(e,et);return"tier_enterprise"===e.id?(0,r.jsx)(tf,{plan:e,isCurrentPlan:d,billingPartner:et},e.id):(0,r.jsxs)("div",{className:(0,W.cn)("px-4 py-4 flex flex-col items-start justify-between","border rounded-md col-span-12 md:col-span-4 bg-surface-200"),children:[(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-brand text-sm uppercase",children:e.name}),d?(0,r.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):e.nameBadge?(0,r.jsx)("div",{className:"text-xs bg-brand-400 text-brand-600 rounded px-2 py-0.5",children:e.nameBadge}):null]}),(0,r.jsxs)("div",{className:"mt-4 flex items-center space-x-1 mb-4",children:[(null!=l?l:0)>0&&(0,r.jsx)("p",{className:"text-foreground-light text-sm",children:"From"}),K?(0,r.jsx)("div",{className:"h-[28px] flex items-center justify-center",children:(0,r.jsx)(v.Z,{className:"w-[30px] h-[24px]"})}):(0,r.jsx)("p",{className:"text-foreground text-lg",children:(0,V.xG)(l)}),(0,r.jsx)("p",{className:"text-foreground-light text-sm",children:e.costUnit})]}),d?(0,r.jsx)(H.z,{block:!0,disabled:!0,type:"default",children:"Current plan"}):(0,r.jsxs)(ts.u,{block:!0,type:o?"default":"primary",disabled:(null==Y?void 0:null===(a=Y.plan)||void 0===a?void 0:a.id)==="enterprise"||D||!P,onClick:()=>T(e.id),tooltip:{content:{side:"bottom",className:D?"w-96 text-center":"",text:(null==Y?void 0:null===(n=Y.plan)||void 0===n?void 0:n.id)==="enterprise"?"Reach out to us via support to update your plan from Enterprise":D?"Your organization has projects that are using the OrioleDB extension which is only available on the Free plan. Remove all OrioleDB projects before changing your plan.":P?void 0:"You do not have permission to change the subscription plan"}},children:[o?"Downgrade":"Upgrade"," to ",e.name]}),(0,r.jsx)("div",{className:"border-t my-4"}),(0,r.jsx)("ul",{role:"list",children:c.map(e=>(0,r.jsxs)("li",{className:"flex py-2",children:[(0,r.jsx)("div",{className:"w-[12px]",children:(0,r.jsx)(tt.Z,{className:"h-3 w-3 text-brand translate-y-[2.5px]","aria-hidden":"true",strokeWidth:3})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"ml-3 text-xs text-foreground-light",children:"string"==typeof e?e:e[0]}),te()(e)&&(0,r.jsx)("p",{className:"ml-3 text-xs text-foreground-lighter",children:e[1]})]})]},"string"==typeof e?e:e[0]))})]}),u&&(0,r.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,r.jsx)("p",{className:"text-foreground-light text-xs",children:u})})]},e.id)})})})}),(0,r.jsx)(ty,{visible:"tier_free"===I,selectedPlan:ec,subscription:Y,onClose:()=>T(void 0),onConfirm:()=>{T(void 0),eo?A(!0):y(!0)},projects:z,"data-sentry-element":"DowngradeModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,r.jsxs)(eP.Z,{loading:$,alignFooter:"right",size:"xlarge",visible:void 0!==I&&"tier_free"!==I,onCancel:()=>T(void 0),onConfirm:eg,dialogOverlayProps:{className:"pointer-events-none"},header:"Confirm ".concat((null==ey?void 0:ey.change_type)==="downgrade"?"downgrade":"upgrade"," to ").concat(null==ec?void 0:ec.name),"data-sentry-element":"Modal","data-sentry-source-file":"PlanUpdateSidePanel.tsx",children:[(0,r.jsxs)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"PlanUpdateSidePanel.tsx",children:[es&&(0,r.jsx)(p.Z,{error:es,subject:"Failed to preview subscription."}),er&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("span",{className:"text-sm",children:"Estimating monthly costs..."}),(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),ei&&(0,r.jsxs)("div",{children:[(0,r.jsx)(ef.Z,{className:"mt-2",borderless:!0,head:[(0,r.jsx)(ef.Z.th,{children:"Item"},"header-item"),(0,r.jsx)(ef.Z.th,{className:"text-right pr-4",children:"Usage"},"header-count"),(0,r.jsx)(ef.Z.th,{children:"Unit Price"},"header-unit-price"),(0,r.jsx)(ef.Z.th,{className:"text-right",children:"Cost"},"header-price")],body:(0,r.jsxs)(r.Fragment,{children:[en.breakdown.map(e=>{var t,a;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(ef.Z.tr,{children:[(0,r.jsxs)(ef.Z.td,{children:[e.breakdown&&e.breakdown.length>0&&(0,r.jsx)(H.z,{type:"text",className:"!pl-0 !pr-1",icon:(0,r.jsx)(U.Z,{className:(0,W.cn)("transition",E.includes(e.description)&&"rotate-90")}),onClick:()=>E.includes(e.description)?em(e.description):eu(e.description)}),null!==(a=e.description)&&void 0!==a?a:"Unknown"," ",e.description.endsWith("Compute")&&" (Hours)"]}),(0,r.jsx)(ef.Z.td,{className:"text-right pr-4 tabular-nums",children:null===(t=e.quantity)||void 0===t?void 0:t.toLocaleString()}),(0,r.jsx)(ef.Z.td,{children:e.unit_price_desc?e.unit_price_desc:0===e.unit_price?"FREE":e.unit_price?"".concat((0,V.xG)(e.unit_price)):""}),(0,r.jsx)(ef.Z.td,{className:"text-right",children:(0,V.xG)(e.total_price)})]},e.description),E.includes(e.description)&&e.breakdown&&e.breakdown.length>0&&e.breakdown.map(e=>(0,r.jsxs)(ef.Z.tr,{children:[(0,r.jsx)(ef.Z.td,{className:"!pl-12",children:e.project_name}),(0,r.jsx)(ef.Z.td,{className:"text-right pr-4 tabular-nums",children:e.usage}),(0,r.jsx)(ef.Z.td,{}),(0,r.jsx)(ef.Z.td,{})]},e.project_ref))]})}),(0,r.jsxs)(ef.Z.tr,{children:[(0,r.jsx)(ef.Z.td,{className:"font-medium",children:"Monthly Costs (excluding over-usage and credits)"}),(0,r.jsx)(ef.Z.td,{}),(0,r.jsx)(ef.Z.td,{}),(0,r.jsx)(ef.Z.td,{className:"text-right font-medium",children:(0,V.xG)(null!==(n=Math.round(en.breakdown.reduce((e,t)=>e+t.total_price,0)))&&void 0!==n?n:0)})]})]})}),(0,r.jsx)(tr.Z,{className:"mt-4",title:"Usage-billing for Compute",icon:(0,r.jsx)(B.Z,{}),defaultVisibility:!0,hideCollapse:!0,description:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm mt-2",children:"Each project is a dedicated server and database. Paid plans come with $10 of Compute Credits to cover one project on the default Micro Compute size or parts of any compute addon. Additional unpaused projects on paid plans will incur compute usage costs starting at $10 per month, billed hourly."}),(null==Y?void 0:null===(e=Y.plan)||void 0===e?void 0:e.id)==="free"&&(0,r.jsx)("p",{className:"text-sm mt-2",children:"Mixing paid and non-paid projects in a single organization is not possible. If you want projects to be on the Free Plan, use self-serve project transfers."}),(0,r.jsxs)("div",{className:"space-x-3 mt-2",children:[(0,r.jsx)(H.z,{asChild:!0,type:"default",icon:(0,r.jsx)(ed.Z,{strokeWidth:1.5}),children:(0,r.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",children:"How billing works"})}),(null==Y?void 0:null===(t=Y.plan)||void 0===t?void 0:t.id)==="free"&&(0,r.jsx)(H.z,{asChild:!0,type:"default",icon:(0,r.jsx)(ed.Z,{strokeWidth:1.5}),children:(0,r.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/project-transfer",target:"_blank",rel:"noreferrer",children:"Project transfers"})})]})]})})]})]}),(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"PlanUpdateSidePanel.tsx",children:ee?(0,r.jsxs)("div",{className:"py-4 space-y-2",children:[(0,r.jsxs)("p",{className:"text-sm",children:["This organization is billed through our partner"," ",(0,tn.Gh)(et),"."," ","aws"===et?(0,r.jsx)(r.Fragment,{children:"The organization's credit balance will be decreased accordingly."}):(0,r.jsx)(r.Fragment,{children:"You will be charged by them directly."})]}),ee&&"fly"===et&&(null==en?void 0:en.plan_change_type)==="downgrade"&&(0,r.jsx)("p",{className:"text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]}):(0,r.jsxs)("div",{className:"py-4 space-y-2",children:[(0,r.jsx)("p",{className:"text-sm",children:"Upon clicking confirm, your monthly invoice will be adjusted and your credit card will be charged immediately. Changing the plan resets your billing cycle and may result in a prorated charge for previous usage."}),(0,r.jsx)("div",{className:"!mt-4",children:(0,r.jsx)(tk,{selectedPaymentMethod:b,onSelectPaymentMethod:w})})]})})]}),(0,r.jsx)(tC,{visible:_,onClose:()=>A(!1),"data-sentry-element":"MembersExceedLimitModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,r.jsx)(t_,{visible:g,subscription:Y,projects:z,onClose:e=>{y(!1),e&&G()},"data-sentry-element":"ExitSurveyModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,r.jsx)(tP,{visible:f,originalPlan:h.current,subscription:Y,onClose:e=>{j(!1),e&&G()},"data-sentry-element":"UpgradeSurveyModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"})]})},tz=()=>{var e,t,a,n,s;let{slug:o}=(0,i.UO)(),u=(0,ex.Wu)(),m=(0,ep.P)("disableProjectCreationAndUpdate"),h=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:x,error:g,isLoading:f,isError:j,isSuccess:b}=(0,d.Gl)({orgSlug:o},{enabled:h}),N=null==x?void 0:x.plan,w=null!==(e=null==N?void 0:N.name)&&void 0!==e?e:"Unknown",_=D().unix(null!==(t=null==x?void 0:x.current_period_start)&&void 0!==t?t:0).utc(),C=D().unix(null!==(a=null==x?void 0:x.current_period_end)&&void 0!==a?a:0).utc(),A=C.diff(D()(),"days"),I=C.diff(_,"days"),T=!m&&!["enterprise"].includes(null!==(n=null==N?void 0:N.id)&&void 0!==n?n:"");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"Subscription.tsx",children:[(0,r.jsx)("div",{className:"col-span-12 pb-2",children:(0,r.jsx)(e7,{"data-sentry-element":"Restriction","data-sentry-source-file":"Subscription.tsx"})}),(0,r.jsx)(l.g$,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"Subscription.tsx",children:(0,r.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,r.jsx)("p",{className:"text-foreground text-base m-0",children:"Subscription Plan"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,r.jsx)("div",{children:(0,r.jsx)(L(),{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer","data-sentry-element":"Link","data-sentry-source-file":"Subscription.tsx",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,r.jsx)("p",{className:"text-sm m-0",children:"Pricing"}),(0,r.jsx)(ed.Z,{size:16,strokeWidth:1.5,"data-sentry-element":"ExternalLink","data-sentry-source-file":"Subscription.tsx"})]})})})]})]})}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"Subscription.tsx",children:h?(0,r.jsxs)(r.Fragment,{children:[f&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),j&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:g}),b&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm",children:"This organization is currently on the plan:"}),(0,r.jsx)("p",{className:"text-2xl text-brand uppercase",children:null!==(s=null==N?void 0:N.name)&&void 0!==s?s:"Unknown"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(ey.Z,{projectUpdateDisabled:m,children:(0,r.jsx)(H.z,{type:"default",className:"pointer-events-auto",disabled:!T,onClick:()=>u.setPanelKey("subscriptionPlan"),children:"Change subscription plan"})}),!T&&(m?(0,r.jsx)(eg.b,{className:"mt-2",withIcon:!0,variant:"info",title:"Unable to update plan from ".concat(w),children:"We have temporarily disabled project and subscription changes - our engineers are working on a fix."}):(0,r.jsx)(eg.b,{withIcon:!0,className:"mt-2",variant:"info",title:"Unable to update plan from ".concat(w),actions:[(0,r.jsx)("div",{children:(0,r.jsx)(H.z,{asChild:!0,type:"default",children:(0,r.jsx)(L(),{href:"/support/new?category=sales&subject=Change%20plan%20away%20from%20".concat(w),children:"Contact support"})})},"contact-support")],children:"Please contact us if you'd like to change your plan."}))]}),!(null==x?void 0:x.usage_billing_enabled)&&(0,r.jsxs)(e1.J,{type:"default",title:"This organization is limited by the included usage",children:[(0,r.jsxs)("div",{className:"[&>p]:!leading-normal prose text-sm",children:["Projects may become unresponsive when this organization exceeds its"," ",(0,r.jsx)(L(),{href:"/org/".concat(o,"/usage"),children:"included usage quota"}),". To scale seamlessly and pay for over-usage,"," ",(null==N?void 0:N.id)==="free"?"upgrade to a paid plan.":"you can disable Spend Cap under the Cost Control settings."]}),(0,r.jsx)(H.z,{type:"default",className:"mt-1",onClick:()=>u.setPanelKey((null==N?void 0:N.id)==="free"?"subscriptionPlan":"costControl"),children:(null==N?void 0:N.id)==="free"?"Upgrade Plan":"Adjust Spend Cap"})]}),(0,r.jsx)(e5.Z,{type:"horizontal",value:I-A,max:I,barClass:"bg-foreground",labelBottom:"Current billing cycle (".concat(_.format("MMM DD")," - ").concat(C.format("MMM DD"),")"),bgClass:"bg-surface-300",labelBottomClass:"!text-foreground-light pb-1",labelTop:"".concat(A," days remaining")})]})]}):(0,r.jsx)(y.Z,{resourceText:"view this organization's subscription"})})]}),(0,r.jsx)(tR,{"data-sentry-element":"PlanUpdateSidePanel","data-sentry-source-file":"Subscription.tsx"})]})},tZ=a(78751),tD=a(86848),tO=a(5394),tL=a(73119);async function tU(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let{data:n,error:s}=await (0,b.U2)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:a}},signal:t,headers:{Version:"2"}});if(s)throw(0,b.S3)(s);return n.tax_id}let tB=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,S.Xo)(c.KA.BILLING_READ,"stripe.tax_ids");return(0,j.a)(N.O.taxId(t),e=>{let{signal:a}=e;return tU({slug:t},a)},{enabled:a&&void 0!==t&&s,...n})};async function tF(e){let{slug:t,taxId:a}=e;if(!t)throw Error("Slug is required");if(null!=a){let{data:e,error:n}=await (0,b.gz)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:t}},body:{type:a.type,value:a.value,country:a.country}});return n&&(0,b.S3)(n),e}{let{data:e,error:a}=await (0,b.IV)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:t}},headers:{Version:"2"}});return a&&(0,b.S3)(a),e}}let tG=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>tF(e),{async onSuccess(t,a,s){let{slug:r}=a;n.setQueryData(N.O.taxId(r),t.tax_id),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to update tax id: ".concat(e.message)):t(e,a,n)},...a})};var tY=a(40241),tV=a(84629),tH=a(40347);let tq=[{name:"AE TRN",type:"ae_trn",country:"United Arab Emirates",placeholder:"123456789012345",countryIso2:"AE"},{name:"AT VAT",type:"eu_vat",country:"Austria",placeholder:"ATU12345678",vatPrefix:"ATU",countryIso2:"AT"},{name:"AD NRT",type:"ad_nrt",country:"Andorra",placeholder:"A-123456-Z",countryIso2:"AD"},{name:"AR CUIT",type:"ar_cuit",country:"Argentina",placeholder:"12-3456789-01",countryIso2:"AR"},{name:"AU ABN",type:"au_abn",country:"Australia",placeholder:"12345678912",countryIso2:"AU"},{name:"AU ARN",type:"au_arn",country:"Australia",placeholder:"123456789123",countryIso2:"AU"},{name:"BE VAT",type:"eu_vat",country:"Belgium",placeholder:"BE0123456789",vatPrefix:"BE",countryIso2:"BE"},{name:"BO TIN",type:"bo_tin",country:"Bolivia",placeholder:"123456789",countryIso2:"BO"},{name:"BG VAT",type:"eu_vat",country:"Bulgaria",placeholder:"BG0123456789",vatPrefix:"BG",countryIso2:"BG"},{name:"BR CNPJ",type:"br_cnpj",country:"Brazil",placeholder:"01.234.456/5432-10",countryIso2:"BR"},{name:"BR CPF",type:"br_cpf",country:"Brazil",placeholder:"123.456.789-87",countryIso2:"BR"},{name:"CA BN",type:"ca_bn",country:"Canada",placeholder:"123456789",countryIso2:"CA"},{name:"CA GST/HST",type:"ca_gst_hst",country:"Canada",placeholder:"123456789RT0002",countryIso2:"CA"},{name:"CA PST-BC",type:"ca_pst_bc",country:"Canada",placeholder:"PST-1234-5678",countryIso2:"CA"},{name:"CA PST-MB",type:"ca_pst_mb",country:"Canada",placeholder:"123456-7",countryIso2:"CA"},{name:"CA PST-SK",type:"ca_pst_mb",country:"Canada",placeholder:"1234567",countryIso2:"CA"},{name:"CA QST",type:"ca_qst",country:"Canada",placeholder:"1234567890TQ1234",countryIso2:"CA"},{name:"CH VAT",type:"ch_vat",country:"Switzerland",placeholder:"CHE-123.456.789 MWST",vatPrefix:"CHE",countryIso2:"CH"},{name:"CL TIN",type:"cl_tin",country:"Chile",placeholder:"12.345.678-K",countryIso2:"CL"},{name:"CN TIN",type:"cn_tin",country:"China",placeholder:"123456789012345678",countryIso2:"CN"},{name:"CO NIT",type:"co_nit",country:"Colombia",placeholder:"123.456.789-0",countryIso2:"CO"},{name:"CR TIN",type:"cr_tin",country:"Costa Rica",placeholder:"1-234-567890",countryIso2:"CR"},{name:"CY VAT",type:"eu_vat",country:"Cyprus",placeholder:"CY12345678Z",vatPrefix:"CY",countryIso2:"CY"},{name:"CZ VAT",type:"eu_vat",country:"Czech Republic",placeholder:"CZ1234567890",vatPrefix:"CZ",countryIso2:"CZ"},{name:"DE VAT",type:"eu_vat",country:"Germany",placeholder:"DE123456789",vatPrefix:"DE",countryIso2:"DE"},{name:"DK VAT",type:"eu_vat",country:"Denmark",placeholder:"DK12345678",vatPrefix:"DK",countryIso2:"DK"},{name:"DO RCN",type:"do_rcn",country:"Dominican Republic",placeholder:"123-4567890-1",countryIso2:"DO"},{name:"EE VAT",type:"eu_vat",country:"Estonia",placeholder:"EE123456789",vatPrefix:"EE",countryIso2:"EE"},{name:"ES CIF",type:"es_cif",country:"Spain",placeholder:"A12345678",countryIso2:"ES"},{name:"ES VAT",type:"eu_vat",country:"Spain",placeholder:"ESX1234567Z",vatPrefix:"ES",countryIso2:"ES"},{name:"FI VAT",type:"eu_vat",country:"Finland",placeholder:"FI12345678",vatPrefix:"FI",countryIso2:"FI"},{name:"FR VAT",type:"eu_vat",country:"France",placeholder:"FRAB123456789",vatPrefix:"FR",countryIso2:"FR"},{name:"GB VAT",type:"eu_vat",country:"United Kingdom",placeholder:"GB123456789",vatPrefix:"GB",countryIso2:"GB"},{name:"GE VAT",type:"ge_vat",country:"Georgia",placeholder:"123456789",countryIso2:"GE"},{name:"EL VAT",type:"eu_vat",country:"Greece",countryIso2:"GR",placeholder:"EL123456789",vatPrefix:"EL"},{name:"HK BR",type:"hk_br",country:"Hong Kong SAR China",placeholder:"12345678",countryIso2:"HK"},{name:"HR VAT",type:"eu_vat",country:"Croatia",placeholder:"HR12345678912",vatPrefix:"HR",countryIso2:"HR"},{name:"HU VAT",type:"eu_vat",country:"Hungary",placeholder:"HU12345678912",vatPrefix:"HU",countryIso2:"HU"},{name:"ID NPWP",type:"id_npwp",country:"Indonesia",placeholder:"12.345.678.9-012.345",countryIso2:"ID"},{name:"IE VAT",type:"eu_vat",country:"Ireland",placeholder:"IE1234567AB",vatPrefix:"IE",countryIso2:"IE"},{name:"IL VAT",type:"il_vat",country:"Israel",placeholder:"000012345",countryIso2:"IL"},{name:"IN GST",type:"in_gst",country:"India",placeholder:"12ABCDE3456FGZH",countryIso2:"IN"},{name:"IS VAT",type:"is_vat",country:"Iceland",placeholder:"123456",countryIso2:"IS"},{name:"IT VAT",type:"eu_vat",country:"Italy",placeholder:"IT12345678912",vatPrefix:"IT",countryIso2:"IT"},{name:"JP CN",type:"jp_cn",country:"Japan",placeholder:"1234567891234",countryIso2:"JP"},{name:"KE PIN",type:"ke_pin",country:"Kenya",placeholder:"P000111111A",countryIso2:"KE"},{name:"JP RN",type:"jp_rn",country:"Japan",placeholder:"12345",countryIso2:"JP"},{name:"KR BRN",type:"kr_brn",country:"Korea",placeholder:"123-45-67890",countryIso2:"KR"},{name:"LI UID",type:"li_uid",country:"Liechtenstein",placeholder:"CHE123456789",countryIso2:"LI"},{name:"LT VAT",type:"eu_vat",country:"Lithuania",placeholder:"LT123456789123",vatPrefix:"LT",countryIso2:"LT"},{name:"LU VAT",type:"eu_vat",country:"Luxembourg",placeholder:"LU12345678",vatPrefix:"LU",countryIso2:"LU"},{name:"LV VAT",type:"eu_vat",country:"Latvia",placeholder:"LV12345678912",vatPrefix:"LV",countryIso2:"LV"},{name:"MT VAT",type:"eu_vat",country:"Malta",placeholder:"MT12345678",vatPrefix:"MT",countryIso2:"MT"},{name:"MX RFC",type:"mx_rfc",country:"Mexico",placeholder:"ABC010203AB9",countryIso2:"MX"},{name:"MY FRP",type:"my_frp",country:"Malaysia",placeholder:"12345678",countryIso2:"MY"},{name:"MY ITN",type:"my_itn",country:"Malaysia",placeholder:"C 1234567890",countryIso2:"MY"},{name:"MY SST",type:"my_sst",country:"Malaysia",placeholder:"A12-3456-78912345",countryIso2:"MY"},{name:"NL VAT",type:"eu_vat",country:"Netherlands",placeholder:"NL123456789B12",vatPrefix:"NL",countryIso2:"NL"},{name:"NO VAT",type:"no_vat",country:"Norway",placeholder:"123456789MVA",countryIso2:"NO"},{name:"PE RUC",type:"pe_ruc",country:"Peru",placeholder:"12345678901",countryIso2:"PE"},{name:"PH TIN",type:"ph_tin",country:"Philippines",placeholder:"123456789012",countryIso2:"PH"},{name:"NZ GST",type:"nz_gst",country:"New Zealand",placeholder:"123456789",countryIso2:"NZ"},{name:"PL VAT",type:"eu_vat",country:"Poland",placeholder:"PL1234567890",vatPrefix:"PL",countryIso2:"PL"},{name:"PT VAT",type:"eu_vat",country:"Portugal",placeholder:"PT123456789",vatPrefix:"PT",countryIso2:"PT"},{name:"RO VAT",type:"eu_vat",country:"Romania",placeholder:"RO1234567891",vatPrefix:"RO",countryIso2:"RO"},{name:"RU INN",type:"ru_inn",country:"Russia",placeholder:"1234567891",countryIso2:"RU"},{name:"RU KPP",type:"ru_kpp",country:"Russia",placeholder:"123456789",countryIso2:"RU"},{name:"SA VAT",type:"sa_vat",country:"Saudi Arabia",placeholder:"123456789012345",countryIso2:"SA"},{name:"RS PIB",type:"rs_pib",country:"Serbia",placeholder:"123456789",countryIso2:"RS"},{name:"SE VAT",type:"eu_vat",country:"Sweden",placeholder:"SE123456789123",vatPrefix:"SE",countryIso2:"SE"},{name:"SG GST",type:"sg_gst",country:"Singapore",placeholder:"M12345678X",countryIso2:"SG"},{name:"SG UEN",type:"sg_uen",country:"Singapore",placeholder:"123456789F",countryIso2:"SG"},{name:"SI VAT",type:"eu_vat",country:"Slovenia",placeholder:"SI12345678",vatPrefix:"SI",countryIso2:"SI"},{name:"SK VAT",type:"eu_vat",country:"Slovakia",placeholder:"SK1234567891",vatPrefix:"SK",countryIso2:"SK"},{name:"TH VAT",type:"th_vat",country:"Thailand",placeholder:"1234567891234",countryIso2:"TH"},{name:"TR TIN",type:"tr_tin",country:"Turkey",placeholder:"0123456789",countryIso2:"TR"},{name:"TW VAT",type:"tw_vat",country:"Taiwan",placeholder:"12345678",countryIso2:"TW"},{name:"UA VAT",type:"ua_vat",country:"Ukraine",placeholder:"123456789",countryIso2:"UA"},{name:"US EIN",type:"us_ein",country:"United States",placeholder:"12-3456789",countryIso2:"US"},{name:"XI VAT",type:"eu_vat",country:"United Kingdom (Northern Ireland)",placeholder:"XI123456789",vatPrefix:"XI",countryIso2:"GB"},{name:"ZA VAT",type:"za_vat",country:"South Africa",placeholder:"4123456789",countryIso2:"ZA"},{name:"UY RUC",type:"uy_ruc",country:"Uruguay",placeholder:"123456789012",countryIso2:"UY"},{name:"VE RIF",type:"ve_rif",country:"Venezuela",placeholder:"A-12345678-9",countryIso2:"VE"},{name:"VN TIN",type:"vn_tin",country:"Vietnam",placeholder:"1234567890",countryIso2:"VN"}],tW=e=>{let t=tq.find(t=>t.name===e.name),a=null==t?void 0:t.vatPrefix;return a&&!e.value.startsWith(a)?"".concat(a).concat(e.value):e.value},tX=(e,t)=>(null==e?void 0:e.type)===(null==t?void 0:t.type)&&(null==e?void 0:e.value)===(null==t?void 0:t.value);var tK=a(14415),tQ=()=>{var e,t;let{slug:a}=(0,i.UO)(),n=(0,k.l)(),{data:s,error:o,isLoading:d,isSuccess:x,isError:g}=tB({slug:a}),{mutate:j,isLoading:b}=tG({onSuccess:()=>{m.Am.success("Successfully updated tax id")}}),N=tO.Ry({type:tO.Z_(),value:tO.Z_(),name:tO.Z_()}),w=(0,tD.cI)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,tZ.F)(N),defaultValues:{type:"",value:"",name:""}}),_=s?{type:s.type,value:s.value,name:null!==(t=null===(e=tq.find(e=>e.type===s.type&&e.countryIso2===s.country))||void 0===e?void 0:e.name)&&void 0!==t?t:""}:{type:"",value:"",name:""},C=!tX(w.getValues(),_),A=(0,S.Xo)(c.KA.BILLING_READ,"stripe.tax_ids"),I=(0,S.Xo)(c.KA.BILLING_WRITE,"stripe.tax_ids");(0,u.useEffect)(()=>{x&&_&&(w.setValue("type",_.type),w.setValue("value",_.value),w.setValue("name",_.name))},[x]);let T=async()=>{if(!a)return console.error("Slug is required");let{type:e,value:t}=w.getValues();if((null==e?void 0:e.length)&&!(null==t?void 0:t.length)){w.setError("value",{message:"Value is required"});return}j({slug:a,taxId:(null==e?void 0:e.length)&&(null==t?void 0:t.length)?{type:e,value:tW({value:t,name:w.getValues().name}),country:null==z?void 0:z.countryIso2}:null})},E=()=>{w.setValue("type",_.type),w.setValue("value",_.value),w.setValue("name",_.name)},M=e=>{let t=tq.find(t=>t.name===e);t&&(w.setValue("type",t.type),w.setValue("value",""),w.setValue("name",e))},P=()=>{w.reset()},{name:R}=w.watch(),z=tq.find(e=>e.name===R);return(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"TaxID","data-sentry-source-file":"TaxID.tsx",children:[(0,r.jsx)(l.g$,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"TaxID.tsx",children:(0,r.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,r.jsx)("p",{className:"text-foreground text-base m-0",children:"Tax ID"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light pr-4 m-0",children:"Add a tax ID to your invoices. Changes only apply to future invoices."}),(0,r.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Make sure the tax ID looks exactly like the placeholder text."})]})}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"TaxID.tsx",children:(null==n?void 0:n.managed_by)!==void 0&&(null==n?void 0:n.managed_by)!=="supabase"?(0,r.jsx)(f.Z,{partner:null==n?void 0:n.managed_by,resource:"Tax IDs",cta:{installationId:null==n?void 0:n.partner_id}}):A?(0,r.jsxs)(r.Fragment,{children:[d&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),g&&(0,r.jsx)(p.Z,{error:o,subject:"Failed to retrieve organization tax Id"}),x&&(0,r.jsx)(tL.Z,{className:"mb-8",footer:(0,r.jsx)(h.i,{form:"tax-id-form",isSubmitting:b,hasChanges:C,handleReset:()=>E(),helper:I?void 0:"You need additional permissions to manage this organization's tax ID"}),children:(0,r.jsx)(tY.l0,{...w,children:(0,r.jsxs)("form",{id:"tax-id-form",className:"grid grid-cols-2 gap-2 w-full py-8 px-8 items-center",onSubmit:w.handleSubmit(()=>T()),children:[(0,r.jsx)(tY.Wi,{name:"name",control:w.control,render:e=>{let{field:t}=e;return(0,r.jsx)(tY.xJ,{children:(0,r.jsx)(tY.NI,{children:(0,r.jsxs)(tV.Ph,{...t,disabled:!I,value:t.value,onValueChange:e=>M(e),children:[(0,r.jsx)(tV.i4,{children:(0,r.jsx)(tV.ki,{placeholder:"None"})}),(0,r.jsx)(tV.Bw,{children:(0,r.jsx)(tV.DI,{children:tq.sort((e,t)=>e.country.localeCompare(t.country)).map(e=>(0,r.jsxs)(tV.Ql,{value:e.name,children:[e.country," - ",e.name]},e.name))})})]})})})}}),z&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(tY.Wi,{name:"value",control:w.control,render:e=>{let{field:t}=e;return(0,r.jsx)(tY.xJ,{className:"w-full",children:(0,r.jsx)(tY.NI,{children:(0,r.jsx)(tH.I,{...t,placeholder:null==z?void 0:z.placeholder,disabled:!I})})})}}),(0,r.jsx)(H.z,{type:"text",className:"px-1",icon:(0,r.jsx)(tK.Z,{}),onClick:()=>P()})]})]})})})]}):(0,r.jsx)(y.Z,{resourceText:"view this organization's tax ID"})})]})},tJ=()=>{var e;let{billingAccountData:t,billingPaymentMethods:a,billingCredits:n}=(0,o.N)(["billing:account_data","billing:payment_methods","billing:credits"]),{slug:s}=(0,i.UO)(),{data:c}=(0,d.Gl)({orgSlug:s}),u=!(null==c?void 0:c.billing_via_partner),m=t&&u,p=a&&u;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l._S,{id:"subscription","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"BillingSettings.tsx",children:(0,r.jsx)(tz,{"data-sentry-element":"Subscription","data-sentry-source-file":"BillingSettings.tsx"})}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"BillingSettings.tsx"}),(0,r.jsx)(l._S,{id:"cost-control","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"BillingSettings.tsx",children:(0,r.jsx)(eA,{"data-sentry-element":"CostControl","data-sentry-source-file":"BillingSettings.tsx"})}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"BillingSettings.tsx"}),(0,r.jsx)(l._S,{id:"breakdown","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"BillingSettings.tsx",children:(0,r.jsx)(er,{"data-sentry-element":"BillingBreakdown","data-sentry-source-file":"BillingSettings.tsx"})}),n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.I7,{}),(0,r.jsx)(l._S,{id:"credits-balance",children:(0,r.jsx)(eT,{})})]}),p&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.I7,{}),(0,r.jsx)(l._S,{id:"payment-methods",children:(0,r.jsx)(e4,{})})]}),m&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.I7,{}),(0,r.jsx)(l._S,{id:"email",children:(0,r.jsx)(eo,{})}),(0,r.jsx)(l.I7,{}),(0,r.jsx)(l._S,{id:"address",children:(0,r.jsx)(z,{})}),(0,r.jsx)(l.I7,{}),(0,r.jsx)(l._S,{id:"taxId",children:(0,r.jsx)(tQ,{})})]})]})},t$=a(10900),t0=a(39009),t1=a(25084),t2=a(97364),t4=a(89431);async function t5(e){let{slug:t}=e,{data:a,error:n}=await (0,b.IV)("/platform/organizations/{slug}",{params:{path:{slug:t}}});return n&&(0,b.S3)(n),a}let t3=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>t5(e),{async onSuccess(t,a,s){await Promise.all([n.invalidateQueries(N.O.list()),n.invalidateQueries(t4.F.list())]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to delete organization: ".concat(e.message)):t(e,a,n)},...a})};var t6=()=>{let e=(0,ta.useRouter)(),t=(0,k.l)(),{slug:a,name:n}=null!=t?t:{},[s,i]=(0,u.useState)(!1),[l,o]=(0,u.useState)(""),d=(0,S.Xo)(c.KA.UPDATE,"organizations"),{mutate:p,isLoading:h}=t3({onSuccess:()=>{m.Am.success("Successfully deleted ".concat(n)),e.push("/projects")}}),x=async e=>d?a?void p({slug:a}):console.error("Org slug is required"):m.Am.error("You do not have the required permissions to delete this organization");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(H.z,{loading:!a,onClick:()=>i(!0),type:"danger","data-sentry-element":"Button","data-sentry-source-file":"DeleteOrganizationButton.tsx",children:"Delete organization"})}),(0,r.jsx)(eP.Z,{closable:!0,hideFooter:!0,size:"small",visible:s,onCancel:()=>i(!1),header:(0,r.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,r.jsx)("span",{children:"Delete organization"}),(0,r.jsx)("span",{className:"text-xs text-foreground-lighter",children:"Are you sure?"})]}),"data-sentry-element":"Modal","data-sentry-source-file":"DeleteOrganizationButton.tsx",children:(0,r.jsx)(E.Z,{validateOnBlur:!0,initialValues:{orgName:""},onSubmit:x,validate:e=>{let t={};return e.orgName||(t.orgName="Enter the name of the organization."),e.orgName!==a&&(t.orgName="Value entered does not match the value above."),t},"data-sentry-element":"Form","data-sentry-source-file":"DeleteOrganizationButton.tsx",children:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eP.Z.Content,{children:(0,r.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["This action ",(0,r.jsx)("span",{className:"text-foreground",children:"cannot"})," be undone. This will permanently delete the ",(0,r.jsx)("span",{className:"text-foreground",children:n})," ","organization and remove all of its projects."]})}),(0,r.jsx)(eP.Z.Separator,{}),(0,r.jsx)(eP.Z.Content,{children:(0,r.jsx)(M.Z,{id:"orgName",label:(0,r.jsxs)("span",{children:["Please type ",(0,r.jsx)("span",{className:"font-bold",children:a})," to confirm"]}),onChange:e=>o(e.target.value),value:l,placeholder:"Enter the string above",className:"w-full"})}),(0,r.jsx)(eP.Z.Separator,{}),(0,r.jsx)(eP.Z.Content,{children:(0,r.jsx)(H.z,{block:!0,size:"small",type:"danger",htmlType:"submit",loading:h,disabled:h,children:"I understand, delete this organization"})})]})})})]})},t8=()=>{let e=(0,k.l)();return(0,r.jsx)(tL.Z,{title:(0,r.jsx)("p",{className:"uppercase",children:"Danger Zone"},"panel-title"),"data-sentry-element":"Panel","data-sentry-component":"OrganizationDeletePanel","data-sentry-source-file":"OrganizationDeletePanel.tsx",children:(0,r.jsx)(tL.Z.Content,{className:"p-0","data-sentry-element":"unknown","data-sentry-source-file":"OrganizationDeletePanel.tsx",children:(null==e?void 0:e.managed_by)!=="vercel-marketplace"?(0,r.jsx)(e1.J,{type:"destructive",className:"mb-0 rounded-none border-0",title:"Deleting this organization will also remove its projects",description:"Make sure you have made a backup of your projects if you want to keep your data",children:(0,r.jsx)(t6,{})}):(0,r.jsx)(f.Z,{partner:"vercel-marketplace",resource:"Organizations",cta:{installationId:null==e?void 0:e.partner_id,path:"/settings",message:"Delete organization in Vercel Marketplace"}})})})},t7=()=>{let{slug:e}=(0,i.UO)(),t=(0,C.NL)(),a=(0,k.l)(),{name:n}=null!=a?a:{},s="org-general-settings",d=(0,t0.C)(),p=(0,o.N)("organizations:delete"),y=(0,S.Xo)(c.KA.UPDATE,"organizations"),f=(0,S.Xo)(c.KA.UPDATE,"organizations"),{mutate:v,isLoading:j}=(0,ei.k)(),b=async(n,s)=>{var r;let{resetForm:i}=s;if(!y)return m.Am.error("You do not have the required permissions to update this organization");if(!e)return console.error("Slug is required");let l=null!==(r=null==a?void 0:a.opt_in_tags)&&void 0!==r?r:[],o=n.isOptedIntoAi&&!l.includes(eh.PV.AI_SQL)?l.concat([eh.PV.AI_SQL]):!n.isOptedIntoAi&&l.includes(eh.PV.AI_SQL)?l.filter(e=>e!==eh.PV.AI_SQL):l;v({slug:e,name:n.name,opt_in_tags:o},{onSuccess:()=>{i({values:n,initialValues:n}),(0,el.aL)(t),m.Am.success("Successfully saved settings")}})};return(0,r.jsxs)(l.gW,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-component":"GeneralSettings","data-sentry-source-file":"GeneralSettings.tsx",children:[(0,r.jsx)(t$.A,{organization:a,"data-sentry-element":"NoProjectsOnPaidOrgInfo","data-sentry-source-file":"GeneralSettings.tsx"}),(0,r.jsx)(E.Z,{id:s,initialValues:{name:null!=n?n:"",isOptedIntoAi:d},onSubmit:b,"data-sentry-element":"Form","data-sentry-source-file":"GeneralSettings.tsx",children:e=>{let{handleReset:t,values:i,initialValues:l,resetForm:o}=e,c=JSON.stringify(i)!==JSON.stringify(l);return(0,u.useEffect)(()=>{let e={name:null!=n?n:"",isOptedIntoAi:d};o({values:e,initialValues:e})},[null==a?void 0:a.slug]),(0,r.jsx)(x.by,{footer:(0,r.jsx)("div",{className:"flex py-4 px-8",children:(0,r.jsx)(h.i,{form:s,isSubmitting:j,hasChanges:c,handleReset:t,helper:y?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,r.jsx)(g.hj,{header:(0,r.jsx)(g.S0,{children:"General settings"}),children:(0,r.jsxs)(g.B4,{loading:!1,children:[(0,r.jsx)(M.Z,{id:"name",size:"small",label:"Organization name",disabled:!y}),(0,r.jsx)(M.Z,{copy:!0,disabled:!0,id:"slug",size:"small",label:"Organization slug",value:null==a?void 0:a.slug}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)(t1.Z,{id:"isOptedIntoAi",name:"isOptedIntoAi",disabled:!y,size:"small",label:"Opt-in to sending anonymous data to OpenAI",descriptionText:"By opting into sending anonymous data, Supabase AI can improve the answers it shows you. This is an organization-wide setting."}),(0,r.jsx)(t2.Z,{className:"ml-16"})]})]})})})}}),p&&f&&(0,r.jsx)(t8,{})]})},t9=a(27203),ae=a(42772),at=a(58079),aa=a(78127),an=a(21599),as=a(68608),ar=a(96528),ai=a(28890),al=a(90675),ao=a(51214),ad=a(11522);let ac=e=>{let{title:t}=e;return(0,r.jsx)("img",{className:"border rounded-lg shadow w-48 mt-6 border-body",src:"".concat(eh.GW,"/img/integrations/covers/").concat(t,"-cover.png"),alt:"".concat(t," cover"),"data-sentry-component":"IntegrationImageHandler","data-sentry-source-file":"IntegrationSettings.tsx"})};var au=()=>{let e=(0,k.l)(),t=(0,S.Xo)(c.KA.READ,"integrations.github_connections"),a=(0,S.Xo)(c.KA.CREATE,"integrations.github_connections"),n=(0,S.Xo)(c.KA.UPDATE,"integrations.github_connections"),{data:s}=(0,aa.x)(),{data:i}=(0,as.q)({organizationId:null==e?void 0:e.id}),{mutate:o}=(0,an.n)({onSuccess:()=>{m.Am.success("Successfully deleted Github connection")}}),d=(0,ai.x5)(),p=(0,u.useCallback)(()=>{d.setGithubConnectionsOpen(!0)},[d]),h=(0,u.useCallback)(async t=>{if(!(null==e?void 0:e.id)){m.Am.error("Organization not found");return}o({connectionId:t.id,organizationId:e.id})},[o,null==e?void 0:e.id]),x=s?"You are authorized with Supabase GitHub App. You can configure your GitHub App installations and repository access [here](".concat(ar.Xw,"). You can revoke your authorization [here](").concat(ar.H4,")."):"";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(()=>(0,r.jsx)(l._S,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"GitHubSection","data-sentry-source-file":"IntegrationSettings.tsx",children:(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"IntegrationSettings.tsx",children:[(0,r.jsxs)(l.g$,{title:"GitHub Connections","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"IntegrationSettings.tsx",children:[(0,r.jsx)(ae.U,{content:"\nConnect any of your GitHub repositories to a project.\n","data-sentry-element":"Markdown","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,r.jsx)(ac,{title:"github","data-sentry-element":"IntegrationImageHandler","data-sentry-source-file":"IntegrationSettings.tsx"})]}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"IntegrationSettings.tsx",children:t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ae.U,{content:"\n\n### How will GitHub connections work?\n\nYou will be able to connect a GitHub repository to a Supabase project.\nThe GitHub app will watch for changes in your repository such as file changes, branch changes as well as pull request activity.\n"}),(0,r.jsx)("ul",{className:"flex flex-col gap-y-2",children:null==i?void 0:i.map(e=>{var t,a,s,i,l;return(0,r.jsx)(al.z,{disabled:!n,connection:{id:String(e.id),added_by:{id:String(null===(t=e.user)||void 0===t?void 0:t.id),primary_email:null!==(i=null===(a=e.user)||void 0===a?void 0:a.primary_email)&&void 0!==i?i:"",username:null!==(l=null===(s=e.user)||void 0===s?void 0:s.username)&&void 0!==l?l:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}},type:"GitHub",onDeleteConnection:h},e.id)})}),(0,r.jsx)(t9.FP,{onClick:p,orgSlug:null==e?void 0:e.slug,showNode:!1,disabled:!a,children:"Add new project connection"}),x&&(0,r.jsx)(ae.U,{extLinks:!0,content:x,className:"text-foreground-lighter"})]}):(0,r.jsx)(y.Z,{resourceText:"view this organization's GitHub connections"})})]})}),{"data-sentry-element":"GitHubSection","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,r.jsx)(at.Z,{isProjectScoped:!1,"data-sentry-element":"VercelSection","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,r.jsx)(ad.Z,{"data-sentry-element":"SidePanelVercelProjectLinker","data-sentry-source-file":"IntegrationSettings.tsx"}),(0,r.jsx)(ao.Z,{"data-sentry-element":"SidePanelGitHubRepoLinker","data-sentry-source-file":"IntegrationSettings.tsx"})]})};(n=s||(s={})).DRAFT="draft",n.PAID="paid",n.VOID="void",n.UNCOLLECTIBLE="uncollectible",n.OPEN="open",n.ISSUED="issued";let am={[s.DRAFT]:{label:"Upcoming",badgeVariant:"warning"},[s.PAID]:{label:"Paid",badgeVariant:"brand"},[s.VOID]:{label:"Forgiven",badgeVariant:"brand"},[s.UNCOLLECTIBLE]:{label:"Outstanding",badgeVariant:"destructive"},[s.OPEN]:{label:"Outstanding",badgeVariant:"destructive"},[s.ISSUED]:{label:"Outstanding",badgeVariant:"destructive"}};var ap=e=>{let{status:t,paymentAttempted:a}=e,n=am[t];return(0,r.jsxs)(tA.fC,{delayDuration:0,"data-sentry-element":"unknown","data-sentry-component":"InvoiceStatusBadge","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:[(0,r.jsx)(tA.xz,{"data-sentry-element":"unknown","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:(0,r.jsx)(eI.C,{size:"small",className:"capitalize",variant:(null==n?void 0:n.badgeVariant)||"default","data-sentry-element":"Badge","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:(null==n?void 0:n.label)||t})}),(0,r.jsx)(tA.h_,{"data-sentry-element":"unknown","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:(0,r.jsxs)(tA.VY,{side:"bottom","data-sentry-element":"unknown","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:[(0,r.jsx)(tA.Eh,{className:"radix-tooltip-arrow","data-sentry-element":"unknown","data-sentry-source-file":"InvoiceStatusBadge.tsx"}),(0,r.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-[300px] space-y-2 border border-background",children:[[s.OPEN,s.ISSUED,s.UNCOLLECTIBLE].includes(t)&&(a?(0,r.jsx)("p",{className:"text-xs text-foreground",children:'We were not able to collect the payment. Make sure you have a valid payment method and enough funds. Outstanding invoices may cause restrictions. You can manually pay the invoice using the "Pay Now" button.'}):(0,r.jsx)("p",{className:"text-xs text-foreground",children:'The invoice will soon be charged for. In case you pay via invoice instead of card, please make sure to make the payment in a timely manner. You can also pay the invoice using your card now using the "Pay Now" button.'})),t===s.DRAFT&&(0,r.jsx)("p",{className:"text-xs text-foreground",children:"The invoice will soon be finalized and charged for."}),t===s.PAID&&(0,r.jsx)("p",{className:"text-xs text-foreground",children:"The invoice has been paid successfully. No action is required on your side."}),t===s.VOID&&(0,r.jsx)("p",{className:"text-xs text-foreground",children:"This invoice has been forgiven. No action is required on your side."})]})]})})]})};async function ah(e,t){let{invoiceId:a,slug:n}=e;if(!a)throw Error("Invoice ID is required");if(!n)throw Error("Slug is required");let{data:s,error:r}=await (0,b.U2)("/platform/organizations/{slug}/billing/invoices/{invoiceId}",{params:{path:{invoiceId:a,slug:n}},signal:t});return r&&(0,b.S3)(r),s}async function ax(e,t){let{slug:a}=e;if(!a)throw Error("Slug is required");let n=await (0,b.YM)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:a}},signal:t,parseAs:"text"});if(n.error)throw n.error;return Number(n.response.headers.get("X-Total-Count"))}let ag=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(F.Y.count(t),e=>{let{signal:a}=e;return ax({slug:t},a)},{enabled:a&&void 0!==t,...n})};async function ay(e,t){let{slug:a,offset:n=0,limit:s=10}=e;if(!a)throw Error("Org slug is required");let{data:r,error:i}=await (0,b.U2)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:a},query:{offset:n.toString(),limit:s.toString()}},signal:t});return i&&(0,b.S3)(i),r}let af=function(e){let{slug:t,offset:a,limit:n}=e,{enabled:s=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(F.Y.list(t,a),e=>{let{signal:s}=e;return ay({slug:t,offset:a,limit:n},s)},{enabled:s&&void 0!==t,...r})};var av=()=>{let{slug:e}=(0,i.UO)(),{data:t,isLoading:a,isError:n}=(0,d.Gl)({orgSlug:e}),{data:s,isLoading:l,isError:o}=eV({slug:e}),u=null==s?void 0:s.data.find(e=>e.is_default);return!(0,S.Xo)(c.KA.BILLING_READ,"stripe.payment_methods")||n||o?null:(0,r.jsxs)("div",{className:"flex justify-between items-center gap-4 w-full text-sm rounded-lg p-4 text-foreground bg-alternative border","data-sentry-component":"CurrentPaymentMethod","data-sentry-source-file":"CurrentPaymentMethod.tsx",children:[a||l?(0,r.jsx)(v.Z,{className:"flex-1"}):(null==t?void 0:t.payment_method_type)==="invoice"?(0,r.jsx)("p",{className:"flex-1 text-sm",children:"You get a monthly invoice and payment link via email. To change your payment method, please contact us via our support form."}):u?(0,r.jsx)(eJ,{paymentMethod:u,paymentMethodType:null==t?void 0:t.payment_method_type,canUpdatePaymentMethods:!1}):(0,r.jsxs)("div",{className:"flex-1 flex items-center gap-2 opacity-50",children:[(0,r.jsx)(eq.Z,{size:16,strokeWidth:1.5}),(0,r.jsx)("p",{className:"text-sm",children:"No payment methods"})]}),(0,r.jsx)(H.z,{type:"outline",asChild:!0,"data-sentry-element":"Button","data-sentry-source-file":"CurrentPaymentMethod.tsx",children:(null==t?void 0:t.payment_method_type)==="invoice"?(0,r.jsx)(L(),{href:"/support/new?slug=".concat(e,"&ref=no-project&message=").concat(encodeURIComponent("I would like to change my payment method"),"&category=").concat(c.DH.BILLING),children:"Contact support"}):(0,r.jsx)(L(),{href:"/org/".concat(e,"/billing#payment-methods"),children:"Manage payment methods"})})]})},aj=a(32939),ab=a(2684),aS=a(92494);async function aN(e){let{slug:t,invoiceId:a}=e;if(!t)throw Error("Org slug is required");if(!a)throw Error("Invoice ID is required");let{data:n,error:s}=await (0,b.U2)("/platform/organizations/{slug}/billing/invoices/{invoiceId}/payment-link",{params:{path:{slug:t,invoiceId:a}}});return s&&(0,b.S3)(s),n}let aw=function(){let{onError:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,C.NL)();return(0,A.D)(e=>aN(e),{async onError(t,n,s){await Promise.all([a.invalidateQueries(F.Y.listAndCount(n.slug))]),void 0===e?m.Am.error(t.message):e(t,n,s)},...t})};var a_=e=>{let{slug:t,invoiceId:a}=e,{mutate:n,isLoading:s}=aw({onSuccess(e){m.Am.success("Redirecting to payment gateway..."),window.location.href=e.redirectUrl}});return(0,r.jsx)(H.z,{onClick:function(){n({slug:t,invoiceId:a})},loading:s,disabled:s,"data-sentry-element":"Button","data-sentry-component":"InvoicePayButton","data-sentry-source-file":"InvoicePayButton.tsx",children:"Pay Now"})},aC=()=>{let[e,t]=(0,u.useState)(1),a=(0,k.l)(),{slug:n}=null!=a?a:{},i=(e-1)*10,o=(0,S.Xo)(c.KA.READ,"invoices"),{data:d,isError:h}=ag({slug:n},{enabled:(null==a?void 0:a.managed_by)==="supabase"}),{data:x,error:g,isLoading:j,isError:b,isSuccess:N}=af({slug:n,offset:i,limit:10},{enabled:(null==a?void 0:a.managed_by)==="supabase"}),w=x||[];(0,u.useEffect)(()=>{t(1)},[n]);let _=async e=>{try{let t=await ah({invoiceId:e,slug:n});(null==t?void 0:t.invoice_pdf)&&window.open(t.invoice_pdf,"_blank")}catch(e){m.Am.error("Failed to fetch the selected invoice: ".concat(e.message))}};return o?(null==a?void 0:a.managed_by)!==void 0&&(null==a?void 0:a.managed_by)!=="supabase"?(0,r.jsx)(l.gW,{children:(0,r.jsx)(f.Z,{partner:null==a?void 0:a.managed_by,resource:"Invoices",cta:{installationId:null==a?void 0:a.partner_id,path:"/invoices"}})}):(0,r.jsxs)(l.gW,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-component":"InvoicesSettings","data-sentry-source-file":"InvoicesSettings.tsx",children:[j&&(0,r.jsx)(v.A,{}),b&&(0,r.jsx)(p.Z,{error:g,subject:"Failed to retrieve invoices"}),N&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(av,{}),(0,r.jsx)(ef.Z,{head:[(0,r.jsx)(ef.Z.th,{},"header-icon"),(0,r.jsx)(ef.Z.th,{children:"Date"},"header-date"),(0,r.jsx)(ef.Z.th,{children:"Amount"},"header-amount"),(0,r.jsx)(ef.Z.th,{children:"Invoice number"},"header-invoice"),(0,r.jsx)(ef.Z.th,{className:"flex items-center",children:"Status"},"header-status"),(0,r.jsx)(ef.Z.th,{className:"text-right"},"header-download")],body:0===w.length?(0,r.jsx)(ef.Z.tr,{children:(0,r.jsx)(ef.Z.td,{colSpan:6,className:"p-3 py-12 text-center",children:(0,r.jsx)("p",{className:"text-foreground-light",children:j?"Checking for invoices":"No invoices for this organization yet"})})}):(0,r.jsxs)(r.Fragment,{children:[w.map(e=>(0,r.jsxs)(ef.Z.tr,{children:[(0,r.jsx)(ef.Z.td,{children:(0,r.jsx)(aj.Z,{size:"24"})}),(0,r.jsx)(ef.Z.td,{children:(0,r.jsx)("p",{children:D()(1e3*e.period_end).format("MMM DD, YYYY")})}),(0,r.jsx)(ef.Z.td,{children:(0,r.jsx)("p",{children:(0,V.xG)(e.amount_due/100)})}),(0,r.jsx)(ef.Z.td,{children:(0,r.jsx)("p",{children:e.number})}),(0,r.jsx)(ef.Z.td,{children:(0,r.jsx)(ap,{status:e.status,paymentAttempted:e.payment_attempted})}),(0,r.jsx)(ef.Z.td,{className:"align-right",children:(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[e.amount_due>0&&[s.UNCOLLECTIBLE,s.OPEN,s.ISSUED].includes(e.status)&&(0,r.jsx)(a_,{slug:n,invoiceId:e.id}),(0,r.jsx)(H.z,{type:"outline",icon:(0,r.jsx)(ab.Z,{size:16,strokeWidth:1.5}),onClick:()=>_(e.id)})]})})]},e.id)),(0,r.jsx)(ef.Z.tr,{children:(0,r.jsx)(ef.Z.td,{colSpan:6,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm opacity-50",children:h?"Failed to retrieve total number of invoices":"Showing ".concat(i+1," to ").concat(i+w.length," out of ").concat(d," invoices")}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(H.z,{icon:(0,r.jsx)(aS.Z,{}),type:"default",size:"tiny",disabled:1===e,onClick:async()=>t(e-1)}),(0,r.jsx)(H.z,{icon:(0,r.jsx)(U.Z,{}),type:"default",size:"tiny",disabled:10*e>=(null!=d?d:0),onClick:async()=>t(e+1)})]})]})})},"navigation")]})})]})]}):(0,r.jsx)(l.gW,{children:(0,r.jsx)(y.Z,{resourceText:"view invoices"})})},aA=a(39677),aI=a(21068),aT=a(26655),ak=a(42890),aE=e=>{let{visible:t,onHide:a}=e;return(0,r.jsxs)(eP.Z,{hideFooter:!0,visible:t,size:"xlarge",header:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Spend Cap"}),(0,r.jsx)(aT.G,{href:"https://supabase.com/docs/guides/platform/spend-cap"})]}),showCloseButton:!1,onCancel:()=>a(),"data-sentry-element":"Modal","data-sentry-component":"SpendCapModal","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapModal.tsx",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-sm",children:"Enabling the Spend Cap limits your usage to your plan's quota, which controls costs but can restrict your service. Disabling the spend cap removes these limits, but any extra usage beyond the plan's limit will be charged per usage."}),(0,r.jsx)("p",{className:"text-sm",children:"Launching additional projects or enabling project add-ons will incur additional monthly fees independent of your Spend Cap."}),(0,r.jsxs)(ak.iA,{"data-sentry-element":"Table","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.xD,{className:"[&_th]:h-7","data-sentry-element":"TableHeader","data-sentry-source-file":"SpendCapModal.tsx",children:(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.ss,{className:"w-[50%]","data-sentry-element":"TableHead","data-sentry-source-file":"SpendCapModal.tsx",children:"Item"}),(0,r.jsx)(ak.ss,{className:"w-[25%]","data-sentry-element":"TableHead","data-sentry-source-file":"SpendCapModal.tsx",children:"Limit"}),(0,r.jsx)(ak.ss,{className:"w-[25%]","data-sentry-element":"TableHead","data-sentry-source-file":"SpendCapModal.tsx",children:"Rate"})]})}),(0,r.jsxs)(ak.RM,{className:"[&_td]:py-2","data-sentry-element":"TableBody","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Disk Size"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"8 GB per project"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.125 per GB"})]}),(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Egress"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"250 GB"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.09 per GB"})]}),(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Auth MAUs"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"100,000"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.00325 per user"})]}),(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Auth Third-Party MAUs"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"50"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.00325 per user"})]}),(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Auth Single Sign-On MAUs"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"50"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.015 per user"})]}),(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Storage Size"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"100 GB"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$0.021 per GB"})]}),(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Storage Image Transformations"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"100 origin images"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$5 per 1000 images"})]}),(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Realtime Concurrent Peak Connections"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"500"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$10 per 1000"})]}),(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Realtime Messages"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"5 Million"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$2.50 per Million"})]}),(0,r.jsxs)(ak.SC,{"data-sentry-element":"TableRow","data-sentry-source-file":"SpendCapModal.tsx",children:[(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"Function Invocations"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"2 Million"}),(0,r.jsx)(ak.pj,{"data-sentry-element":"TableCell","data-sentry-source-file":"SpendCapModal.tsx",children:"$2 per Million"})]})]})]})]})}),(0,r.jsx)(eP.Z.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapModal.tsx"}),(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SpendCapModal.tsx",children:(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(H.z,{block:!0,type:"primary",onClick:()=>a(),"data-sentry-element":"Button","data-sentry-source-file":"SpendCapModal.tsx",children:"Understood"})})})]})},aM=a(73966),aP=a(44930),aR=a(73860);let az={PERSONAL:"Personal",EDUCATIONAL:"Educational",STARTUP:"Startup",AGENCY:"Agency",COMPANY:"Company",UNDISCLOSED:"N/A"},aZ={1:"1 - 10",10:"10 - 49",50:"50 - 99",100:"100 - 299",300:"More than 300"};var aD=e=>{let{onPaymentMethodReset:t}=e,a=(0,ta.useRouter)(),n=(0,aP.Un)(),{data:s,isSuccess:i}=(0,el.tl)(),l=(0,eE.useStripe)(),o=(0,eE.useElements)(),d=(0,C.NL)(),[c,p]=(0,aR.XI)({plan:(0,aR.km)(Object.keys(eh.f6)).withDefault("FREE"),name:aR.Oi.withDefault(""),kind:(0,aR.km)(Object.keys(az)).withDefault("PERSONAL"),size:aR.Oi.withDefault("1"),spend_cap:aR.AE.withDefault(!0),returnTo:aR.Oi.withDefault(""),auth_id:aR.Oi.withDefault("")}),{name:h,kind:x,spend_cap:g,plan:y,size:f,returnTo:v,auth_id:j}=c,[b,S]=(0,u.useState)(!1),[N,w]=(0,u.useState)(),[_,A]=(0,u.useState)(!1);(0,u.useEffect)(()=>{if(!h&&(null==s?void 0:s.length)===0&&!n.isLoading){var e;let t=(null===(e=n.profile)||void 0===e?void 0:e.username)?n.profile.username+"'s Org":"My Org";p({...c,name:t})}},[i]);let{mutate:I}=(0,aM.T)({onSuccess:async e=>{var t;await (0,el.aL)(d);let s=(null===(t=n.profile)||void 0===t?void 0:t.username)?n.profile.username+"'s Project":"My Project";v&&j?a.push("".concat(v,"?auth_id=").concat(j),void 0,{shallow:!1}):a.push("/new/".concat(e.slug,"?projectName=").concat(s))},onError:()=>{E(),S(!1)}});async function T(e){I({name:h,kind:x,tier:"tier_"+("PRO"!==y||g?y:"PAYG").toLowerCase(),..."COMPANY"==x?{size:f}:{},payment_method:e})}let k=async e=>{var t;if(e.preventDefault(),!((h?h.trim():"").length>=1))return m.Am.error("Organization name is empty");if(!l||!o)return console.error("Stripe.js has not loaded");if(S(!0),"FREE"===y)await T();else if(N)T(N.id);else{let{error:e,setupIntent:a}=await l.confirmSetup({elements:o,redirect:"if_required",confirmParams:{return_url:"".concat((0,V.Ax)(),"/new"),expand:["payment_method"]}});if(e||!a.payment_method){m.Am.error(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:" Failed to save card details"),S(!1);return}let n=a.payment_method;w(n),T(n.id)}},E=()=>(w(void 0),t());return(0,r.jsx)("form",{onSubmit:k,"data-sentry-component":"NewOrgForm","data-sentry-source-file":"NewOrgForm.tsx",children:(0,r.jsxs)(tL.Z,{title:(0,r.jsx)("div",{children:(0,r.jsx)("h4",{children:"Create a new organization"})},"panel-title"),footer:(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(H.z,{type:"default",disabled:b,onClick:()=>a.push("/projects"),children:"Cancel"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("p",{className:"text-xs text-foreground-lighter",children:"You can rename your organization later"}),(0,r.jsx)(H.z,{htmlType:"submit",type:"primary",loading:b,disabled:b,children:"Create organization"})]})]},"panel-footer"),"data-sentry-element":"Panel","data-sentry-source-file":"NewOrgForm.tsx",children:[(0,r.jsxs)(tL.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"NewOrgForm.tsx",children:[(0,r.jsx)("p",{className:"text-sm",children:"This is your organization within Supabase."}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"For example, you can use the name of your company or department."})]}),(0,r.jsx)(tL.Z.Content,{className:"Form section-block--body has-inputs-centered","data-sentry-element":"unknown","data-sentry-source-file":"NewOrgForm.tsx",children:(0,r.jsx)(M.Z,{autoFocus:!0,label:"Name",type:"text",layout:"horizontal",placeholder:"Organization name",descriptionText:"What's the name of your company or team?",value:h,onChange:function(e){p({...c,name:e.target.value})},"data-sentry-element":"Input","data-sentry-source-file":"NewOrgForm.tsx"})}),(0,r.jsx)(tL.Z.Content,{className:"Form section-block--body has-inputs-centered","data-sentry-element":"unknown","data-sentry-source-file":"NewOrgForm.tsx",children:(0,r.jsx)(P.Z,{label:"Type of organization",layout:"horizontal",value:x,onChange:function(e){p({...c,kind:e})},descriptionText:"What would best describe your organization?","data-sentry-element":"Listbox","data-sentry-source-file":"NewOrgForm.tsx",children:Object.entries(az).map(e=>{let[t,a]=e;return(0,r.jsx)(P.Z.Option,{label:a,value:t,children:a},t)})})}),"COMPANY"==x?(0,r.jsx)(tL.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,r.jsx)(P.Z,{label:"Company size",layout:"horizontal",value:f,onChange:function(e){p({...c,size:e})},descriptionText:"How many people are in your company?",children:Object.entries(aZ).map(e=>{let[t,a]=e;return(0,r.jsx)(P.Z.Option,{label:a,value:t,children:a},t)})})}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)(tL.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"NewOrgForm.tsx",children:(0,r.jsx)(P.Z,{label:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("span",{children:"Plan"}),(0,r.jsxs)("a",{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer noopener",className:"text-sm flex items-center gap-2 opacity-75 hover:opacity-100 transition",children:["Pricing",(0,r.jsx)(ed.Z,{size:16,strokeWidth:1.5})]})]}),layout:"horizontal",value:y,onChange:function(e){p({...c,plan:e})},descriptionText:"FREE"!==y?(0,r.jsxs)("p",{children:["The plan applies only to this new organization. To upgrade an existing organization,"," ",(0,r.jsx)(L(),{className:"underline",href:"/org/_/billing?panel=subscriptionPlan",children:"click here"}),"."]}):void 0,"data-sentry-element":"Listbox","data-sentry-source-file":"NewOrgForm.tsx",children:Object.entries(eh.f6).map(e=>{let[t,a]=e;return(0,r.jsx)(P.Z.Option,{label:a,value:t,children:a},t)})})}),"PRO"===y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tL.Z.Content,{className:"border-b border-panel-border-interior-light dark:border-panel-border-interior-dark",children:(0,r.jsx)(t1.Z,{id:"spend-cap",layout:"horizontal",label:(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("span",{children:"Spend Cap"}),(0,r.jsx)(aA.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100",onClick:()=>A(!0)})]}),checked:g,onChange:()=>p({...c,spend_cap:!g}),descriptionText:(0,r.jsx)("div",{children:(0,r.jsx)("p",{children:"With Spend Cap enabled, usage is limited to the plan's quota, with restrictions when limits are exceeded. To scale beyond Pro Plan limits, disable the Spend Cap to pay over-usage."})})})}),(0,r.jsx)(aE,{visible:_,onHide:()=>A(!1)})]}),"FREE"!==y&&(0,r.jsx)(tL.Z.Content,{children:(null==N?void 0:N.card)!==void 0?(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,r.jsx)("img",{alt:"Card",src:"".concat(eh.GW,"/img/payment-methods/").concat(N.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,r.jsx)(M.Z,{readOnly:!0,className:"w-64",size:"small",value:"•••• •••• •••• ".concat(N.card.last4)}),(0,r.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",N.card.exp_month,"/",N.card.exp_year]})]}),(0,r.jsx)("div",{children:(0,r.jsx)(H.z,{type:"outline",icon:(0,r.jsx)(aI.Z,{}),onClick:()=>E(),disabled:b,className:"hover:border-muted"})})]},N.id):(0,r.jsx)(eE.PaymentElement,{})})]})})},aO=a(7128),aL=a(88261),aU=e=>{let{title:t,description:a}=e;return(0,r.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-14","data-sentry-component":"SectionHeader","data-sentry-source-file":"SectionHeader.tsx",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xl",children:t}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:a})]})})},aB=a(8102),aF=a(73488),aG=a(83558),aY=e=>{let{section:t,includedInPlan:a,children:n}=e,{name:s,description:i,links:o}=t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l._S,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"SectionContent.tsx",children:(0,r.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-16",children:(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,r.jsx)("div",{className:"col-span-12 lg:col-span-5",children:(0,r.jsxs)("div",{className:"sticky top-32 space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-base capitalize",children:s}),!1===a&&(0,r.jsx)(eI.C,{children:"Not included"})]}),(0,r.jsx)("div",{className:"grid gap-4",children:i.split("\n").map((e,t)=>(0,r.jsx)("p",{className:"text-sm text-foreground-light pr-8",children:e},"desc-".concat(t)))})]}),o&&o.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("p",{className:"text-sm text-foreground mb-2",children:"More information"}),o.map(e=>(0,r.jsx)("div",{children:(0,r.jsx)(L(),{href:e.url,target:"_blank",rel:"noreferrer",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,r.jsx)("p",{className:"text-sm",children:e.name}),(0,r.jsx)(ed.Z,{size:16,strokeWidth:1.5})]})})},e.url))]})]})}),(0,r.jsx)("div",{className:"col-span-12 lg:col-span-7 space-y-6",children:n})]})})}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"SectionContent.tsx"})]})};let aV=(e,t)=>{var a;return t?(null==t?void 0:null===(a=t.plan)||void 0===a?void 0:a.id)==="pro"&&(null==t?void 0:t.usage_billing_enabled)===!1?"/org/".concat(e,"/billing#cost-control"):"/org/".concat(e,"/billing?panel=subscriptionPlan"):"/org/".concat(e,"/billing")},aH=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}),aq=(e,t)=>{if("string"==typeof e)return e;if("bytes"===t){let t=aK(e).replace(/\s/g,"");return"0bytes"===t?"0":t}return"gigabytes"===t?aH.format(e)+"GB":aH.format(e)},aW=(e,t)=>{if("string"==typeof e)return e;if("bytes"===t){let t=aQ(e).replace(/\s/g,"");return"0bytes"===t?"0":t}return"gigabytes"===t?aH.format(e)+"GB":aH.format(e)},aX=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],aK=e=>{if(0===e||void 0===e)return"0 bytes";let t=Math.floor(Math.log(e)/Math.log(1024)),a=aX[t],n=2;return["bytes","KB","MB"].includes(a)?n=0:["GB"].includes(a)&&(n=1),parseFloat((e/Math.pow(1024,t)).toFixed(n))+" "+a},aQ=e=>{if(0===e||void 0===e)return"0 bytes";let t=Math.floor(Math.log(e)/Math.log(1024)),a=aX[t];return parseFloat((e/Math.pow(1024,t)).toFixed(3))+" "+a};var aJ=a(20437),a$=e=>{var t,a,n,s,i,l,o,d,c,m,h,x,g;let{slug:y,projectRef:f,attribute:j,usage:b,usageMeta:S,chartMeta:N,subscription:w,error:_,isLoading:C,isError:A,isSuccess:I,currentBillingCycleSelected:T}=e,k=aV(null!=y?y:"",w),E=(null!==(n=null==S?void 0:S.usage)&&void 0!==n?n:0)/(null!==(s=null==S?void 0:S.pricing_free_units)&&void 0!==s?s:0),M=(null!==(i=null==S?void 0:S.usage)&&void 0!==i?i:0)-(null!==(l=null==S?void 0:S.pricing_free_units)&&void 0!==l?l:0),P=null==w?void 0:w.usage_billing_enabled,R=P?"text-amber-900":"text-red-900",z=(0,u.useMemo)(()=>{var e,t;return null!==(t=null===(e=N[j.key])||void 0===e?void 0:e.data)&&void 0!==t?t:[]},[j.key,N]),Z=void 0===f&&T&&!1===P&&E>=eh.wc,D=(0,u.useMemo)(()=>{var e,t;return null!==(t=null===(e=j.attributes)||void 0===e?void 0:e.map(e=>z.some(t=>0!==Number(t[e.key]))).some(e=>!!e))&&void 0!==t&&t},[j.attributes,z]);return(0,r.jsx)("div",{id:j.anchor,className:"scroll-my-12","data-sentry-component":"AttributeUsage","data-sentry-source-file":"AttributeUsage.tsx",children:(0,r.jsxs)(aY,{section:j,"data-sentry-element":"SectionContent","data-sentry-source-file":"AttributeUsage.tsx",children:[C&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),A&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve usage data",error:_}),I&&(0,r.jsx)(r.Fragment,{children:!S||(null==S?void 0:S.available_in_plan)?(0,r.jsxs)(r.Fragment,{children:[!f&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("p",{className:"text-sm",children:[j.name," usage"]}),Z&&(0,r.jsxs)(tA.fC,{delayDuration:0,children:[(0,r.jsx)(tA.xz,{asChild:!0,children:E>=1?(0,r.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,r.jsx)(aF.Z,{size:14,strokeWidth:2,className:R}),(0,r.jsx)("p",{className:"text-sm ".concat(R),children:"Exceeded limit"})]}):E>=eh.wc&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,r.jsx)(aF.Z,{size:14,strokeWidth:2,className:"text-amber-900"}),(0,r.jsx)("p",{className:"text-sm text-amber-900",children:"Approaching limit"})]})}),(0,r.jsx)(tA.h_,{children:(0,r.jsxs)(tA.VY,{side:"bottom",children:[(0,r.jsx)(tA.Eh,{className:"radix-tooltip-arrow"}),(0,r.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:[(0,r.jsx)("p",{className:"text-xs text-foreground",children:"Exceeding your plans included usage will lead to restrictions to your project."}),(0,r.jsx)("p",{className:"text-xs text-foreground",children:"Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})]})]})})]})]})}),T&&S&&!S.unlimited&&(0,r.jsx)(e5.Z,{type:"horizontal",barClass:(0,W.cn)(E>=1?P?"bg-foreground-light":"bg-red-900":!1===P&&E>=eh.wc?"bg-amber-900":"bg-foreground-light"),bgClass:"bg-surface-300",value:null!==(o=null==S?void 0:S.usage)&&void 0!==o?o:0,max:(null==S?void 0:S.pricing_free_units)||1}),(0,r.jsxs)("div",{children:[S&&(0,r.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,r.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",null==w?void 0:null===(t=w.plan)||void 0===t?void 0:t.name," Plan"]}),S.unlimited?(0,r.jsx)("p",{className:"text-xs",children:"Unlimited"}):(0,r.jsx)("p",{className:"text-xs",children:"bytes"===j.unit||"gigabytes"===j.unit?"".concat(null!==(d=S.pricing_free_units)&&void 0!==d?d:0," GB"):(null!==(c=S.pricing_free_units)&&void 0!==c?c:0).toLocaleString()})]}),T&&S&&(0,r.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,r.jsxs)("p",{className:"text-xs text-foreground-light",children:[j.chartPrefix||"Used "," in period"]}),(0,r.jsx)("p",{className:"text-xs",children:"bytes"===j.unit||"gigabytes"===j.unit?"".concat((null!==(m=null==S?void 0:S.usage)&&void 0!==m?m:0).toFixed(2)," GB"):(null!==(h=null==S?void 0:S.usage)&&void 0!==h?h:0).toLocaleString()})]}),T&&(null!==(x=null==S?void 0:S.pricing_free_units)&&void 0!==x?x:0)>0&&(0,r.jsxs)("div",{className:"flex items-center justify-between border-t py-1",children:[(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Overage in period"}),(0,r.jsx)("p",{className:"text-xs",children:(null!==(g=null==S?void 0:S.pricing_free_units)&&void 0!==g?g:0)===-1||M<0?"0".concat("bytes"===j.unit||"gigabytes"===j.unit?" GB":""):"bytes"===j.unit||"gigabytes"===j.unit?"".concat(M.toFixed(2)," GB"):M.toLocaleString()})]})]})]}),null===(a=j.additionalInfo)||void 0===a?void 0:a.call(j,b),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("p",{className:"text-sm",children:[j.chartPrefix||""," ",j.name," ",j.chartSuffix||"per day"]}),j.chartDescription.split("\n").map((e,t)=>(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:e},"para-".concat(t)))]}),N[j.key].isLoading?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}):z.length>0&&D?(0,r.jsx)(aJ.Z,{name:"".concat(j.chartPrefix||"").concat(j.name),unit:j.unit,attributes:j.attributes,data:z,yLeftMargin:N[j.key].margin,yFormatter:e=>aq(e,j.unit),tooltipFormatter:e=>aW(e,j.unit)}):(0,r.jsx)(tL.Z,{children:(0,r.jsx)(tL.Z.Content,{children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsx)(aG.Z,{className:"text-foreground-light mb-2"}),(0,r.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to 24 hours to show"})]})})})]}):(0,r.jsx)(tL.Z,{children:(0,r.jsx)(tL.Z.Content,{children:(0,r.jsxs)("div",{className:"flex w-full items-center flex-col justify-center space-y-2 md:flex-row md:justify-between",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-sm",children:"Not included in plan"}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"You need to be on a higher plan in order to use this feature."})})]}),(0,r.jsx)(H.z,{type:"primary",asChild:!0,children:(0,r.jsx)(L(),{href:k,children:"Upgrade plan"})})]})})})})]})})},a0=a(21697);async function a1(e,t){let{orgSlug:a}=e;if(!a)throw Error("orgSlug is required");let{data:n,error:s}=await (0,b.U2)("/platform/organizations/{slug}/projects",{params:{path:{slug:a}},signal:t});return s&&(0,b.S3)(s),n}let a2=function(e){let{orgSlug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(a0.i.orgProjects(t),e=>{let{signal:a}=e;return a1({orgSlug:t},a)},{enabled:a&&void 0!==t,...n})};var a4=a(77687),a5=a(33074),a3=e=>{var t,a;let{slug:n,projectRef:s,attribute:i,subscription:l,usage:o,currentBillingCycleSelected:d}=e,{data:c,isError:m,isLoading:h,isSuccess:x,error:g}=a2({orgSlug:n},{enabled:d}),y=(0,u.useMemo)(()=>c?c.projects.filter(e=>{let t=e.is_branch&&e.databases.some(e=>{var t;return(null!==(t=e.disk_volume_size_gb)&&void 0!==t?t:8)>8}),a=e.status!==eh.S.INACTIVE,n=e.databases.every(e=>"AWS"===e.cloud_provider);return(!e.is_branch||t)&&a&&n}).filter(e=>e.ref===s||!s):[],[c,s]),f=(0,u.useMemo)(()=>y.some(e=>e.databases.some(e=>"READ_REPLICA"===e.type||e.disk_volume_size_gb&&e.disk_volume_size_gb>8)),[y]),j=null==o?void 0:o.usages.find(e=>e.metric===K.tk.DISK_SIZE_GB_HOURS_GP3),b=null==o?void 0:o.usages.find(e=>e.metric===K.tk.DISK_SIZE_GB_HOURS_IO2);return(0,r.jsx)("div",{id:i.anchor,className:"scroll-my-12","data-sentry-component":"DiskUsage","data-sentry-source-file":"DiskUsage.tsx",children:(0,r.jsxs)(aY,{section:i,"data-sentry-element":"SectionContent","data-sentry-source-file":"DiskUsage.tsx",children:[h&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),m&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve usage data",error:g}),x&&(0,r.jsxs)("div",{className:"space-y-4",children:[d&&(null==l?void 0:l.usage_billing_enabled)===!1&&f&&(0,r.jsxs)(e6.bZ,{variant:"warning",children:[(0,r.jsx)(e8.ku,{}),(0,r.jsx)(e6.Cd,{children:"Projects exceeding quota"}),(0,r.jsx)(e6.X,{children:"You have projects that are exceeding 8 GB of provisioned disk size, but do not allow any overages with the Spend Cap on. Reduce the disk size or disable the spend cap."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)("p",{className:"text-sm",children:[i.name," usage"]})})}),(0,r.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,r.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",null==l?void 0:null===(t=l.plan)||void 0===t?void 0:t.name," Plan"]}),(0,r.jsx)("p",{className:"text-xs",children:"8 GB GP3 disk per project"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Overages in period"}),(0,r.jsxs)("p",{className:"text-xs",children:[(null!==(a=null==j?void 0:j.usage)&&void 0!==a?a:0).toLocaleString()," GP3 GB-Hrs",(null==b?void 0:b.usage)?" / ".concat(b.usage.toLocaleString()," IO2 GB-Hrs"):""]})]})]}),d?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-sm",children:"Current disk size per project"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Breakdown of disk per project. Head to your project's disk management section to see database space used."})]}),0===y.length&&(0,r.jsx)(tL.Z,{children:(0,r.jsx)(tL.Z.Content,{children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsx)("p",{className:"text-sm",children:"No active projects"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"You don't have any active projects in this organization."})]})})}),y.map((e,t)=>{let a=e.databases.filter(e=>"PRIMARY"===e.type).reduce((e,t)=>{var a;return e+(null!==(a=t.disk_volume_size_gb)&&void 0!==a?a:8)},0),n=e.databases.filter(e=>"PRIMARY"!==e.type),s=n.reduce((e,t)=>{var a;return e+(null!==(a=t.disk_volume_size_gb)&&void 0!==a?a:8)},0);return(0,r.jsxs)("div",{className:t!==y.length-1?"border-b pb-2":"",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-foreground-light flex items-center gap-2",children:e.name}),(0,r.jsx)(H.z,{asChild:!0,type:"default",size:"tiny",children:(0,r.jsx)(L(),{href:"/project/".concat(e.ref,"/settings/compute-and-disk"),children:"Manage Disk"})})]}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:(0,r.jsxs)("div",{className:"flex items-center h-6 gap-3",children:[(0,r.jsxs)("span",{className:"text-foreground-light text-sm font-mono flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-foreground font-semibold -mt-[2px]",children:(0,r.jsx)(a4.ZP,{value:a+s,style:{lineHeight:.8},className:"font-mono"})})," ","GB Disk provisioned"]}),(0,r.jsxs)(a5.b,{side:"top",children:[(0,r.jsxs)("p",{children:[a," GB for Primary Database"]}),n.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:[s," GB for ",n.length," Read"," ",1===n.length?"Replica":"Replicas"]}),(0,r.jsx)("p",{className:"mt-1",children:"Read replicas have their own disk and use 25% more disk to account for WAL files."})]})]})]})})]},"usage-project-".concat(e.ref))})]}):(0,r.jsx)(tL.Z,{children:(0,r.jsx)(tL.Z.Content,{children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsx)("p",{className:"text-sm",children:"Data not available"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Switch to current billing cycle to see current disk size per project."})]})})})]})]})})},a6=e=>{let{orgSlug:t,projectRef:a,categoryKey:n,chartMeta:s,subscription:i,currentBillingCycleSelected:o}=e,{data:d,error:c,isLoading:u,isError:m,isSuccess:p}=(0,e3.v)({orgSlug:t}),h=(0,aB.ty)(i).find(e=>e.key===n);return h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l._S,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"UsageSection.tsx",children:(0,r.jsx)(aU,{title:h.name,description:h.description,"data-sentry-element":"SectionHeader","data-sentry-source-file":"UsageSection.tsx"})}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"UsageSection.tsx"}),h.attributes.map(e=>"diskSize"===e.key?(0,r.jsx)(a3,{slug:t,projectRef:a,attribute:e,subscription:i,currentBillingCycleSelected:o,usage:d},e.name):(0,r.jsx)(a$,{slug:t,projectRef:a,attribute:e,usage:d,usageMeta:null==d?void 0:d.usages.find(t=>t.metric===e.key),chartMeta:s,subscription:i,error:c,isLoading:u,isError:m,isSuccess:p,currentBillingCycleSelected:o},e.name))]}):null},a8=e=>{var t,a,n,s,i,l;let{orgSlug:o,projectRef:d,subscription:c,startDate:u,endDate:m,currentBillingCycleSelected:p}=e,{data:h,isLoading:x}=(0,K.L6)({orgSlug:o,projectRef:d,metric:K.tk.MONTHLY_ACTIVE_USERS,interval:"1d",startDate:u,endDate:m}),{data:g,isLoading:y}=(0,K.L6)({orgSlug:o,projectRef:d,metric:K.tk.MONTHLY_ACTIVE_SSO_USERS,interval:"1d",startDate:u,endDate:m}),{data:f,isLoading:v}=(0,K.L6)({orgSlug:o,projectRef:d,metric:K.tk.STORAGE_IMAGES_TRANSFORMED,interval:"1d",startDate:u,endDate:m}),{data:j,isLoading:b}=(0,K.L6)({orgSlug:o,projectRef:d,metric:K.tk.FUNCTION_INVOCATIONS,interval:"1d",startDate:u,endDate:m}),{data:S,isLoading:N}=(0,K.L6)({orgSlug:o,projectRef:d,metric:K.tk.REALTIME_MESSAGE_COUNT,interval:"1d",startDate:u,endDate:m}),{data:w,isLoading:_}=(0,K.L6)({orgSlug:o,projectRef:d,metric:K.tk.REALTIME_PEAK_CONNECTIONS,interval:"1d",startDate:u,endDate:m}),C={[K.tk.MONTHLY_ACTIVE_USERS]:{data:null!==(t=null==h?void 0:h.data)&&void 0!==t?t:[],margin:18,isLoading:x},[K.tk.MONTHLY_ACTIVE_SSO_USERS]:{data:null!==(a=null==g?void 0:g.data)&&void 0!==a?a:[],margin:20,isLoading:y},[K.tk.STORAGE_IMAGES_TRANSFORMED]:{data:null!==(n=null==f?void 0:f.data)&&void 0!==n?n:[],margin:0,isLoading:v},[K.tk.FUNCTION_INVOCATIONS]:{data:null!==(s=null==j?void 0:j.data)&&void 0!==s?s:[],margin:26,isLoading:b},[K.tk.REALTIME_MESSAGE_COUNT]:{data:null!==(i=null==S?void 0:S.data)&&void 0!==i?i:[],margin:38,isLoading:N},[K.tk.REALTIME_PEAK_CONNECTIONS]:{data:null!==(l=null==w?void 0:w.data)&&void 0!==l?l:[],margin:0,isLoading:_}};return(0,r.jsx)(a6,{orgSlug:o,projectRef:d,categoryKey:"activity",chartMeta:C,subscription:c,currentBillingCycleSelected:p,"data-sentry-element":"UsageSection","data-sentry-component":"Activity","data-sentry-source-file":"Activity.tsx"})},a7=e=>{var t;let{orgSlug:a,projectRef:n,subscription:s,startDate:i,endDate:l,currentBillingCycleSelected:o}=e,{data:d,isLoading:c}=(0,K.L6)({orgSlug:a,projectRef:n,metric:K.tk.EGRESS,interval:"1d",startDate:i,endDate:l}),u={[K.tk.EGRESS]:{data:null!==(t=null==d?void 0:d.data)&&void 0!==t?t:[],margin:16,isLoading:c}};return(0,r.jsx)(a6,{orgSlug:a,projectRef:n,categoryKey:"bandwidth",chartMeta:u,subscription:s,currentBillingCycleSelected:o,"data-sentry-element":"UsageSection","data-sentry-component":"Bandwidth","data-sentry-source-file":"Bandwidth.tsx"})},a9=a(22216);async function ne(e,t){let{orgSlug:a,startDate:n,endDate:s,projectRef:r}=e;if(!a)throw Error("Org slug is required");if(!n)throw Error("Start date is required");if(!s)throw Error("End date is required");"/platform/organizations/{slug}/daily-stats/compute?&startDate=".concat(encodeURIComponent(n),"&endDate=").concat(encodeURIComponent(s));let{data:i,error:l}=await (0,b.U2)("/platform/organizations/{slug}/daily-stats/compute",{params:{path:{slug:a},query:{projectRef:r,startDate:n,endDate:s}},signal:t});return l&&(0,b.S3)(l),i}let nt=function(e){let{orgSlug:t,startDate:a,endDate:n,projectRef:s,dateFormat:r="DD MMM"}=e,{enabled:i=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(a9.d.orgDailyComputeStats(t,{startDate:a,endDate:n,projectRef:s}),e=>{let{signal:r}=e;return ne({orgSlug:t,startDate:a,endDate:n,projectRef:s},r)},{enabled:i&&void 0!==t&&void 0!==a&&void 0!==n,select:e=>({...e,data:e.data.map(e=>({...e,periodStartFormatted:D()(e.period_start).format(r)}))}),staleTime:36e5,...l})};var na=e=>{var t;let{orgSlug:a,projectRef:n,startDate:s,endDate:i}=e,l=Object.values(K.Hz).map(e=>e.toLowerCase()),{data:o,isLoading:d,error:c,isSuccess:m}=nt({orgSlug:a,projectRef:n,startDate:s,endDate:i}),h=null!==(t=null==o?void 0:o.data)&&void 0!==t?t:[],x={[K.Hz.COMPUTE_HOURS_BRANCH]:"blue",[K.Hz.COMPUTE_HOURS_XS]:"white",[K.Hz.COMPUTE_HOURS_SM]:"green",[K.Hz.COMPUTE_HOURS_MD]:"dark-green",[K.Hz.COMPUTE_HOURS_L]:"yellow",[K.Hz.COMPUTE_HOURS_XL]:"dark-yellow",[K.Hz.COMPUTE_HOURS_2XL]:"orange",[K.Hz.COMPUTE_HOURS_4XL]:"dark-orange",[K.Hz.COMPUTE_HOURS_8XL]:"red",[K.Hz.COMPUTE_HOURS_12XL]:"dark-red",[K.Hz.COMPUTE_HOURS_16XL]:"purple"},g=Object.keys(K.Hz).map(e=>({key:e.toLowerCase(),color:x[e]||"white",name:(0,K.p5)(e)})),y=(0,u.useMemo)(()=>l.filter(e=>h.some(t=>t[e])),[h]),f=(0,u.useMemo)(()=>y.length>0,[y]);return(0,r.jsx)("div",{id:"compute",className:"scroll-my-12","data-sentry-component":"Compute","data-sentry-source-file":"Compute.tsx",children:(0,r.jsxs)(aY,{section:{name:"Compute Hours",description:"Amount of hours your projects were active. Each project is a dedicated server and database.\nPaid plans come with $10 in Compute Credits to cover one project running on Micro Compute or parts of any compute add-on.\nBilling is based on the sum of Compute Hours used. Paused projects do not count towards usage.",links:[{name:"Compute Add-ons",url:"https://supabase.com/docs/guides/platform/compute-add-ons"},{name:"Usage-billing for Compute",url:"https://supabase.com/docs/guides/platform/org-based-billing#billing-for-compute-compute-hours"}]},"data-sentry-element":"SectionContent","data-sentry-source-file":"Compute.tsx",children:[d&&(0,r.jsx)(v.A,{}),null!=c&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve usage data",error:c}),m&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"space-y-1",children:[h.length>0&&(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsx)("p",{className:"text-sm",children:"Compute Hours usage"})})}),y.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between border-b last:border-b-0 py-1 last:py-0",children:[(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,r.jsx)("span",{className:"font-medium",children:(0,K.p5)(e.toUpperCase())})," ","Compute Hours usage in period"]}),(0,r.jsxs)("p",{className:"text-sm",children:[h.reduce((t,a)=>{var n;return t+(null!==(n=a[e])&&void 0!==n?n:0)},0)," hours"]})]},e))]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-sm",children:"Compute Hours usage per day"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"The data refreshes every hour."})]}),d?(0,r.jsx)(v.A,{}):h.length>0&&f?(0,r.jsx)(aJ.Z,{name:"Compute Hours usage",unit:"hours",attributes:g,data:h,yMin:24}):(0,r.jsx)(tL.Z,{children:(0,r.jsx)(tL.Z.Content,{children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsx)(aG.Z,{className:"text-foreground-light mb-2"}),(0,r.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to one hour to show"})]})})})]})]})})},nn=e=>{var t,a;let{orgSlug:n,projectRef:s,startDate:i,endDate:l,subscription:o,currentBillingCycleSelected:d}=e,{data:c,isLoading:u}=(0,K.L6)({orgSlug:n,projectRef:s,metric:K.tk.DATABASE_SIZE,interval:"1d",startDate:i,endDate:l}),{data:m,isLoading:p}=(0,K.L6)({orgSlug:n,projectRef:s,metric:K.tk.STORAGE_SIZE,interval:"1d",startDate:i,endDate:l}),h={[K.tk.DATABASE_SIZE]:{isLoading:u,margin:14,data:null!==(t=null==c?void 0:c.data)&&void 0!==t?t:[]},[K.tk.STORAGE_SIZE]:{isLoading:p,margin:14,data:null!==(a=null==m?void 0:m.data)&&void 0!==a?a:[]}};return(0,r.jsx)(a6,{orgSlug:n,projectRef:s,categoryKey:"sizeCount",chartMeta:h,subscription:o,currentBillingCycleSelected:d,"data-sentry-element":"UsageSection","data-sentry-component":"SizeAndCounts","data-sentry-source-file":"SizeAndCounts.tsx"})};let ns=[{key:K.tk.DATABASE_SIZE,name:"Database Size",units:"bytes",anchor:"dbSize",category:"Database",unitName:"GB"},{key:K.tk.EGRESS,name:"Egress",units:"bytes",anchor:"egress",category:"Database",unitName:"GB"},{key:K.tk.MONTHLY_ACTIVE_USERS,name:"Monthly Active Users",units:"absolute",anchor:"mau",category:"Authentication",unitName:"MAU"},{key:K.tk.MONTHLY_ACTIVE_SSO_USERS,name:"Monthly Active SSO Users",units:"absolute",anchor:"mauSso",category:"Authentication",unitName:"MAU"},{key:K.tk.MONTHLY_ACTIVE_THIRD_PARTY_USERS,name:"Monthly Active Third-Party Users",units:"absolute",category:"Authentication",unitName:"MAU"},{key:K.tk.STORAGE_SIZE,name:"Storage Size",units:"bytes",anchor:"storageSize",category:"Storage",unitName:"GB"},{key:K.tk.STORAGE_IMAGES_TRANSFORMED,name:"Storage Image Transformations",units:"absolute",anchor:"storageImageTransformations",category:"Storage"},{key:K.tk.REALTIME_PEAK_CONNECTIONS,name:"Realtime Peak Connections",units:"absolute",anchor:"realtimePeakConnections",category:"Realtime"},{key:K.tk.REALTIME_MESSAGE_COUNT,name:"Realtime Messages",units:"absolute",anchor:"realtimeMessageCount",category:"Realtime"},{key:K.tk.FUNCTION_INVOCATIONS,name:"Edge Function Invocations",units:"absolute",anchor:"funcInvocations",category:"Edge Functions"},{key:K.tk.DISK_SIZE_GB_HOURS_GP3,name:"Disk Size",anchor:"diskSize",units:"absolute",unitName:"GB-Hrs",category:"Database",tip:"Each project gets provisioned with 8 GB of GP3 disk for free. When you get close to the disk size limit, we autoscale your disk by 1.5x. Each GB of provisioned disk size beyond 8 GB incurs a GB-Hr every hour. Each extra GB is billed at $0.125/month ($0.000171/GB-Hr), prorated down to the hour.",docLink:{title:"Read more",url:"https://supabase.com/docs/guides/platform/org-based-billing#disk-size"}},{key:K.tk.DISK_SIZE_GB_HOURS_IO2,name:"Disk Size IO2",anchor:"diskSize",units:"absolute",unitName:"GB-Hrs",category:"Database"},{key:K.tk.DISK_IOPS_IO2,name:"Disk IOPS IO2",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:K.tk.DISK_IOPS_GP3,name:"Disk IOPS GP3",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:K.tk.DISK_THROUGHPUT_GP3,name:"Disk Throughput",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:K.tk.LOG_DRAIN_EVENTS,name:"Log Drain Events",units:"absolute",category:"Database"}];var nr=a(31900),ni=e=>{var t;let{slug:a,metric:n,usage:s,subscription:i,relativeToSubscription:l}=e,o=s.usages.find(e=>e.metric===n.key),d=(0,u.useMemo)(()=>{var e,t,a,s;return o?l&&!1===o.available_in_plan?"Unavailable in plan":o.cost&&o.cost>0||!l||o.unlimited||0===o.pricing_free_units?"bytes"===n.units||"gigabytes"===n.units?"".concat(null!==(e=o.usage.toLocaleString())&&void 0!==e?e:0," GB"):o.usage.toLocaleString()+(n.unitName?" ".concat(n.unitName):""):"bytes"===n.units||"gigabytes"===n.units?"".concat(null!==(a=o.usage.toLocaleString())&&void 0!==a?a:0," / ").concat(null!==(s=o.pricing_free_units)&&void 0!==s?s:0," GB"):"".concat(o.usage.toLocaleString()," / ").concat(null===(t=o.pricing_free_units)||void 0===t?void 0:t.toLocaleString())+(n.unitName?" ".concat(n.unitName):""):""},[o,l,n]),c=(0,u.useMemo)(()=>o&&o.project_allocations?o.project_allocations.sort((e,t)=>t.usage-e.usage):[],[o]);if(!o)return null;let m=0===o.usage?0:o.usage/(null!==(t=o.pricing_free_units)&&void 0!==t?t:0),p=(null==i?void 0:i.usage_billing_enabled)===!0,h=!1==!!o.unlimited,x=h&&m>=.8,g=l&&h&&m>=1,y=ee(o.metric),f=0===o.usage||0===o.pricing_free_units?"":m<.01?"(<1%)":"(".concat((+(100*m).toFixed(0)).toLocaleString(),"%)");return(0,r.jsxs)(nr.zs,{openDelay:50,closeDelay:200,"data-sentry-element":"HoverCard","data-sentry-component":"BillingMetric","data-sentry-source-file":"BillingMetric.tsx",children:[(0,r.jsx)(nr.Yi,{asChild:!0,"data-sentry-element":"HoverCardTrigger","data-sentry-source-file":"BillingMetric.tsx",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(L(),{href:"/org/".concat(a,"/usage#").concat(n.anchor),className:"block w-full group","data-sentry-element":"Link","data-sentry-source-file":"BillingMetric.tsx",children:[n.anchor?(0,r.jsxs)("div",{className:"group flex items-center gap-1",children:[(0,r.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:n.name}),o.available_in_plan&&(0,r.jsx)("span",{className:"transition inline-block group-hover:transform group-hover:translate-x-0.5",children:(0,r.jsx)(U.Z,{strokeWidth:1.5,size:16,className:"transition"})})]}):(0,r.jsx)("p",{className:"text-xs text-foreground-light flex space-x-1",children:n.name}),(0,r.jsx)("span",{className:"text-sm",children:d}),"\xa0",l&&o.cost&&o.cost>0?(0,r.jsxs)("span",{className:"text-sm",children:["(",(0,V.xG)(o.cost),")"]}):o.available_in_plan&&!o.unlimited&&l?(0,r.jsx)("span",{className:"text-sm",children:f}):null]}),o.available_in_plan?(0,r.jsx)("div",{children:l&&!o.unlimited?(0,r.jsxs)("svg",{className:"h-8 w-8 -rotate-90 transform",children:[(0,r.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeWidth:4,className:"text-background-surface-300"}),(0,r.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeDasharray:75.398,strokeDashoffset:"calc(75.39822 - ".concat(m<1?100*m:100," / 100 * 75.39822)"),strokeWidth:4,className:p?"text-gray-dark-800":g?"text-red-900":x?"text-yellow-1000":"text-gray-dark-800"})]}):null}):(0,r.jsx)("div",{children:(0,r.jsx)(H.z,{type:"default",asChild:!0,children:(0,r.jsx)(L(),{href:"/org/".concat(a,"/billing?panel=subscriptionPlan"),children:"Upgrade"})})})]})}),o.available_in_plan&&(0,r.jsx)(nr.bZ,{side:"bottom",align:"center",className:"w-[500px]",animate:"slide-in",children:(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("p",{className:"font-medium",children:o.unit_price_desc}),n.tip&&(0,r.jsx)("div",{className:"my-2",children:(0,r.jsxs)("p",{className:"text-sm",children:[n.tip," ",n.docLink&&(0,r.jsx)(L(),{href:n.docLink.url,target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:n.docLink.title})]})}),!1===i.usage_billing_enabled&&l&&(x||g)&&(0,r.jsx)("div",{className:"my-2",children:(0,r.jsx)("p",{className:"text-sm",children:"Exceeding your plans included usage will lead to restrictions to your project. Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})}),c&&c.length>0&&(0,r.jsxs)("table",{className:"list-disc w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"text-left",children:"Project"}),(0,r.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,r.jsxs)("tbody",{children:[c.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{className:"text-right",children:$(o.metric,e)})]},"".concat(o.metric,"_").concat(e.ref))),(0,r.jsx)("tr",{})]}),(0,r.jsx)("tfoot",{children:(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{className:"py-2 border-t text-left",children:["Total",y&&(0,r.jsxs)("span",{children:[" (",y,")"]})]}),(0,r.jsxs)("td",{className:"py-2 border-t text-right",children:[$(o.metric,{usage:o.usage_original})," "]})]})})]})]})})]})},nl=e=>{let{slug:t,metric:a,usage:n,relativeToSubscription:s}=e,i=n.usages.find(e=>e.metric===a.key),l=(0,u.useMemo)(()=>{var e,t,a,n,s;return(null==i?void 0:i.pricing_free_units)?"".concat(null!==(t=null==i?void 0:null===(e=i.usage)||void 0===e?void 0:e.toLocaleString())&&void 0!==t?t:0," / ").concat(null!==(a=null==i?void 0:i.pricing_free_units)&&void 0!==a?a:0," hours"):"".concat(null!==(s=null==i?void 0:null===(n=i.usage)||void 0===n?void 0:n.toLocaleString())&&void 0!==s?s:0," hours")},[i]),o=(0,u.useMemo)(()=>i&&i.project_allocations?i.project_allocations.sort((e,t)=>t.usage-e.usage):[],[i]);return(0,r.jsxs)(nr.zs,{openDelay:50,closeDelay:200,"data-sentry-element":"HoverCard","data-sentry-component":"ComputeMetric","data-sentry-source-file":"ComputeMetric.tsx",children:[(0,r.jsx)(nr.Yi,{"data-sentry-element":"HoverCardTrigger","data-sentry-source-file":"ComputeMetric.tsx",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(L(),{href:"/org/".concat(t,"/usage#").concat(a.anchor),"data-sentry-element":"Link","data-sentry-source-file":"ComputeMetric.tsx",children:(0,r.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:a.name}),(0,r.jsx)(U.Z,{strokeWidth:1.5,size:16,className:"transition","data-sentry-element":"ChevronRight","data-sentry-source-file":"ComputeMetric.tsx"})]})}),(0,r.jsx)("span",{className:"text-sm",children:l}),"\xa0",s&&(null==i?void 0:i.cost)&&i.cost>0?(0,r.jsxs)("span",{className:"text-sm",children:["(",(0,V.xG)(null==i?void 0:i.cost),")"]}):null]})}),(0,r.jsx)(nr.bZ,{side:"bottom",align:"center",className:"w-[500px]",animate:"slide-in","data-sentry-element":"HoverCardContent","data-sentry-source-file":"ComputeMetric.tsx",children:(0,r.jsxs)("div",{className:"text-sm text-foreground space-y-2",children:[(0,r.jsx)("p",{className:"font-medium",children:null==i?void 0:i.unit_price_desc}),(0,r.jsx)("div",{className:"my-2",children:(0,r.jsxs)("p",{className:"text-sm",children:["Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the compute size of your project. Paused projects do not incur compute costs."," ",(0,r.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/org-based-billing#billing-for-compute-compute-hours",target:"_blank",className:"transition text-brand hover:text-brand-600 underline","data-sentry-element":"Link","data-sentry-source-file":"ComputeMetric.tsx",children:"Read more"})]})}),i&&o.length>0&&(0,r.jsxs)("table",{className:"list-disc w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"text-left",children:"Project"}),(0,r.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,r.jsxs)("tbody",{children:[o.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{className:"text-right",children:$(i.metric,e)})]},"".concat(i.metric,"_").concat(e.ref))),(0,r.jsx)("tr",{})]}),(0,r.jsx)("tfoot",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"py-2 border-t text-left",children:"Total (Hours)"}),(0,r.jsx)("td",{className:"py-2 border-t text-right",children:$(i.metric,{usage:i.usage_original})})]})})]})]})})]})};let no=[K.tk.DISK_IOPS_IO2,K.tk.DISK_IOPS_GP3,K.tk.DISK_SIZE_GB_HOURS_GP3,K.tk.DISK_SIZE_GB_HOURS_IO2,K.tk.DISK_THROUGHPUT_GP3];var nd=e=>{var t,a;let{orgSlug:n,projectRef:s,subscription:i,startDate:l,endDate:o,currentBillingCycleSelected:d}=e,c=null==i?void 0:i.usage_billing_enabled,{data:m,error:h,isLoading:x,isError:g,isSuccess:y}=(0,e3.v)({orgSlug:n,projectRef:s,start:!d&&l?new Date(l):void 0,end:!d&&o?new Date(o):void 0}),f=d&&!s,j=f&&!!(null==m?void 0:m.usages.find(e=>{var t;return!e.metric.startsWith("COMPUTE_")&&!e.unlimited&&e.usage>(null!==(t=null==e?void 0:e.pricing_free_units)&&void 0!==t?t:0)})),b=(0,u.useMemo)(()=>m?ns.filter(e=>m.usages.some(t=>t.metric===e.key)).filter(e=>{if(!no.includes(e.key))return!0;let t=m.usages.find(t=>t.metric===e.key);return t&&t.usage>0}).slice().sort((e,t)=>{var a,n,s,r;let i=m.usages.find(t=>t.metric===e.key),l="number"!=typeof i?(null!==(a=null==i?void 0:i.usage)&&void 0!==a?a:0)/(null!==(n=null==i?void 0:i.pricing_free_units)&&void 0!==n?n:0):0,o=m.usages.find(e=>e.metric===t.key),d="number"!=typeof o?(null!==(s=null==o?void 0:o.usage)&&void 0!==s?s:0)/(null!==(r=null==o?void 0:o.pricing_free_units)&&void 0!==r?r:0):0;return Number(null==o?void 0:o.available_in_plan)-Number(null==i?void 0:i.available_in_plan)||d-l}):[],[m]),S=((null==m?void 0:m.usages)||[]).filter(e=>e.metric.startsWith("COMPUTE")).map(e=>e.metric);return(0,r.jsx)("div",{id:"summary","data-sentry-component":"TotalUsage","data-sentry-source-file":"TotalUsage.tsx",children:(0,r.jsxs)(aY,{section:{name:"Usage Summary",description:c?"Your plan includes a limited amount of usage. If exceeded, you will be charged for the overages. It may take up to 1 hour to refresh.":"Your plan includes a limited amount of usage. If exceeded, you may experience restrictions, as you are currently not billed for overages. It may take up to 1 hour to refresh.",links:[{name:"How billing works",url:"https://supabase.com/docs/guides/platform/org-based-billing"},{name:"Supabase Plans",url:"https://supabase.com/pricing"}]},"data-sentry-element":"SectionContent","data-sentry-source-file":"TotalUsage.tsx",children:[x&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),g&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve usage data",error:h}),y&&i&&(0,r.jsxs)("div",{children:[f&&(0,r.jsx)("p",{className:"text-sm",children:j?j&&(null==i?void 0:null===(t=i.plan)||void 0===t?void 0:t.id)==="free"?(0,r.jsxs)("span",{children:["You have exceeded your"," ",(0,r.jsx)("span",{className:"font-medium",children:null==i?void 0:i.plan.name})," Plan quota in this billing cycle. Upgrade your plan to continue using Supabase without restrictions."]}):j&&(null==i?void 0:i.usage_billing_enabled)===!1&&(null==i?void 0:null===(a=i.plan)||void 0===a?void 0:a.id)==="pro"?(0,r.jsxs)("span",{children:["You have exceeded your"," ",(0,r.jsx)("span",{className:"font-medium",children:null==i?void 0:i.plan.name})," Plan quota in this billing cycle. Disable your spend cap to continue using Supabase without restrictions."]}):j&&(null==i?void 0:i.usage_billing_enabled)===!0?(0,r.jsxs)("span",{children:["You have exceeded your"," ",(0,r.jsx)("span",{className:"font-medium",children:null==i?void 0:i.plan.name})," Plan quota in this billing cycle and will be charged for over-usage."]}):(0,r.jsxs)("span",{children:["You have not exceeded your"," ",(0,r.jsx)("span",{className:"font-medium",children:null==i?void 0:i.plan.name})," Plan quota in this billing cycle."]}):(0,r.jsxs)("span",{children:["You have not exceeded your"," ",(0,r.jsx)("span",{className:"font-medium",children:null==i?void 0:i.plan.name})," Plan quota in this billing cycle."]})}),(0,r.jsxs)("div",{className:"grid grid-cols-12 mt-3",children:[b.map((e,t)=>(0,r.jsx)("div",{className:(0,W.cn)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",t%2==0?"md:border-r md:pr-4":"md:pl-4","border-b"),children:(0,r.jsx)(ni,{idx:t,slug:n,metric:e,usage:m,subscription:i,relativeToSubscription:f})},e.key)),S.map((e,t)=>(0,r.jsx)("div",{className:(0,W.cn)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",(t+b.length)%2==0?"md:border-r md:pr-4":"md:pl-4","border-b"),children:(0,r.jsx)(nl,{slug:n,metric:{key:e,name:(0,K.p5)(e)+" Compute Hours",units:"hours",anchor:"compute",category:"Compute",unitName:"GB"},relativeToSubscription:f,usage:m})},e))]})]})]})})},nc=()=>{let{slug:e,projectRef:t}=(0,i.UO)(),[a,n]=(0,u.useState)(),[s,o]=(0,u.useState)(),m=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),h=(0,k.l)(),{data:x,isSuccess:g}=(0,tc.Sy)(),{data:f,error:j,isLoading:b,isError:N,isSuccess:w}=(0,d.Gl)({orgSlug:e}),_=null==x?void 0:x.filter(e=>e.organization_id===(null==h?void 0:h.id));(0,u.useEffect)(()=>{t&&g&&void 0!==_&&_.find(e=>e.ref===t)&&o(t)},[t,g]);let C=(0,u.useMemo)(()=>{var e;return D().unix(null!==(e=null==f?void 0:f.current_period_start)&&void 0!==e?e:0).utc()},[f]),A=(0,u.useMemo)(()=>{var e;return D().unix(null!==(e=null==f?void 0:f.current_period_end)&&void 0!==e?e:0).utc()},[f]),I=(0,u.useMemo)(()=>null==a||!a.period_start||null==a||!a.period_end||D()(a.period_start.date).isSame(C)&&D()(a.period_end.date).isSame(A),[a,C,A]),T=(0,u.useMemo)(()=>{var e,t;if(null==a?void 0:null===(e=a.period_start)||void 0===e?void 0:e.date)return new Date(null==a?void 0:null===(t=a.period_start)||void 0===t?void 0:t.date).toISOString().slice(0,-5)+"Z"},[a,f]),E=(0,u.useMemo)(()=>{var e,t;return(null==a?void 0:null===(e=a.period_end)||void 0===e?void 0:e.date)&&D()(a.period_end.date).isAfter(D()())?D()().endOf("day").toISOString().slice(0,-5)+"Z":(null==a?void 0:null===(t=a.period_end)||void 0===t?void 0:t.date)?new Date(a.period_end.date).toISOString().slice(0,-5)+"Z":void 0},[a,f]),M=s?null==_?void 0:_.find(e=>e.ref===s):void 0;return m?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l._S,{className:"sticky top-0 border-b bg-studio z-10 overflow-hidden","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Usage.tsx",children:(0,r.jsxs)("div",{className:"py-4 flex items-center space-x-4",children:[b&&(0,r.jsx)(v.Z,{className:"w-[250px]"}),N&&(0,r.jsx)(p.Z,{className:"w-full",subject:"Failed to retrieve usage data",error:j}),w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(aO.Z,{onChange:n,value:aL.eB[0].key,options:[...aL.eB,...aL._T],loading:b,currentBillingPeriodStart:null==f?void 0:f.current_period_start,currentBillingPeriodEnd:null==f?void 0:f.current_period_end}),(0,r.jsxs)(P.Z,{size:"tiny",name:"schema",className:"w-[180px]",value:s,onChange:e=>{"all-projects"===e?o(void 0):o(e)},children:[(0,r.jsx)(P.Z.Option,{id:"all-projects",label:"All projects",value:"all-projects",children:"All projects"},"all-projects"),null==_?void 0:_.map(e=>(0,r.jsx)(P.Z.Option,{id:e.ref,value:e.ref,label:e.name,children:e.name},e.ref))]}),(0,r.jsxs)("div",{className:"flex flex-col xl:flex-row xl:gap-3",children:[(0,r.jsxs)("p",{className:(0,W.cn)("text-sm transition",b&&"opacity-50"),children:["Organization is on the ",f.plan.name," plan"]}),(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:[C.format("DD MMM YYYY")," -"," ",A.format("DD MMM YYYY")]})]})]})]})}),s?(0,r.jsx)(l._S,{className:"mt-5",children:(0,r.jsx)(e1.J,{type:"default",title:"Usage filtered by project",description:'You are currently viewing usage for the "'.concat((null==M?void 0:M.name)||s,'" project. Supabase uses organization-level billing and quotas. For billing purposes, we sum up usage from\n                  all your projects. To view your usage quota, set the project filter above back to\n                  "All Projects".'),children:(0,r.jsx)(aT.G,{abbrev:!1,href:"https://supabase.com/docs/guides/platform/org-based-billing"})})}):(0,r.jsx)(l._S,{id:"restriction",className:"mt-5",children:(0,r.jsx)(e7,{})}),(0,r.jsx)(nd,{orgSlug:e,projectRef:s,subscription:f,startDate:T,endDate:E,currentBillingCycleSelected:I,"data-sentry-element":"TotalUsage","data-sentry-source-file":"Usage.tsx"}),(null==f?void 0:f.plan.id)!=="free"&&(0,r.jsx)(na,{orgSlug:e,projectRef:s,subscription:f,startDate:T,endDate:E}),(0,r.jsx)(a7,{orgSlug:e,projectRef:s,subscription:f,startDate:T,endDate:E,currentBillingCycleSelected:I,"data-sentry-element":"Bandwidth","data-sentry-source-file":"Usage.tsx"}),(0,r.jsx)(nn,{orgSlug:e,projectRef:s,subscription:f,startDate:T,endDate:E,currentBillingCycleSelected:I,"data-sentry-element":"SizeAndCounts","data-sentry-source-file":"Usage.tsx"}),(0,r.jsx)(a8,{orgSlug:e,projectRef:s,subscription:f,startDate:T,endDate:E,currentBillingCycleSelected:I,"data-sentry-element":"Activity","data-sentry-source-file":"Usage.tsx"})]}):(0,r.jsx)(l.gW,{children:(0,r.jsx)(y.Z,{resourceText:"view organization usage"})})},nu=a(17542),nm=a(51478),np=a(24544),nh=a(98038),nx=a(11885),ng=a.n(nx),ny=a(93553),nf=a(47676),nv=a(97705),nj=a(86427);let nb=["Owner","Administrator","Developer","Read-only"];async function nS(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let{data:n,error:s}=await (0,b.U2)("/platform/organizations/{slug}/roles",{params:{path:{slug:a}},headers:{Version:"2"},signal:t});return s&&(0,b.S3)(s),n}let nN=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(nj.O.rolesV2(t),e=>{let{signal:a}=e;return nS({slug:t},a)},{enabled:a&&void 0!==t,select:e=>({...e,org_scoped_roles:e.org_scoped_roles.sort((e,t)=>nb.indexOf(e.name)-nb.indexOf(t.name))}),...n})};var nw=a(55410);async function n_(e,t){let{slug:a,iso_timestamp_start:n,iso_timestamp_end:s,project_refs:r}=e;if(!a)throw Error("slug is required");let i=await (0,nw.U2)("".concat(eh.T5,"/organizations/").concat(a,"/audit?iso_timestamp_start=").concat(n,"&iso_timestamp_end=").concat(s),{signal:t});if(i.error)throw i.error;return i}let nC=function(e){let{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{slug:n,iso_timestamp_start:s,iso_timestamp_end:r}=e,i=D()(s).utc().format("YYYY-MM-DD"),l=D()(r).utc().format("YYYY-MM-DD");return(0,j.a)(N.O.auditLogs(n,{date_start:i,date_end:l}),t=>{let{signal:a}=t;return n_(e,a)},{enabled:t&&void 0!==n,...a})};async function nA(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let[n,s]=await Promise.all([(0,b.U2)("/platform/organizations/{slug}/members",{params:{path:{slug:a}},signal:t}),(0,b.U2)("/platform/organizations/{slug}/members/invitations",{params:{path:{slug:a}},signal:t})]),{data:r,error:i}=n,{data:l,error:o}=s;return i&&(0,b.S3)(i),o&&(0,b.S3)(o),[...r,...l.invitations.map(e=>({invited_at:e.invited_at,invited_id:e.id,mfa_enabled:!1,username:e.invited_email.slice(0,1),primary_email:e.invited_email,role_ids:[e.role_id]}))]}let nI=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(N.O.members(t),e=>{let{signal:a}=e;return nA({slug:t},a)},{enabled:a&&void 0!==t,...n})};var nT=()=>{var e,t,a,n,s,o,d,m;let{slug:h}=(0,i.UO)(),x=D()().utc().set("millisecond",0),[g,f]=(0,u.useState)(!0),[j,b]=(0,u.useState)({from:x.subtract(1,"day").toISOString(),to:x.toISOString()}),[N,w]=(0,u.useState)(),[_,C]=(0,u.useState)({users:[],projects:[]}),A=(0,S.Xo)(c.KA.READ,"notifications"),{data:I}=(0,tc.Sy)(),{data:T}=(0,el.tl)(),{data:k}=nI({slug:h}),{data:E}=nN({slug:h}),{data:M,error:P,isLoading:R,isSuccess:z,isError:Z,isRefetching:O,refetch:U}=nC({slug:h,iso_timestamp_start:j.from,iso_timestamp_end:j.to},{enabled:A,retry:(e,t)=>!t.message.endsWith("upgrade to Team or Enterprise Plan to access audit logs."),retryOnMount:!1,refetchOnWindowFocus:!1});(0,u.useEffect)(()=>{let e=D()(j.from).diff(D()(j.to)),t=setInterval(()=>{let t=D()().utc().set("millisecond",0);b({from:t.add(e).toISOString(),to:t.toISOString()})},3e5);return()=>clearInterval(t)},[j.from,j.to]);let B=[...null!==(a=null==E?void 0:E.org_scoped_roles)&&void 0!==a?a:[],...null!==(n=null==E?void 0:E.project_scoped_roles)&&void 0!==n?n:[]],F=null!==(s=null==M?void 0:M.retention_period)&&void 0!==s?s:0,G=null!==(o=null==M?void 0:M.result)&&void 0!==o?o:[],Y=null==G?void 0:null===(t=G.sort((e,t)=>g?Number(new Date(t.occurred_at))-Number(new Date(e.occurred_at)):Number(new Date(e.occurred_at))-Number(new Date(t.occurred_at))))||void 0===t?void 0:null===(e=t.filter(e=>_.users.length>0?_.users.includes(e.actor.id):e))||void 0===e?void 0:e.filter(e=>_.projects.length>0?_.projects.includes(e.target.metadata.project_ref||""):e),V=null==T?void 0:T.find(e=>e.slug===h);return A?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.gW,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-source-file":"AuditLogs.tsx",children:(0,r.jsxs)("div",{className:"space-y-4 flex flex-col",children:[R&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),Z?P.message.endsWith("upgrade to Team or Enterprise Plan to access audit logs.")?(0,r.jsxs)(e6.bZ,{variant:"default",title:"Organization Audit Logs are not available on Free or Pro plans",children:[(0,r.jsx)(e8.aN,{}),(0,r.jsxs)("div",{className:"flex flex-row pt-1",children:[(0,r.jsxs)("div",{className:"grow",children:[(0,r.jsx)(e6.Cd,{children:"Organization Audit Logs are not available on Free or Pro plans"}),(0,r.jsx)(e6.X,{className:"flex flex-row justify-between gap-3",children:(0,r.jsx)("p",{children:"Upgrade to Team or Enterprise to view up to 28 days of Audit Logs for your organization."})})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(H.z,{type:"primary",asChild:!0,children:(0,r.jsx)(L(),{href:"/org/".concat(h,"/billing?panel=subscriptionPlan"),children:"Upgrade subscription"})})})]})]}):(0,r.jsx)(p.Z,{error:P,subject:"Failed to retrieve audit logs"}):null,z&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-xs prose",children:"Filter by"}),(0,r.jsx)(nv.E,{name:"Users",options:null!=k?k:[],labelKey:"username",valueKey:"gotrue_id",activeOptions:_.users,onSaveFilters:e=>C({..._,users:e})}),(0,r.jsx)(nv.E,{name:"Projects",options:null!==(d=null==I?void 0:I.filter(e=>e.organization_id===(null==V?void 0:V.id)))&&void 0!==d?d:[],labelKey:"name",valueKey:"ref",activeOptions:_.projects,onSaveFilters:e=>C({..._,projects:e})}),(0,r.jsx)(nf.M,{hideTime:!0,hideClear:!0,triggerButtonType:"dashed",triggerButtonTitle:"",from:j.from,to:j.to,minDate:D()().subtract(F,"days").toDate(),maxDate:D()().toDate(),onChange:e=>{if(null!==e.from&&null!==e.to){let t=D()().utc();b({from:D()(e.from).utc().hour(t.hour()).minute(t.minute()).second(t.second()).toISOString(),to:D()(e.to).utc().hour(t.hour()).minute(t.minute()).second(t.second()).toISOString()})}},renderFooter:()=>(0,r.jsx)(e1.J,{showIcon:!1,type:"default",className:"w-auto mx-2 px-3 py-2",children:(0,r.jsxs)("div",{className:"text-xs text-foreground-light",children:["Your organization has a log retention period of"," ",(0,r.jsxs)("span",{className:"text-brand",children:[F," day",F>1?"s":""]}),". You may only view logs from"," ",D()().subtract(F,"days").format("DD MMM YYYY")," as the earliest date."]})})}),z&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"h-[20px] border-r border-strong !ml-4 !mr-2"}),(0,r.jsxs)("p",{className:"prose text-xs",children:["Viewing ",Y.length," logs in total"]})]})]}),(0,r.jsx)(H.z,{type:"default",disabled:R||O,icon:(0,r.jsx)(nu.Z,{className:O?"animate-spin":""}),onClick:()=>U(),children:O?"Refreshing":"Refresh"})]}),0===G.length?(0,r.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,r.jsx)("p",{className:"prose text-sm",children:"Your organization does not have any audit logs available yet"})}):G.length>0&&0===Y.length?(0,r.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,r.jsx)("p",{className:"prose text-sm",children:"No audit logs found based on the filters applied"})}):(0,r.jsx)(ef.Z,{head:[(0,r.jsx)(ef.Z.th,{className:"py-2",children:"User"},"user"),(0,r.jsx)(ef.Z.th,{className:"py-2",children:"Action"},"action"),(0,r.jsx)(ef.Z.th,{className:"py-2",children:"Target"},"target"),(0,r.jsx)(ef.Z.th,{className:"py-2",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{children:"Date"}),(0,r.jsx)(ts.u,{type:"text",className:"px-1",icon:g?(0,r.jsx)(nm.Z,{strokeWidth:1.5,size:14}):(0,r.jsx)(np.Z,{strokeWidth:1.5,size:14}),onClick:()=>f(!g),tooltip:{content:{side:"bottom",text:g?"Sort latest first":"Sort earliest first"}}})]})},"date"),(0,r.jsx)(ef.Z.th,{className:"py-2"},"actions")],body:null!==(m=null==Y?void 0:Y.map(e=>{var t,a,n,s,i,l,o,d,c;let u=(null!=k?k:[]).find(t=>t.gotrue_id===e.actor.id),m=B.find(e=>{var t;return(null==u?void 0:null===(t=u.role_ids)||void 0===t?void 0:t[0])===e.id}),p=null==I?void 0:I.find(t=>t.ref===e.target.metadata.project_ref),h=null==T?void 0:T.find(t=>t.slug===e.target.metadata.org_slug),x=(null===(t=e.action.metadata[0])||void 0===t?void 0:t.status)!==void 0,g=void 0===u?(0,r.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,r.jsx)("p",{children:"?"})}):(null==u?void 0:u.invited_id)||(null==u?void 0:u.username)===(null==u?void 0:u.primary_email)?(0,r.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,r.jsx)(nh.Z,{size:18,strokeWidth:2})}):(0,r.jsx)(ng(),{alt:null==u?void 0:u.username,src:"https://github.com/".concat(null!==(a=null==u?void 0:u.username)&&void 0!==a?a:"",".png?size=80"),width:"30",height:"30",className:"border rounded-full"});return(0,r.jsxs)(ef.Z.tr,{onClick:()=>w(e),className:"cursor-pointer hover:!bg-alternative transition duration-100",children:[(0,r.jsx)(ef.Z.td,{children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{children:g}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-foreground-light",children:null!==(n=null==u?void 0:u.username)&&void 0!==n?n:"-"}),m&&(0,r.jsx)("p",{className:"mt-0.5 text-xs text-foreground-light",children:null==m?void 0:m.name})]})]})}),(0,r.jsx)(ef.Z.td,{className:"max-w-[250px]",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[x&&(0,r.jsx)("p",{className:"bg-surface-200 rounded px-1 flex items-center justify-center text-xs font-mono border",children:e.action.metadata[0].status}),(0,r.jsx)("p",{className:"truncate",title:e.action.name,children:e.action.name})]})}),(0,r.jsxs)(ef.Z.td,{children:[(0,r.jsxs)("p",{className:"text-foreground-light max-w-[230px] truncate",title:null!==(i=null!==(s=null==p?void 0:p.name)&&void 0!==s?s:null==h?void 0:h.name)&&void 0!==i?i:"-",children:[(null==p?void 0:p.name)?"Project: ":(null==h?void 0:h.name)?"Organization: ":null,null!==(o=null!==(l=null==p?void 0:p.name)&&void 0!==l?l:null==h?void 0:h.name)&&void 0!==o?o:"Unknown"]}),(0,r.jsxs)("p",{className:"text-foreground-light text-xs mt-0.5 truncate",title:null!==(d=e.target.metadata.project_ref)&&void 0!==d?d:e.target.metadata.org_slug,children:[e.target.metadata.project_ref?"Ref: ":e.target.metadata.org_slug?"Slug: ":null,null!==(c=e.target.metadata.project_ref)&&void 0!==c?c:e.target.metadata.org_slug]})]}),(0,r.jsx)(ef.Z.td,{children:D()(e.occurred_at).format("DD MMM YYYY, HH:mm:ss")}),(0,r.jsx)(ef.Z.td,{align:"right",children:(0,r.jsx)(H.z,{type:"default",children:"View details"})})]},e.occurred_at)}))&&void 0!==m?m:[]})]})]})}),(0,r.jsx)(ny.h,{selectedLog:N,onClose:()=>w(void 0),"data-sentry-element":"LogDetailsPanel","data-sentry-source-file":"AuditLogs.tsx"})]}):(0,r.jsx)(l.gW,{children:(0,r.jsx)(y.Z,{resourceText:"view organization audit logs"})})};let nk=e=>[e,"oauth-apps"],nE=e=>[e,"authorized-apps"];async function nM(e,t){let{slug:a}=e;if(!a)throw Error("Organization slug is required");let n=await (0,nw.U2)("".concat(eh.T5,"/organizations/").concat(a,"/oauth/apps?type=authorized"),{signal:t});if(n.error)throw n.error;return n}let nP=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(nE(t),e=>{let{signal:a}=e;return nM({slug:t},a)},{enabled:a&&void 0!==t,...n})};async function nR(e,t){let{slug:a}=e;if(!a)throw Error("Organization slug is required");let n=await (0,nw.U2)("".concat(eh.T5,"/organizations/").concat(a,"/oauth/apps?type=published"),{signal:t});if(n.error)throw n.error;return n}let nz=function(e){let{slug:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.a)(nk(t),e=>{let{signal:a}=e;return nR({slug:t},a)},{enabled:a&&void 0!==t,...n})};var nZ=a(17471),nD=e=>{let{app:t,onSelectRevoke:a}=e;return(0,r.jsxs)(ef.Z.tr,{"data-sentry-element":"unknown","data-sentry-component":"AuthorizedAppRow","data-sentry-source-file":"AuthorizedAppRow.tsx",children:[(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:(0,r.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:t.icon?"url('".concat(t.icon,"')"):"none"},children:t.icon?"":"".concat(t.name[0])})}),(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:t.name}),(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:D()(t.authorized_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,r.jsx)(ef.Z.td,{align:"right","data-sentry-element":"unknown","data-sentry-source-file":"AuthorizedAppRow.tsx",children:(0,r.jsx)(H.z,{type:"default",icon:(0,r.jsx)(nZ.Z,{}),className:"px-1",onClick:()=>a(),"data-sentry-element":"Button","data-sentry-source-file":"AuthorizedAppRow.tsx"})})]})},nO=a(67328);async function nL(e){let{id:t,slug:a}=e;if(!t)throw Error("OAuth app ID is required");if(!a)throw Error("Organization slug is required");let n=await (0,nw.$v)("".concat(eh.T5,"/organizations/").concat(a,"/oauth/apps/").concat(t,"?type=published"));if(n.error)throw n.error;return n}let nU=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>nL(e),{async onSuccess(t,a,s){let{slug:r}=a;await n.invalidateQueries(nk(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to delete application: ".concat(e.message)):t(e,a,n)},...a})};var nB=e=>{let{selectedApp:t,onClose:a}=e,{slug:n}=(0,i.UO)(),{mutate:s,isLoading:l}=nU({onSuccess:()=>{m.Am.success('Successfully deleted the app "'.concat(null==t?void 0:t.name,'"')),a()}}),o=async()=>n?(null==t?void 0:t.id)?void s({slug:n,id:null==t?void 0:t.id}):console.error("App ID is required"):console.error("Slug is required");return(0,r.jsxs)(eP.Z,{size:"medium",alignFooter:"right",header:"Confirm to delete ".concat(null==t?void 0:t.name),visible:void 0!==t,loading:l,onCancel:a,onConfirm:o,"data-sentry-element":"Modal","data-sentry-component":"DeleteAppModal","data-sentry-source-file":"DeleteAppModal.tsx",children:[(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"DeleteAppModal.tsx",children:(0,r.jsx)(e1.J,{type:"warning",title:"This action cannot be undone",description:"Deleting ".concat(null==t?void 0:t.name," will invalidate any access tokens from this application that\n          were authorized by users."),"data-sentry-element":"Admonition","data-sentry-source-file":"DeleteAppModal.tsx"})}),(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"DeleteAppModal.tsx",children:(0,r.jsx)("ul",{className:"space-y-5",children:(0,r.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,r.jsx)(nO.Z,{size:14,className:"flex-shrink-0","data-sentry-element":"Lock","data-sentry-source-file":"DeleteAppModal.tsx"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Before you remove this application, consider:"}),(0,r.jsx)("ul",{className:"space-y-2 mt-2",children:(0,r.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. It will no longer be available for use after deletion."})})]})]})})})]})},nF=a(29356),nG=a(15628),nY=a(18656),nV=e=>{let{app:t,onSelectEdit:a,onSelectDelete:n}=e,[s,i]=(0,u.useState)(!1),l=(0,S.Xo)(c.KA.UPDATE,"approved_oauth_apps"),o=(0,S.Xo)(c.KA.DELETE,"approved_oauth_apps");return(0,r.jsxs)(ef.Z.tr,{"data-sentry-element":"unknown","data-sentry-component":"OAuthAppRow","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,r.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:t.icon?"url('".concat(t.icon,"')"):"none"},children:t.icon?"":"".concat(t.name[0])})}),(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,r.jsx)("p",{title:t.name,className:"truncate",children:t.name})}),(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("p",{className:"font-mono truncate w-[220px]",title:t.client_id,children:t.client_id}),(0,r.jsx)(H.z,{type:"default",icon:s?(0,r.jsx)(tt.Z,{className:"text-brand",strokeWidth:3}):(0,r.jsx)(nF.Z,{}),className:"ml-2 px-1",onClick:()=>{(0,V.vQ)(t.client_id),i(!0),setTimeout(()=>{i(!1)},3e3)},"data-sentry-element":"Button","data-sentry-source-file":"OAuthAppRow.tsx"})]})}),(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,r.jsxs)("span",{className:"font-mono",title:t.client_secret_alias,children:[t.client_secret_alias,"..."]})}),(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:D()(t.created_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,r.jsx)(ef.Z.td,{align:"right","data-sentry-element":"unknown","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,r.jsxs)(eQ.h_,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,r.jsx)(eQ.$F,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,r.jsx)(H.z,{type:"default",icon:(0,r.jsx)(nG.Z,{}),className:"px-1","data-sentry-element":"Button","data-sentry-source-file":"OAuthAppRow.tsx"})}),(0,r.jsxs)(eQ.AW,{align:"end",side:"bottom","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,r.jsxs)(X.u,{"data-sentry-element":"Tooltip_Shadcn_","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,r.jsx)(X.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger_Shadcn_","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,r.jsxs)(eQ.Xi,{disabled:!l,className:"space-x-2 !pointer-events-auto",onClick:()=>{l&&a()},"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,r.jsx)(nY.Z,{size:16,"data-sentry-element":"Edit","data-sentry-source-file":"OAuthAppRow.tsx"}),(0,r.jsx)("p",{children:"Edit app"})]},"edit")}),!l&&(0,r.jsx)(X._v,{side:"left",children:"You need additional permissions to edit apps"})]}),(0,r.jsx)(eQ.VD,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"OAuthAppRow.tsx"}),(0,r.jsxs)(X.u,{"data-sentry-element":"Tooltip_Shadcn_","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,r.jsx)(X.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger_Shadcn_","data-sentry-source-file":"OAuthAppRow.tsx",children:(0,r.jsxs)(eQ.Xi,{disabled:!o,className:"space-x-2 !pointer-events-auto",onClick:()=>{o&&n()},"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"OAuthAppRow.tsx",children:[(0,r.jsx)(nZ.Z,{size:16,"data-sentry-element":"Trash","data-sentry-source-file":"OAuthAppRow.tsx"}),(0,r.jsx)("p",{children:"Delete app"})]},"delete")}),!o&&(0,r.jsx)(X._v,{side:"left",children:"You need additional permissions to delete apps"})]})]})]})})]})},nH=a(45599);async function nq(e){let{slug:t,name:a,website:n,icon:s,scopes:r,redirect_uris:i}=e,l=await (0,nw.v_)("".concat(eh.T5,"/organizations/").concat(t,"/oauth/apps"),{name:a,website:n,icon:s,scopes:r,redirect_uris:i});if(l.error)throw l.error;return l}let nW=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>nq(e),{async onSuccess(t,a,s){let{slug:r}=a;await n.invalidateQueries(nk(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to create OAuth application: ".concat(e.message)):t(e,a,n)},...a})};async function nX(e){let{id:t,slug:a,name:n,website:s,icon:r,scopes:i,redirect_uris:l}=e;if(!t)throw Error("OAuth app ID is required");if(!a)throw Error("Organization slug is required");if(!n)throw Error("OAuth app name is required");if(!s)throw Error("OAuth app URL is required");if(!l||0===l.length)throw Error("Redirect URIs are required");let{data:o,error:d}=await (0,b.gz)("/platform/organizations/{slug}/oauth/apps/{id}",{params:{path:{id:t,slug:a}},body:{name:n,website:s,icon:r,scopes:i,redirect_uris:l}});if(d)throw(0,b.S3)(d);return o}let nK=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>nX(e),{async onSuccess(t,a,s){let{slug:r}=a;await n.invalidateQueries(nk(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to update application: ".concat(e.message)):t(e,a,n)},...a})};var nQ=a(54731);let nJ=async function(e,t,a){let n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],s=(0,nQ.eI)("https://obuldanrptloktxcffvn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9idWxkYW5ycHRsb2t0eGNmZnZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTg2MTQ2ODUsImV4cCI6MjAzNDE5MDY4NX0.NFt49g6DFkc1X5khCzN5p01iAVo2TMxlx88cY1V0E2M",{auth:{persistSession:!1,autoRefreshToken:!1,multiTab:!1,detectSessionInUrl:!1,localStorage:{getItem:e=>void 0,setItem:(e,t)=>{},removeItem:e=>{}}}}),{data:r,error:i}=await s.storage.from(e).upload(t,a,{cacheControl:"3600"});if(i){console.error("Failed to upload:",i);return}if(r&&n){let{data:t}=await s.storage.from(e).getPublicUrl(r.path);return null==t?void 0:t.publicUrl}};var n$=a(81463),n0=a(63204);let n1=e=>{let{children:t,scopeName:a,scopes:n,onChange:s}=e;return(0,r.jsx)(eQ.bO,{checked:n.includes(a),onCheckedChange:e=>{e?s([...n,a]):s([...n.filter(e=>e!==a)])},"data-sentry-element":"DropdownMenuCheckboxItem","data-sentry-component":"ScopeDropdownCheckboxItem","data-sentry-source-file":"Scopes.tsx",children:t})},n2=e=>{let{title:t,description:a,readScopeName:n,writeScopeName:s,scopes:i,setScopes:l}=e,o="Access: No access";return i.includes(n)&&(o="Access: Read-only"),i.includes(s)&&(o="Access: Write-only"),i.includes(n)&&i.includes(s)&&(o="Access: Read and write"),(0,r.jsxs)("div",{className:"flex flex-row justify-between p-4 border first:rounded-t last:rounded-b","data-sentry-component":"Scope","data-sentry-source-file":"Scopes.tsx",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-foreground text-sm",children:t}),(0,r.jsx)("span",{className:"text-foreground-light text-xs",children:a})]}),(0,r.jsxs)(eQ.h_,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"Scopes.tsx",children:[(0,r.jsx)(eQ.$F,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"Scopes.tsx",children:(0,r.jsx)(H.z,{type:"default",iconRight:(0,r.jsx)(n0.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"Scopes.tsx",children:(0,r.jsx)("p",{children:o})})}),(0,r.jsxs)(eQ.AW,{align:"end","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"Scopes.tsx",children:[(0,r.jsx)(eQ.Ju,{"data-sentry-element":"DropdownMenuLabel","data-sentry-source-file":"Scopes.tsx",children:"Select an access level"}),(0,r.jsx)(eQ.VD,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n1,{scopeName:n,scopes:i,onChange:l,"data-sentry-element":"ScopeDropdownCheckboxItem","data-sentry-source-file":"Scopes.tsx",children:"Read"}),(0,r.jsx)(n1,{scopeName:s,scopes:i,onChange:l,"data-sentry-element":"ScopeDropdownCheckboxItem","data-sentry-source-file":"Scopes.tsx",children:"Write"})]})]})]},t)},n4=e=>{let{scopes:t,setScopes:a}=e;return(0,r.jsxs)("div",{className:"-space-y-px","data-sentry-component":"ScopesPanel","data-sentry-source-file":"Scopes.tsx",children:[(0,r.jsx)(n2,{title:"Analytics",description:"Analytics logs.",readScopeName:c.YX.ANALYTICS_READ,writeScopeName:c.YX.ANALYTICS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"Auth",description:"Auth configurations and SSO providers.",readScopeName:c.YX.AUTH_READ,writeScopeName:c.YX.AUTH_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"Database",description:"Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",readScopeName:c.YX.DATABASE_READ,writeScopeName:c.YX.DATABASE_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"Domains",description:"Custom domains and vanity subdomains.",readScopeName:c.YX.DOMAINS_READ,writeScopeName:c.YX.DOMAINS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"Edge Functions",description:"Edge functions.",readScopeName:c.YX.EDGE_FUNCTIONS_READ,writeScopeName:c.YX.EDGE_FUNCTIONS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"Environment",description:"Environments/branches.",readScopeName:c.YX.ENVIRONMENT_READ,writeScopeName:c.YX.ENVIRONMENT_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"Organizations",description:"Organizations and all its members.",readScopeName:c.YX.ORGANIZATIONS_READ,writeScopeName:c.YX.ORGANIZATIONS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"Projects",description:"Metadata, upgrade status, network restrictions and network bans.",readScopeName:c.YX.PROJECTS_READ,writeScopeName:c.YX.PROJECTS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"REST",description:"PostgREST configurations.",readScopeName:c.YX.REST_READ,writeScopeName:c.YX.REST_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"Secrets",description:"API keys, secrets and pgsodium configurations.",readScopeName:c.YX.SECRETS_READ,writeScopeName:c.YX.SECRETS_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"}),(0,r.jsx)(n2,{title:"Storage",description:"Storage buckets and files.",readScopeName:c.YX.STORAGE_READ,writeScopeName:c.YX.STORAGE_WRITE,scopes:t,setScopes:a,"data-sentry-element":"Scope","data-sentry-source-file":"Scopes.tsx"})]})};var n5=e=>{let{visible:t,selectedApp:a,onClose:n,onCreateSuccess:s}=e,{slug:l}=(0,i.UO)(),o=(0,u.useRef)(),{mutate:d}=nW({onSuccess:(e,t)=>{m.Am.success('Successfully created OAuth app "'.concat(t.name,'"!')),n(),s(e),h(!1)},onError:e=>{m.Am.error("Failed to create OAuth application: ".concat(e.message)),h(!1)}}),{mutate:c}=nK({onSuccess:(e,t)=>{m.Am.success('Successfully updated OAuth app "'.concat(t.name,'"!')),n(),h(!1)},onError:e=>{m.Am.error("Failed to update OAuth application: ".concat(e.message)),h(!1)}}),[p,h]=(0,u.useState)(!1),[x,g]=(0,u.useState)(!1),[y,f]=(0,u.useState)(),[v,j]=(0,u.useState)(),[b,S]=(0,u.useState)({}),[N,w]=(0,u.useState)([{id:(0,V.k$)(),value:""}]),[_,C]=(0,u.useState)([]);(0,u.useEffect)(()=>{t&&(S({}),h(!1),f(void 0),void 0!==a?(w(a.redirect_uris.map(e=>({id:(0,V.k$)(),value:e}))),C(a.scopes),j(null===a.icon?void 0:a.icon)):(w([{id:(0,V.k$)(),value:""}]),C([]),j(void 0)))},[t,a]);let A=(e,t)=>{w(N.map(a=>a.id===e?{id:e,value:t}:a)),S({})},I=e=>{w(N.filter(t=>t.id!==e))},T=async e=>{e.persist();let[t]=e.target.files||e.dataTransfer.items;f(t),j(URL.createObjectURL(t)),e.target.value=""},k=async e=>{if(!l)return console.error("Slug is required");let t=N.filter(e=>e.value.length>0).map(e=>e.value);if(0===t.length){S({urls:"Please provide at least one URL"});return}S({}),h(!0);let{name:n,website:s}=e,r=void 0!==y?await nJ("oauth-app-icons","".concat(l,"/").concat((0,V.k$)(),".png"),y):v;void 0===a?d({slug:l,name:n,website:s,redirect_uris:t,scopes:_,icon:r}):c({id:a.id,slug:l,name:n,website:s,redirect_uris:t,scopes:_,icon:void 0===r?null:r})};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(ew.ZP,{hideFooter:!0,size:"large",visible:t,header:void 0!==a?"Update OAuth application":"Publish a new OAuth application",onCancel:()=>n(),"data-sentry-element":"SidePanel","data-sentry-source-file":"index.tsx",children:(0,r.jsx)(E.Z,{validateOnBlur:!0,className:"h-full",initialValues:{name:"",website:""},validate:e=>{let t={};return e.name||(t.name="Please provide a name for your application"),e.website||(t.website="Please provide a URL for your site"),(0,V.HH)(e.website)||(t.website="Please provide a valid URL for your site"),t},onSubmit:k,"data-sentry-element":"Form","data-sentry-source-file":"index.tsx",children:e=>{let{resetForm:s,values:i}=e;return(0,u.useEffect)(()=>{if(t&&void 0!==a){let e={name:a.name,website:a.website};s({values:e,initialValues:e})}},[t,a]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsx)(ew.ZP.Content,{children:(0,r.jsxs)("div",{className:"py-4 flex items-start justify-between gap-10",children:[(0,r.jsxs)("div",{className:"space-y-4 w-full",children:[(0,r.jsx)(M.Z,{id:"name",label:"Application name",descriptionText:(null==a?void 0:a.id)&&"ID: ".concat(a.id)}),(0,r.jsx)(M.Z,{id:"website",label:"Website URL",placeholder:"https://my-website.com"})]}),(0,r.jsxs)("div",{children:[void 0!==v?(0,r.jsx)("div",{className:(0,W.cn)("shadow transition group relative","bg-center bg-cover bg-no-repeat","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center"),style:{backgroundImage:v?'url("'.concat(v,'")'):"none"},children:(0,r.jsx)("div",{className:"absolute bottom-1 right-1",children:(0,r.jsxs)(eQ.h_,{children:[(0,r.jsx)(eQ.$F,{asChild:!0,children:(0,r.jsx)(H.z,{type:"default",className:"px-1",children:(0,r.jsx)(nY.Z,{})})}),(0,r.jsxs)(eQ.AW,{align:"end",side:"bottom",children:[(0,r.jsx)(eQ.Xi,{onClick:()=>{o.current&&o.current.click()},children:(0,r.jsx)("p",{children:"Upload image"})},"upload"),(0,r.jsx)(eQ.Xi,{onClick:()=>{f(void 0),j(void 0)},children:(0,r.jsx)("p",{children:"Remove image"})},"remove")]})]})})}):(0,r.jsxs)("div",{className:(0,W.cn)("border border-strong transition opacity-75 hover:opacity-100","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center cursor-pointer"),onClick:()=>{o.current&&o.current.click()},children:[(0,r.jsx)(nH.Z,{size:18,strokeWidth:1.5,className:"text-foreground"}),(0,r.jsx)("p",{className:"text-xs text-foreground-light",children:"Upload logo"})]}),(0,r.jsx)("input",{multiple:!0,type:"file",ref:o,className:"hidden",accept:"image/png, image/jpeg",onChange:T})]})]})}),(0,r.jsx)(ew.ZP.Separator,{}),(0,r.jsxs)(ew.ZP.Content,{className:"py-4",children:[(0,r.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"prose text-sm",children:"Authorization callback URLs"}),(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"All URLs must use HTTPS, except for localhost"})]}),(0,r.jsx)(H.z,{onClick:()=>w(N.concat({id:(0,V.k$)(),value:""})),children:"Add URL"})]}),(0,r.jsxs)("div",{className:"space-y-2 pb-2",children:[N.map(e=>(0,r.jsx)(M.Z,{value:e.value,onChange:t=>A(e.id,t.target.value),placeholder:"e.g https://my-website.com",actions:[N.length>1?(0,r.jsx)(H.z,{type:"default",onClick:()=>I(e.id),children:"Remove"},"remove-url"):null]},e.id)),b.urls&&(0,r.jsx)("p",{className:"text-red-900 text-sm",children:b.urls})]})]}),(0,r.jsx)(ew.ZP.Separator,{}),(0,r.jsxs)("div",{className:"p-6 ",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between space-x-4 pb-4",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"prose text-sm",children:"Application permissions"}),(0,r.jsx)("span",{className:"text-sm text-foreground-light",children:"The application permissions are organized in scopes and will be presented to the user when adding an app to their organization and all of its projects."})]}),(0,r.jsx)(aT.G,{href:"https://supabase.com/docs/guides/platform/oauth-apps/oauth-scopes"})]}),(0,r.jsx)(n4,{scopes:_,setScopes:C})]})]}),(0,r.jsx)(ew.ZP.Separator,{}),(0,r.jsx)(ew.ZP.Content,{children:(0,r.jsxs)("div",{className:"pt-2 pb-3 flex items-center justify-between",children:[(0,r.jsx)(H.z,{type:"default",onClick:()=>g(!0),disabled:0===i.name.length||0===i.website.length,children:"Preview consent for users"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(H.z,{type:"default",disabled:p,onClick:()=>n(),children:"Cancel"}),(0,r.jsx)(H.z,{htmlType:"submit",loading:p,disabled:p,children:"Confirm"})]})]})})]}),(0,r.jsxs)(eP.Z,{hideFooter:!0,className:"!max-w-[600px]",visible:x,onCancel:()=>g(!1),children:[(0,r.jsx)(eP.Z.Content,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{children:["Authorize API access for ",i.name]}),(0,r.jsx)(eI.C,{variant:"brand",children:"Preview"})]})}),(0,r.jsx)(eP.Z.Separator,{}),(0,r.jsxs)(eP.Z.Content,{children:[(0,r.jsx)(n$.Z,{icon:v||null,name:i.name,domain:i.website,scopes:_}),(0,r.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,r.jsx)("p",{className:"prose text-sm",children:"Select an organization to grant API access to"}),(0,r.jsx)("div",{className:"border border-control text-foreground-light rounded px-4 py-2 text-sm bg-surface-200",children:"Organizations that you have access to will be listed here"})]})]}),(0,r.jsx)(eP.Z.Separator,{}),(0,r.jsx)(eP.Z.Content,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"prose text-xs",children:"This is what your users will see when authorizing with your app"}),(0,r.jsx)(H.z,{type:"default",onClick:()=>g(!1),children:"Close"})]})})]})]})}})})})};async function n3(e){let{id:t,slug:a}=e;if(!t)throw Error("App ID is required");if(!a)throw Error("Organization slug is required");let n=await (0,nw.v_)("".concat(eh.T5,"/organizations/").concat(a,"/oauth/apps/").concat(t,"/revoke"),{});if(n.error)throw n.error;return n}let n6=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>n3(e),{async onSuccess(t,a,s){let{slug:r}=a;await n.invalidateQueries(nE(r)),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to revoke application: ".concat(e.message)):t(e,a,n)},...a})};var n8=e=>{let{selectedApp:t,onClose:a}=e,{slug:n}=(0,i.UO)(),{mutate:s,isLoading:l}=n6({onSuccess:()=>{m.Am.success('Successfully revoked the app "'.concat(null==t?void 0:t.name,'"')),a()}}),o=async()=>n?(null==t?void 0:t.id)?void s({slug:n,id:null==t?void 0:t.id}):console.error("App ID is required"):console.error("Slug is required");return(0,r.jsxs)(eP.Z,{size:"medium",alignFooter:"right",header:"Confirm to revoke ".concat(null==t?void 0:t.name),visible:void 0!==t,loading:l,onCancel:a,onConfirm:o,"data-sentry-element":"Modal","data-sentry-component":"RevokeAppModal","data-sentry-source-file":"RevokeAppModal.tsx",children:[(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"RevokeAppModal.tsx",children:(0,r.jsx)(e1.J,{type:"warning",title:"This action cannot be undone",description:"".concat(null==t?void 0:t.name," application will no longer have access to your organization's settings\n          and projects."),"data-sentry-element":"Admonition","data-sentry-source-file":"RevokeAppModal.tsx"})}),(0,r.jsx)(eP.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"RevokeAppModal.tsx",children:(0,r.jsx)("ul",{className:"space-y-5",children:(0,r.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,r.jsx)(nO.Z,{size:14,className:"flex-shrink-0","data-sentry-element":"Lock","data-sentry-source-file":"RevokeAppModal.tsx"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Before you remove this app, consider:"}),(0,r.jsx)("ul",{className:"space-y-2 mt-2",children:(0,r.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. The application will no longer have access to your organization after being revoked."})})]})]})})})]})},n7=()=>{var e,t,a,n;let{slug:s}=(0,i.UO)(),[o,d]=(0,u.useState)(!1),[m,h]=(0,u.useState)(),[x,g]=(0,u.useState)(),[f,j]=(0,u.useState)(),[b,N]=(0,u.useState)(),w=(0,S.Xo)(c.KA.READ,"approved_oauth_apps"),_=(0,S.Xo)(c.KA.CREATE,"approved_oauth_apps"),{data:C,error:A,isLoading:I,isSuccess:T,isError:k}=nz({slug:s},{enabled:w}),E=null==C?void 0:C.sort((e,t)=>Number(new Date(e.created_at))-Number(new Date(t.created_at))),{data:P,isLoading:R,isSuccess:z,isError:Z}=nP({slug:s}),D=null==P?void 0:P.sort((e,t)=>Number(new Date(e.authorized_at))-Number(new Date(t.authorized_at)));return w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.gW,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-source-file":"OAuthApps.tsx",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Published Apps"}),(0,r.jsx)("p",{className:"text-foreground-light text-sm",children:"Build integrations that extend Supabase's functionality"})]}),(0,r.jsx)(ts.u,{disabled:!_,type:"primary",onClick:()=>d(!0),tooltip:{content:{side:"bottom",text:_?void 0:"You need additional permissions to create apps"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"OAuthApps.tsx",children:"Add application"})]}),I&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),k&&(0,r.jsx)(p.Z,{error:A,subject:"Failed to retrieve published OAuth apps"}),void 0!==m&&(0,r.jsxs)(eg.b,{withIcon:!0,variant:"success",title:"Successfully published a new application!",children:[(0,r.jsx)("div",{className:"absolute top-4 right-4",children:(0,r.jsx)(H.z,{type:"text",icon:(0,r.jsx)(tK.Z,{size:18}),className:"px-1",onClick:()=>h(void 0)})}),(0,r.jsxs)("div",{className:"w-full space-y-4",children:[(0,r.jsx)("p",{className:"text-sm",children:"Ensure that you store the client secret securely - you will not be able to see it again."}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(M.Z,{copy:!0,readOnly:!0,size:"small",label:"Client ID",className:"max-w-xl input-mono",value:m.client_id,onChange:()=>{}}),(0,r.jsx)(M.Z,{copy:!0,readOnly:!0,size:"small",label:"Client secret",className:"max-w-xl input-mono",value:m.client_secret,onChange:()=>{}})]})]})]}),T&&(0,r.jsx)(r.Fragment,{children:(null!==(e=null==C?void 0:C.length)&&void 0!==e?e:0)===0?(0,r.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between mt-4",children:(0,r.jsx)("p",{className:"prose text-sm",children:"You do not have any published applications yet"})}):(0,r.jsx)(ef.Z,{head:[(0,r.jsx)(ef.Z.th,{className:"w-[30px]"},"icon"),(0,r.jsx)(ef.Z.th,{children:"Name"},"name"),(0,r.jsx)(ef.Z.th,{children:"Client ID"},"client-id"),(0,r.jsx)(ef.Z.th,{children:"Client Secret"},"client-secret"),(0,r.jsx)(ef.Z.th,{children:"Created at"},"created-at"),(0,r.jsx)(ef.Z.th,{},"delete-action")],body:null!==(t=null==E?void 0:E.map(e=>(0,r.jsx)(nV,{app:e,onSelectEdit:()=>{d(!0),g(e)},onSelectDelete:()=>j(e)},e.id)))&&void 0!==t?t:[]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Authorized Apps"}),(0,r.jsx)("p",{className:"text-foreground-light text-sm",children:"Applications that have access to your organization's settings and projects"}),(0,r.jsxs)("div",{className:"mt-4",children:[R&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),Z&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve authorized apps"}),z&&(0,r.jsx)(r.Fragment,{children:(null!==(a=P.length)&&void 0!==a?a:0)===0?(0,r.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,r.jsx)("p",{className:"prose text-sm",children:"You do not have any authorized applications yet"})}):(0,r.jsx)(ef.Z,{className:"mt-4",head:[(0,r.jsx)(ef.Z.th,{className:"w-[30px]"},"icon"),(0,r.jsx)(ef.Z.th,{children:"Name"},"name"),(0,r.jsx)(ef.Z.th,{children:"Authorized at"},"authorized-at"),(0,r.jsx)(ef.Z.th,{},"delete-action")],body:null!==(n=null==D?void 0:D.map(e=>(0,r.jsx)(nD,{app:e,onSelectRevoke:()=>N(e)},e.id)))&&void 0!==n?n:[]})})]})]})]}),(0,r.jsx)(n5,{visible:o,selectedApp:x,onClose:()=>{g(void 0),d(!1)},onCreateSuccess:h,"data-sentry-element":"PublishAppModal","data-sentry-source-file":"OAuthApps.tsx"}),(0,r.jsx)(nB,{selectedApp:f,onClose:()=>j(void 0),"data-sentry-element":"DeleteAppModal","data-sentry-source-file":"OAuthApps.tsx"}),(0,r.jsx)(n8,{selectedApp:b,onClose:()=>N(void 0),"data-sentry-element":"RevokeAppModal","data-sentry-source-file":"OAuthApps.tsx"})]}):(0,r.jsx)(l.gW,{children:(0,r.jsx)(y.Z,{resourceText:"view OAuth apps"})})},n9=a(78854);async function se(e){let{slug:t,gotrueId:a}=e,n=await (0,nw.$v)("".concat(eh.T5,"/organizations/").concat(t,"/members/").concat(a));if(n.error)throw n.error;return n}let st=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>se(e),{async onSuccess(t,a,s){let{slug:r}=a;await Promise.all([n.invalidateQueries(N.O.members(r)),n.invalidateQueries(N.O.roles(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to remove member: ".concat(e.message)):t(e,a,n)},...a})};var sa=a(6641),sn=a(587),ss=a(14698),sr=a.n(ss),si=a(1662);async function sl(e){let{slug:t,email:a,roleId:n,projects:s}=e,r={email:a,role_id:n};void 0!==s&&(r.role_scoped_projects=s);let{data:i,error:l}=await (0,b.v_)("/platform/organizations/{slug}/members/invitations",{params:{path:{slug:t}},body:r});return l&&(0,b.S3)(l),i}let so=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>sl(e),{async onSuccess(t,a,s){let{slug:r}=a;await Promise.all([n.invalidateQueries(nj.O.rolesV2(r)),n.invalidateQueries(N.O.members(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to update member role: ".concat(e.message)):t(e,a,n)},...a})};async function sd(e){let{slug:t,invitedEmail:a,ownerId:n,roleId:s}=e,r=await (0,nw.v_)("".concat(eh.T5,"/organizations/").concat(t,"/members/invite"),{invited_email:a,owner_id:n,role_id:s});if(r.error)throw r.error;return r}let sc=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>sd(e),{async onSuccess(t,a,s){let{slug:r}=a;await Promise.all([n.invalidateQueries(N.O.members(r)),n.invalidateQueries(N.O.roles(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to invite member: ".concat(e.message)):t(e,a,n)},...a})};var su=a(7208),sm=a(16787),sp=a(41341),sh=a(88587),sx=a(89861),sg=a(54720);let sy=(e,t,a)=>{let{permissions:n,organizationSlug:s}=(0,S.Rc)(a,e,void 0!==a&&void 0!==e),r=[],i=[];return t&&e&&t.forEach(e=>{(0,S.G8)(n,c.KA.CREATE,"auth.subject_roles",{resource:{role_id:e.id}},s)&&r.push(e.id),(0,S.G8)(n,c.KA.DELETE,"auth.subject_roles",{resource:{role_id:e.id}},s)&&i.push(e.id)}),{rolesAddable:r,rolesRemovable:i}},sf=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter(e=>{var a;let[n]=null!==(a=e.role_ids)&&void 0!==a?a:[],s=t.find(e=>e.id===n);return(null==s?void 0:s.name)==="Owner"&&!e.invited_at}).length>1},sv=()=>{var e,t;let{slug:a}=(0,i.UO)(),{profile:n}=(0,aP.Un)(),s=(0,k.l)(),{permissions:l}=(0,S.Rc)(),[o,p]=(0,u.useState)(!1),[h,x]=(0,u.useState)(!1),{data:g}=(0,tc.Sy)(),{data:y}=nI({slug:a}),{data:f,isSuccess:v}=nN({slug:a}),j=null!==(e=null==f?void 0:f.org_scoped_roles)&&void 0!==e?e:[],b=(null!=g?g:[]).filter(e=>e.organization_id===(null==s?void 0:s.id)).sort((e,t)=>e.name.localeCompare(t.name)),N=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:w,isSuccess:_}=(0,d.Gl)({orgSlug:a},{enabled:N}),C=null==w?void 0:w.plan,A=(0,d.Tt)(a),I=null==y?void 0:y.find(e=>e.gotrue_id===(null==n?void 0:n.gotrue_id)),T=1===(null!==(t=null==I?void 0:I.role_ids)&&void 0!==t?t:[]).length&&j.some(e=>e.id===(null==I?void 0:I.role_ids[0])),{rolesAddable:E}=sy(null==s?void 0:s.slug,j,null!=l?l:[]),M=T&&j.some(e=>{let{id:t}=e;return(0,S.G8)(l,c.KA.CREATE,"user_invites",{resource:{role_id:t}},null==s?void 0:s.slug)}),{mutate:P,isLoading:R}=so(),{mutate:z,isLoading:Z}=sc(),D=tO.Ry({email:tO.Z_().email("Must be a valid email address").min(1,"Email is required"),role:tO.Z_().min(1,"Role is required"),applyToOrg:tO.O7(),projectRef:tO.Z_()}),O=(0,tD.cI)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,tZ.F)(D),defaultValues:{email:"",role:"",applyToOrg:!0,projectRef:""}}),{applyToOrg:U}=O.watch(),B=async e=>{if(!a)return console.error("Slug is required");if((null==n?void 0:n.id)===void 0)return console.error("Profile ID required");let t=j.find(e=>"Developer"===e.name),s=(null!=y?y:[]).find(t=>t.primary_email===e.email.toLowerCase());if(void 0!==s)return s.invited_id?(0,m.Am)("User has already been invited to this organization"):(0,m.Am)("User is already in this organization");A?P({slug:a,email:e.email.toLowerCase(),roleId:Number(e.role),...!e.applyToOrg&&e.projectRef?{projects:[e.projectRef]}:{}},{onSuccess:()=>{var e;m.Am.success("Successfully sent invitation to new member"),p(!o),O.reset({email:"",role:null!==(e=null==t?void 0:t.id.toString())&&void 0!==e?e:"",applyToOrg:!0,projectRef:""})}}):z({slug:a,invitedEmail:e.email.toLowerCase(),ownerId:n.id,roleId:Number(e.role)},{onSuccess:e=>{if(sr()(e))m.Am.error("Failed to add member");else{var a;m.Am.success("Successfully added new member"),p(!o),O.reset({email:"",role:null!==(a=null==t?void 0:t.id.toString())&&void 0!==a?a:"",applyToOrg:!0,projectRef:""})}}})};return(0,u.useEffect)(()=>{if(v&&o){let e=j.find(e=>"Developer"===e.name);void 0!==e&&O.setValue("role",e.id.toString())}},[v,o]),(0,u.useEffect)(()=>{if(U)O.setValue("projectRef","");else{let e=null==b?void 0:b[0];void 0!==e&&O.setValue("projectRef",e.ref)}},[U]),(0,r.jsxs)(su.Vq,{open:o,onOpenChange:p,"data-sentry-element":"Dialog","data-sentry-component":"InviteMemberButton","data-sentry-source-file":"InviteMemberButton.tsx",children:[(0,r.jsx)(su.hg,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,r.jsxs)(X.u,{"data-sentry-element":"Tooltip_Shadcn_","data-sentry-source-file":"InviteMemberButton.tsx",children:[(0,r.jsx)(X.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger_Shadcn_","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,r.jsx)(H.z,{disabled:!M,className:"pointer-events-auto",onClick:()=>p(!0),"data-sentry-element":"Button","data-sentry-source-file":"InviteMemberButton.tsx",children:"Invite"})}),!M&&(0,r.jsx)(X._v,{side:"bottom",children:"You need additional permissions to invite a member to this organization"})]})}),(0,r.jsxs)(su.cZ,{size:"medium","data-sentry-element":"DialogContent","data-sentry-source-file":"InviteMemberButton.tsx",children:[(0,r.jsx)(su.fK,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,r.jsx)(su.$N,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"InviteMemberButton.tsx",children:"Invite a member to this organization"})}),(0,r.jsx)(su.P3,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"InviteMemberButton.tsx"}),(0,r.jsx)(tY.l0,{...O,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,r.jsxs)("form",{id:"organization-invitation",className:"flex flex-col gap-y-4",onSubmit:O.handleSubmit(B),children:[(0,r.jsxs)(su.VO,{className:"flex flex-col gap-y-4 pb-2","data-sentry-element":"DialogSection","data-sentry-source-file":"InviteMemberButton.tsx",children:[A&&(0,r.jsx)(tY.Wi,{name:"applyToOrg",control:O.control,render:e=>{let{field:t}=e;return(0,r.jsx)(sg.E,{layout:"flex",label:"Apply role to all projects in the organization",children:(0,r.jsx)(tY.NI,{children:(0,r.jsx)(sm.r,{checked:t.value,onCheckedChange:e=>O.setValue("applyToOrg",e)})})})}}),(0,r.jsx)(tY.Wi,{name:"role",control:O.control,render:e=>{var t,a;let{field:n}=e;return(0,r.jsx)(sg.E,{label:"Member role",children:(0,r.jsx)(tY.NI,{children:(0,r.jsxs)(tV.Ph,{value:n.value,onValueChange:e=>O.setValue("role",e),children:[(0,r.jsx)(tV.i4,{className:"text-sm capitalize",children:null!==(a=null===(t=j.find(e=>e.id===Number(n.value)))||void 0===t?void 0:t.name)&&void 0!==a?a:"Unknown"}),(0,r.jsx)(tV.Bw,{children:(0,r.jsx)(tV.DI,{children:j.map(e=>{let t=E.includes(e.id);return(0,r.jsxs)(tV.Ql,{value:e.id.toString(),className:"text-sm [&>span:nth-child(2)]:w-full [&>span:nth-child(2)]:flex [&>span:nth-child(2)]:items-center [&>span:nth-child(2)]:justify-between",disabled:!t,children:[(0,r.jsx)("span",{children:e.name}),!t&&(0,r.jsx)("span",{children:"Additional permissions required to assign role"})]},e.id)})})})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"InviteMemberButton.tsx"}),!U&&(0,r.jsx)(tY.Wi,{name:"projectRef",control:O.control,render:e=>{var t,a;let{field:n}=e;return(0,r.jsx)(sg.E,{label:"Select a project",description:"You can assign roles to multiple projects once the invite is accepted",children:(0,r.jsx)(tY.NI,{children:(0,r.jsxs)(sp.J2,{open:h,onOpenChange:x,children:[(0,r.jsx)(sp.xo,{asChild:!0,children:(0,r.jsx)(H.z,{block:!0,type:"default",role:"combobox",size:"small",className:"justify-between max-w-[470px]",iconRight:(0,r.jsx)(si.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),children:null!==(a=null===(t=b.find(e=>e.ref===n.value))||void 0===t?void 0:t.name)&&void 0!==a?a:"Unknown"})}),(0,r.jsx)(sp.yk,{sameWidthAsTrigger:!0,className:"p-0",children:(0,r.jsxs)(sh.mY,{filter:(e,t)=>{let a=b.find(t=>t.ref===e),n=null==a?void 0:a.name.toLowerCase();return void 0!==n&&n.includes(t.toLowerCase())?1:e.includes(t)?1:0},children:[(0,r.jsx)(sh.sZ,{placeholder:"Search project..."}),(0,r.jsxs)(sh.e8,{children:[(0,r.jsx)(sh.rb,{children:"No projects found..."}),(0,r.jsx)(sh.fu,{children:(0,r.jsx)(sx.x,{className:(0,W.cn)((b||[]).length>7&&"max-h-[210px] overflow-y-auto"),children:b.map(e=>(0,r.jsxs)(sh.di,{value:e.ref,onSelect:e=>{O.setValue("projectRef",e),x(!1)},children:[(0,r.jsx)(tt.Z,{className:(0,W.cn)("mr-2 h-4 w-4",n.value===e.ref?"opacity-100":"opacity-0")}),e.name]},e.ref))})})]})]})})]})})})}}),(0,r.jsx)(tY.Wi,{name:"email",control:O.control,render:e=>{let{field:t}=e;return(0,r.jsx)(sg.E,{label:"Email address",children:(0,r.jsx)(tY.NI,{children:(0,r.jsx)(tH.I,{autoFocus:!0,...t,autoComplete:"off",disabled:R||Z,placeholder:"Enter email address"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"InviteMemberButton.tsx"}),(0,r.jsx)(tr.Z,{defaultVisibility:!1,title:"Single Sign-on (SSO) login option available",hideCollapse:!1,description:(0,r.jsxs)("div",{className:"space-y-4 mb-1",children:[(0,r.jsx)("p",{children:"Supabase offers single sign-on (SSO) as a login option to provide additional account security for your team. This allows company administrators to enforce the use of an identity provider when logging into Supabase."}),(0,r.jsx)("p",{children:"This is only available for organizations on Team Plan or above."}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(H.z,{asChild:!0,type:"default",children:(0,r.jsx)(L(),{href:"https://supabase.com/docs/guides/platform/sso",target:"_blank",rel:"noreferrer",children:"Learn more"})}),_&&((null==C?void 0:C.id)==="free"||(null==C?void 0:C.id)==="pro")&&(0,r.jsx)(H.z,{asChild:!0,type:"default",children:(0,r.jsx)(L(),{href:"/org/".concat(a,"/billing?panel=subscriptionPlan"),children:"Upgrade to Team"})})]})]}),"data-sentry-element":"InformationBox","data-sentry-source-file":"InviteMemberButton.tsx"})]}),(0,r.jsx)(su.P3,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"InviteMemberButton.tsx"}),(0,r.jsx)(su.VO,{className:"pt-0","data-sentry-element":"DialogSection","data-sentry-source-file":"InviteMemberButton.tsx",children:(0,r.jsx)(H.z,{block:!0,htmlType:"submit",loading:R||Z,"data-sentry-element":"Button","data-sentry-source-file":"InviteMemberButton.tsx",children:"Send invitation"})})]})})]})]})};var sj=a(30983),sb=a(62431),sS=a(44216),sN=a(86355),sw=a(88586);function s_(e){let t=new Date(e);return!((new Date().valueOf()-t.valueOf())/1e3/60/60<24)}let sC=e=>{if(!e)return"";let{username:t,primary_email:a,invited_id:n}=e||{};return void 0!==n?a:t||""};async function sA(e){let{slug:t,id:a}=e,{error:n}=await (0,b.IV)("/platform/organizations/{slug}/members/invitations/{id}",{params:{path:{slug:t,id:a}}});return n&&(0,b.S3)(n),!0}let sI=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>sA(e),{async onSuccess(t,a,s){let{slug:r,skipInvalidation:i}=a;i||await Promise.all([n.invalidateQueries(nj.O.rolesV2(r)),n.invalidateQueries(N.O.members(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to delete invitation: ".concat(e.message)):t(e,a,n)},...a})};async function sT(e){let{slug:t,invitedId:a}=e,{data:n,error:s}=await (0,b.IV)("/platform/organizations/{slug}/members/invite",{params:{path:{slug:t},query:{invited_id:a}}});return s&&(0,b.S3)(s),n}let sk=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>sT(e),{async onSuccess(t,a,s){let{slug:r,invalidateDetail:i}=a;await Promise.all([...null==i||i?[n.invalidateQueries(N.O.members(r))]:[],n.invalidateQueries(N.O.roles(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to revoke invitation: ".concat(e.message)):t(e,a,n)},...a})};var sE=a(85466),sM=a.n(sE),sP=a(97274);async function sR(e){let{slug:t,gotrueId:a,roleId:n,projects:s}=e,r={role_id:n};void 0!==s&&(r.role_scoped_projects=s);let{data:i,error:l}=await (0,b.r$)("/platform/organizations/{slug}/members/{gotrue_id}",{params:{path:{slug:t,gotrue_id:a}},body:r,headers:{Version:"2"}});return l&&(0,b.S3)(l),i}let sz=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>sR(e),{async onSuccess(t,a,s){let{slug:r,skipInvalidation:i}=a;i||await Promise.all([n.invalidateQueries(nj.O.rolesV2(r)),n.invalidateQueries(N.O.members(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to update member role: ".concat(e.message)):t(e,a,n)},...a})};async function sZ(e){let{slug:t,gotrueId:a,roleId:n}=e,{data:s,error:r}=await (0,b.IV)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:t,gotrue_id:a,role_id:n.toString()}}});return r&&(0,b.S3)(r),s}let sD=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>sZ(e),{async onSuccess(t,a,s){let{slug:r,skipInvalidation:i}=a;i||await Promise.all([n.invalidateQueries(nj.O.rolesV2(r)),n.invalidateQueries(N.O.members(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to unassign member role: ".concat(e.message)):t(e,a,n)},...a})};async function sO(e){let{slug:t,gotrueId:a,roleId:n,roleName:s,projects:r}=e,{data:i,error:l}=await (0,b.gz)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:t,gotrue_id:a,role_id:n.toString()}},body:{name:s,role_scoped_projects:r}});return l&&(0,b.S3)(l),i}let sL=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.NL)();return(0,A.D)(e=>sO(e),{async onSuccess(t,a,s){let{slug:r,skipInvalidation:i}=a;i||await Promise.all([n.invalidateQueries(nj.O.rolesV2(r)),n.invalidateQueries(N.O.members(r))]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?m.Am.error("Failed to update member role: ".concat(e.message)):t(e,a,n)},...a})};var sU=a(39907),sB=a.n(sU);let sF=(e,t,a)=>{let{org_scoped_roles:n,project_scoped_roles:s}=t;return e.role_ids.map(e=>{let t=n.find(t=>t.id===e);if(void 0!==t)return{ref:void 0,roleId:t.id};let r=s.find(t=>t.id===e);if(void 0!==r){var i;return(null!==(i=null==r?void 0:r.project_ids)&&void 0!==i?i:[]).map(e=>a.find(t=>t.id===e)).map(e=>({ref:null==e?void 0:e.ref,projectId:null==e?void 0:e.id,roleId:r.id,baseRoleId:r.base_role_id}))}}).filter(Boolean).flat()},sG=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,n=[],s=[],r=[];return e.forEach(e=>{let a=t.find(t=>e.ref===t.ref);void 0===a?n.push(e):a.roleId!==e.roleId&&r.push({ref:a.ref,originalRole:e.roleId,originalBaseRole:e.baseRoleId,updatedRole:a.roleId})}),t.forEach(t=>{void 0===e.find(e=>t.ref===e.ref)&&s.push(t)}),{removed:n.map(e=>{var t;return{...e,projectId:null===(t=a.find(t=>t.ref===e.ref))||void 0===t?void 0:t.id}}),added:s.map(e=>{var t;return{...e,projectId:null===(t=a.find(t=>t.ref===e.ref))||void 0===t?void 0:t.id}}),updated:r.map(e=>{var t;return{...e,projectId:null===(t=a.find(t=>t.ref===e.ref))||void 0===t?void 0:t.id}})}},sY=(e,t)=>{let{removed:a,added:n,updated:s}=t,r=[],i=[],l=[],o=sB()(n,"roleId"),d=sB()(a,"roleId"),c=sB()(s,"originalRole"),u=sB()(s,"updatedRole"),m=e.filter(e=>{var t;return(null!==(t=null==e?void 0:e.project_ids)&&void 0!==t?t:[]).length>0}).map(e=>e.base_role_id);return e.forEach(e=>{var t,i,m,p,h,x,g,y;let f=e.project_ids;if(null===f)return r.push(e.id);let v=f.every(e=>{let t=a.map(e=>e.projectId).some(t=>t===e),n=s.map(e=>e.projectId).some(t=>t===e);return t||n}),j=n.some(t=>t.roleId===e.base_role_id),b=s.some(t=>t.updatedRole===e.base_role_id);if(v&&!j&&!b)return r.push(e.id);let S=null!==(h=null===(t=o[e.base_role_id])||void 0===t?void 0:t.map(e=>e.projectId))&&void 0!==h?h:[],N=null!==(x=null===(i=d[e.id])||void 0===i?void 0:i.map(e=>e.projectId))&&void 0!==x?x:[],w=null!==(g=null===(m=c[e.id])||void 0===m?void 0:m.map(e=>e.projectId))&&void 0!==g?g:[],_=null!==(y=null===(p=u[e.base_role_id])||void 0===p?void 0:p.map(e=>e.projectId))&&void 0!==y?y:[],C=f.filter(e=>!N.includes(e)).filter(e=>!w.includes(e)).concat(S).concat(_);sM()(f,C)||l.push({roleId:e.id,projectIds:C.sort((e,t)=>e-t)})}),Object.keys(o).forEach(e=>{m.includes(Number(e))||i.push({roleId:Number(e),projectIds:o[e].map(e=>e.projectId).sort((e,t)=>e-t)})}),Object.keys(u).forEach(e=>{m.includes(Number(e))||i.push({roleId:Number(e),projectIds:u[e].map(e=>e.projectId).sort((e,t)=>e-t)})}),{toRemove:r.sort((e,t)=>e-t),toAssign:i,toUpdate:l}},sV=e=>{var t;let{visible:a,member:n,projectsRoleConfiguration:s,onClose:l}=e,{slug:o}=(0,i.UO)(),d=(0,C.NL)(),c=(0,k.l)(),{data:p}=(0,tc.Sy)(),{data:h}=nN({slug:null==c?void 0:c.slug}),[x,g]=(0,u.useState)(!1),{mutateAsync:y}=sz(),{mutateAsync:f}=sD({onError:()=>{}}),{mutateAsync:v}=sL(),j=null!==(t=null==h?void 0:h.org_scoped_roles)&&void 0!==t?t:[],{org_scoped_roles:b,project_scoped_roles:S}=null!=h?h:{org_scoped_roles:[],project_scoped_roles:[]},w=(null!=p?p:[]).filter(e=>e.organization_id===(null==c?void 0:c.id)),_=sG(void 0!==h?sF(n,h,null!=p?p:[]):[],s,null!=p?p:[]),A=async()=>{if(void 0===o)return console.error("Slug is required");g(!0);let e=n.gotrue_id,t=n.role_ids.map(e=>[...b,...S].find(t=>t.id===e)).filter(Boolean);if(1===s.length&&void 0===s[0].ref)try{await y({slug:o,gotrueId:e,roleId:s[0].roleId}),m.Am.success("Successfully updated role for ".concat(n.username)),l(!0);return}catch(e){return g(!1),m.Am.error("Failed to update role: ".concat(e.message))}let{toRemove:a,toAssign:r,toUpdate:i}=sY(t,_);try{await Promise.all([...r.map(t=>{let{roleId:a,projectIds:n}=t;return y({slug:o,gotrueId:e,roleId:a,projects:n.map(e=>{var t;return null==p?void 0:null===(t=p.find(t=>t.id===e))||void 0===t?void 0:t.ref})})})]),await Promise.all([...a.map(t=>f({slug:o,gotrueId:e,roleId:t})),...i.map(t=>{var a;let{roleId:n,projectIds:s}=t;return v({slug:o,gotrueId:e,roleId:n,roleName:null===(a=S.find(e=>e.id===n))||void 0===a?void 0:a.name,projects:s.map(e=>{var t;return null==p?void 0:null===(t=p.find(t=>t.id===e))||void 0===t?void 0:t.ref})})})]),await Promise.all([d.invalidateQueries(nj.O.rolesV2(o)),d.invalidateQueries(N.O.members(o))]),m.Am.success("Successfully updated role for ".concat(n.username)),l(!0)}catch(e){return g(!1),m.Am.error("Failed to update role: ".concat(e.message))}};return(0,r.jsx)(sn.Z,{size:"medium",visible:a,loading:x,title:"Confirm to change roles of member",confirmLabel:"Update roles",confirmLabelLoading:"Updating",onCancel:()=>l(),onConfirm:A,"data-sentry-element":"ConfirmationModal","data-sentry-component":"UpdateRolesConfirmationModal","data-sentry-source-file":"UpdateRolesConfirmationModal.tsx",children:(0,r.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["You are making the following changes to the role of"," ",(0,r.jsx)("span",{className:"text-foreground",children:n.username})," in the organization"," ",(0,r.jsx)("span",{className:"text-foreground",children:null==c?void 0:c.name}),":"]}),(0,r.jsxs)("div",{className:"flex flex-col gap-y-2",children:[0!==_.removed.length&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm",children:["Removing ",_.removed.length," role",_.removed.length>1?"s":""," for user:"]}),(0,r.jsx)("ul",{className:"list-disc pl-6",children:_.removed.map((e,t)=>{var a,n,s;let i=null!==(a=b.find(t=>t.id===e.roleId))&&void 0!==a?a:S.find(t=>t.id===e.roleId),l=w.find(t=>t.ref===e.ref),o=(null!==(n=null==i?void 0:i.name)&&void 0!==n?n:"Unknown").split("_")[0];return(0,r.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,r.jsx)("span",{className:"text-foreground",children:o})," on"," ",(0,r.jsx)("span",{className:void 0!==l?"text-foreground":"",children:null!==(s=null==l?void 0:l.name)&&void 0!==s?s:"organization"})]},"update-".concat(t))})})]}),0!==_.added.length&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm",children:["Adding ",_.added.length," role",_.added.length>1?"s":""," for user:"]}),(0,r.jsx)("ul",{className:"list-disc pl-6",children:_.added.map((e,t)=>{var a;let n=j.find(t=>t.id===e.roleId),s=w.find(t=>t.ref===e.ref);return(0,r.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,r.jsx)("span",{className:"text-foreground",children:null==n?void 0:n.name})," on"," ",(0,r.jsx)("span",{className:void 0!==s?"text-foreground":"",children:null!==(a=null==s?void 0:s.name)&&void 0!==a?a:"organization"})]},"update-".concat(t))})})]}),0!==_.updated.length&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm",children:["Updating ",_.updated.length," role",_.updated.length>1?"s":""," for user:"]}),(0,r.jsx)("ul",{className:"list-disc pl-6",children:_.updated.map((e,t)=>{var a,n,s;let i=null!==(a=b.find(t=>t.id===e.originalRole))&&void 0!==a?a:S.find(t=>t.id===e.originalRole),l=b.find(t=>t.id===e.updatedRole),o=w.find(t=>t.ref===e.ref),d=(null!==(n=null==i?void 0:i.name)&&void 0!==n?n:"Unknown").split("_")[0];return(0,r.jsxs)("li",{className:"text-sm text-foreground-light",children:["From ",(0,r.jsx)("span",{className:"text-foreground",children:d})," to"," ",(0,r.jsx)("span",{className:"text-foreground",children:null==l?void 0:l.name})," on"," ",(0,r.jsx)("span",{className:void 0!==o?"text-foreground":"",children:null!==(s=null==o?void 0:o.name)&&void 0!==s?s:"organization"})]},"update-".concat(t))})})]})]}),(0,r.jsx)("p",{className:"text-sm text-foreground",children:"By changing the role of this member their permissions will change."})]})})},sH=e=>{var t,a,n,s;let{visible:l,member:o,onClose:c}=e,{slug:m}=(0,i.UO)(),p=(0,k.l)(),h=(0,d.Tt)(m),{data:x}=(0,tc.Sy)(),{data:g}=(0,sa.j)(),{data:y,isSuccess:f}=nN({slug:m}),v=null!==(n=null==y?void 0:y.org_scoped_roles)&&void 0!==n?n:[],j=null!==(s=null==y?void 0:y.project_scoped_roles)&&void 0!==s?s:[],{rolesAddable:b,rolesRemovable:S}=sy(null==p?void 0:p.slug,v.concat(j),null!=g?g:[]),N=v.every(e=>!b.includes(e.id)),[w,_]=(0,u.useState)(!1),[C,A]=(0,u.useState)(!1),[I,T]=(0,u.useState)([]),E=void 0!==y?sF(o,y,null!=x?x:[]):[],M=(null!=x?x:[]).filter(e=>e.organization_id===(null==p?void 0:p.id)),P=1===I.length&&(null===(t=I[0])||void 0===t?void 0:t.ref)===void 0,R=I.length>0,z=null===(a=v.find(e=>"Developer"===e.name))||void 0===a?void 0:a.id;["Owner","Administrator","Developer"].reduce((e,t,a)=>({...e,[t]:a}),{});let Z=M.filter(e=>!I.some(t=>t.ref===e.ref)),D=M.length-Z.length,O=E.length!==Z.length,L=e=>{T(I.concat({ref:e,roleId:null!=z?z:v[0].id})),A(!1)},U=e=>{void 0!==e&&T(I.filter(t=>t.ref!==e))},B=(e,t)=>{void 0!==t.ref?T(I.map(a=>a.ref===t.ref?{ref:a.ref,projectId:a.projectId,roleId:Number(e)}:a)):T([{ref:void 0,roleId:Number(e)}])};return(0,u.useEffect)(()=>{l&&f&&T(sF(o,y,null!=x?x:[]))},[l,f]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(sP.yo,{open:l,onOpenChange:()=>c(),"data-sentry-element":"Sheet","data-sentry-source-file":"UpdateRolesPanel.tsx",children:(0,r.jsx)(sP.ue,{showClose:!1,size:"default",className:(0,W.cn)("bg-surface-200 p-0 flex flex-row gap-0 !min-w-[400px]"),"data-sentry-element":"SheetContent","data-sentry-source-file":"UpdateRolesPanel.tsx",children:(0,r.jsxs)("div",{className:(0,W.cn)("flex flex-col grow w-full"),children:[(0,r.jsxs)(sP.Tu,{className:(0,W.cn)("py-3 flex flex-row justify-between gap-x-4 items-center border-b"),"data-sentry-element":"SheetHeader","data-sentry-source-file":"UpdateRolesPanel.tsx",children:[(0,r.jsxs)("p",{className:"truncate",title:"Manage access for ".concat(o.username),children:["Manage access for ",o.username]}),(0,r.jsx)(aT.G,{href:"https://supabase.com/docs/guides/platform/access-control","data-sentry-element":"DocsButton","data-sentry-source-file":"UpdateRolesPanel.tsx"})]}),(0,r.jsxs)(sP.DN,{className:"h-full overflow-auto flex flex-col gap-y-4","data-sentry-element":"SheetSection","data-sentry-source-file":"UpdateRolesPanel.tsx",children:[h&&(0,r.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,r.jsx)(sm.r,{disabled:N,checked:P,onCheckedChange:()=>{var e,t,a;let n=null!==(a=null!==(t=null===(e=I[0])||void 0===e?void 0:e.roleId)&&void 0!==t?t:z)&&void 0!==a?a:v[0].id;P?T(M.map(e=>({ref:e.ref,projectId:e.id,roleId:n}))):T([{ref:void 0,roleId:n}])}}),(0,r.jsx)("p",{className:"text-sm",children:"Apply roles to all projects in the organization"})]}),0===I.length&&(0,r.jsxs)(e6.bZ,{children:[(0,r.jsx)(e8.aN,{}),(0,r.jsx)(e6.Cd,{children:"Team members need to be assigned at least one role"}),(0,r.jsx)(e6.X,{children:"You may not remove all roles from a team member"})]}),!P&&I.length>0&&I.length!==M.length&&(0,r.jsxs)(e6.bZ,{children:[(0,r.jsx)(e6.Cd,{children:O?"This member will only have access to ".concat(D," project").concat(D>1?"s":""):"This member only has access to ".concat(D," project").concat(D>1?"s":"")}),(0,r.jsxs)(e6.X,{children:[o.username," ",O?"will":"does"," not have access to the following ",Z.length," project",Z.length>1?"s":"",":",(0,r.jsx)("ul",{className:"list-disc pl-6",children:Z.map(e=>(0,r.jsx)("li",{children:e.name},e.id))})]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-y-2",children:I.sort((e,t)=>{var a,n;return(null!==(a=null==e?void 0:e.projectId)&&void 0!==a?a:0)-(null!==(n=null==t?void 0:t.projectId)&&void 0!==n?n:0)}).map(e=>{var t,a,n,s,i;let l=void 0===e.ref?"All projects":null==x?void 0:null===(t=x.find(t=>t.ref===e.ref))||void 0===t?void 0:t.name,o=v.find(t=>void 0!==e.baseRoleId?t.id===e.baseRoleId:t.id===e.roleId),d=S.includes(null!==(a=null==o?void 0:o.id)&&void 0!==a?a:0);return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm",children:l}),(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[N?(0,r.jsxs)(X.u,{children:[(0,r.jsx)(X.aJ,{asChild:!0,children:(0,r.jsx)("div",{className:"flex items-center justify-between rounded-md border border-button bg-button px-3 py-2 text-sm h-10 w-56 text-foreground-light",children:null!==(n=null==o?void 0:o.name)&&void 0!==n?n:"Unknown"})}),(0,r.jsx)(X._v,{side:"bottom",children:"Additional permissions required to update role"})]}):(0,r.jsxs)(tV.Ph,{value:(null!==(s=null==e?void 0:e.baseRoleId)&&void 0!==s?s:e.roleId).toString(),onValueChange:t=>B(t,e),children:[(0,r.jsx)(tV.i4,{className:(0,W.cn)("text-sm h-10 w-56",(null==o?void 0:o.name)===void 0&&"text-foreground-light"),children:null!==(i=null==o?void 0:o.name)&&void 0!==i?i:"Please select a role"}),(0,r.jsx)(tV.Bw,{children:(0,r.jsx)(tV.DI,{children:(null!=v?v:[]).map(e=>{let t=b.includes(e.id);return(0,r.jsx)(tV.Ql,{value:e.id.toString(),className:"text-sm",disabled:!t,children:e.name},e.id)})})})]}),!P&&(0,r.jsxs)(X.u,{children:[(0,r.jsx)(X.aJ,{asChild:!0,children:(0,r.jsx)(H.z,{type:"text",disabled:!d,className:"px-1",icon:(0,r.jsx)(tK.Z,{}),onClick:()=>U(null==e?void 0:e.ref)})}),!d&&(0,r.jsx)(X._v,{side:"bottom",children:"Additional permission required to remove role from member"})]})]})]},"".concat(e.ref,"-").concat(e.roleId))})}),!P&&(0,r.jsxs)(sp.J2,{open:C,onOpenChange:A,modal:!1,children:[(0,r.jsx)(sp.xo,{asChild:!0,children:(0,r.jsx)(H.z,{type:"default",className:"w-min",children:"Add project"})}),(0,r.jsx)(sp.yk,{className:"p-0",side:"bottom",align:"start",children:(0,r.jsxs)(sh.mY,{children:[(0,r.jsx)(sh.sZ,{placeholder:"Find project..."}),(0,r.jsxs)(sh.e8,{children:[(0,r.jsx)(sh.rb,{children:"No projects found"}),(0,r.jsx)(sh.fu,{children:(0,r.jsx)(sx.x,{className:(x||[]).length>7?"h-[210px]":"",children:M.map(e=>{let t=I.some(t=>t.ref===e.ref);return(0,r.jsxs)(sh.di,{disabled:t,className:"cursor-pointer w-full justify-between",onSelect:()=>L(e.ref),onClick:()=>L(e.ref),children:[(0,r.jsx)("p",{className:"truncate",children:e.name}),t&&(0,r.jsx)("p",{className:"w-[45%] text-right",children:"Already assigned"})]},e.ref)})})})]})]})})]})]}),(0,r.jsxs)(sP.FF,{className:"flex items-center !justify-end px-5 py-4 w-full border-t","data-sentry-element":"SheetFooter","data-sentry-source-file":"UpdateRolesPanel.tsx",children:[(0,r.jsx)(H.z,{type:"default",disabled:!1,onClick:()=>c(),"data-sentry-element":"Button","data-sentry-source-file":"UpdateRolesPanel.tsx",children:"Cancel"}),(0,r.jsx)(H.z,{loading:!1,disabled:!R,onClick:()=>{sM()(I,E)?c():_(!0)},"data-sentry-element":"Button","data-sentry-source-file":"UpdateRolesPanel.tsx",children:"Save roles"})]})]})})}),(0,r.jsx)(sV,{visible:w,member:o,projectsRoleConfiguration:I,onClose:e=>{_(!1),e&&c()},"data-sentry-element":"UpdateRolesConfirmationModal","data-sentry-source-file":"UpdateRolesPanel.tsx"})]})},sq=e=>{var t,a,n,s,l;let{member:p}=e,{slug:h}=(0,i.UO)(),{profile:x}=(0,aP.Un)(),[g,y]=(0,u.useState)(!1),[f,v]=(0,u.useState)(!1),j=(0,o.N)("organization_members:delete"),b=(0,k.l)(),{data:N}=(0,sa.j)(),{data:w}=(0,tc.Sy)(),{data:_}=nI({slug:h}),{data:C}=nN({slug:h}),A=(0,d.Tt)(h),I=null!==(a=null==C?void 0:C.org_scoped_roles)&&void 0!==a?a:[],T=null!==(n=null==C?void 0:C.project_scoped_roles)&&void 0!==n?n:[],E=!!p.invited_id,M=null==_?void 0:_.find(e=>e.gotrue_id===(null==x?void 0:x.gotrue_id)),P=1===(null!==(s=null==M?void 0:M.role_ids)&&void 0!==s?s:[]).length&&I.some(e=>e.id===(null==M?void 0:M.role_ids[0])),{rolesRemovable:R}=sy(null==b?void 0:b.slug,I.concat(T),null!=N?N:[]),z=null!==(l=null===(t=p.role_ids)||void 0===t?void 0:t[0])&&void 0!==l?l:-1,Z=p.role_ids.every(e=>R.includes(e)),D=(0,S.Xo)(c.KA.CREATE,"user_invites",{resource:{role_id:z}})&&P,O=(0,S.Xo)(c.KA.DELETE,"user_invites",{resource:{role_id:z}})&&P,{mutate:L,isLoading:U}=st({onSuccess:()=>{m.Am.success("Successfully removed ".concat(p.primary_email)),v(!1)}}),{mutate:B,isLoading:F}=so({onSuccess:()=>{m.Am.success("Resent the invitation.")},onError:e=>{m.Am.error("Failed to resend invitation: ".concat(e.message))}}),{mutate:G,isLoading:Y}=sc({onSuccess:()=>{m.Am.success("Resent the invitation")},onError:e=>{m.Am.error("Failed to resend the invidation: ".concat(e.message))}}),{mutate:V,isLoading:q}=sI(),{mutate:W}=sk(),X=U||q||F,K=()=>h?p.gotrue_id?void L({slug:h,gotrueId:p.gotrue_id}):console.error("gotrue_id is required"):console.error("slug is required"),Q=e=>{var t;let a=(null!==(t=null==e?void 0:e.role_ids)&&void 0!==t?t:[])[0],n=e.invited_id;return h?n?void(A?V({slug:h,id:n,skipInvalidation:!0},{onSuccess:()=>{if(!e.primary_email)return m.Am.error("Email is required");let t=T.find(e=>e.id===a);if(void 0!==t){var n;let a=(null!==(n=null==t?void 0:t.project_ids)&&void 0!==n?n:[]).map(e=>{var t;return null==w?void 0:null===(t=w.find(t=>t.id===e))||void 0===t?void 0:t.ref}).filter(Boolean);B({slug:h,email:e.primary_email,roleId:t.base_role_id,projects:a})}else B({slug:h,email:e.primary_email,roleId:a})}}):W({slug:h,invitedId:n,invalidateDetail:!1},{onSuccess:()=>{G({slug:h,invitedEmail:e.primary_email,ownerId:n,roleId:a})}})):console.error("Member invited ID is required"):console.error("Slug is required")},J=e=>{let t=e.invited_id;return h?t?void(A?V({slug:h,id:t},{onSuccess:()=>m.Am.success("Successfully revoked the invitation.")}):W({slug:h,invitedId:t},{onSuccess:()=>m.Am.success("Successfully revoked the invitation.")})):console.error("Member invited ID is required"):console.error("Slug is required")};return Z&&(!E||D||O)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-end gap-x-2",children:[(0,r.jsx)(ts.u,{type:"default",disabled:E||!Z,onClick:()=>y(!0),tooltip:{content:{side:"bottom",text:E?"Role can only be changed after the user has accepted the invite":Z?void 0:"You need additional permissions to manage this team member"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"MemberActions.tsx",children:"Manage access"}),(0,r.jsxs)(eQ.h_,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"MemberActions.tsx",children:[(0,r.jsx)(eQ.$F,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"MemberActions.tsx",children:(0,r.jsx)(H.z,{type:"text",className:"px-1.5",disabled:X,loading:X,icon:(0,r.jsx)(nG.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"MemberActions.tsx"})}),(0,r.jsx)(eQ.AW,{side:"bottom",align:"end",className:"w-52","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"MemberActions.tsx",children:(0,r.jsx)(r.Fragment,{children:E?(0,r.jsxs)(r.Fragment,{children:[O&&(0,r.jsx)(eQ.Xi,{onClick:()=>J(p),children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{children:"Cancel invitation"}),(0,r.jsx)("p",{className:"text-foreground-lighter",children:"Revoke this invitation."})]})}),D&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eQ.VD,{}),(0,r.jsx)(eQ.Xi,{onClick:()=>Q(p),children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{children:"Resend invitation"}),(0,r.jsx)("p",{className:"text-foreground-lighter",children:"Invites expire after 24hrs."})]})})]})]}):j&&(0,r.jsxs)(eQ.Xi,{className:"space-x-2 items-start",disabled:!Z,onClick:()=>{v(!0)},children:[(0,r.jsx)(nZ.Z,{size:16}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{children:"Remove member"}),!Z&&(0,r.jsx)("p",{className:"text-foreground-lighter",children:"Additional permissions required"})]})]})})})]})]}),(0,r.jsx)(sn.Z,{size:"large",visible:f,loading:U,title:"Confirm to remove member",confirmLabel:"Remove",variant:"warning",alert:{title:"All user content from this member will be permanently removed.",description:(0,r.jsxs)("div",{children:["Removing a member will delete all of the user's saved content in all projects of this organization, which includes:",(0,r.jsxs)("ul",{className:"list-disc pl-4 my-2",children:[(0,r.jsxs)("li",{children:["SQL snippets"," ",(0,r.jsxs)("span",{className:"text-foreground",children:["(both ",(0,r.jsx)("span",{className:"underline",children:"private"})," and"," ",(0,r.jsx)("span",{className:"underline",children:"shared"})," snippets)"]})]}),(0,r.jsx)("li",{children:"Custom reports"}),(0,r.jsx)("li",{children:"Log Explorer queries"})]}),(0,r.jsx)("p",{className:"mt-4 text-foreground-lighter",children:"If you'd like to retain the member's shared SQL snippets, right click on them and \"Duplicate personal copy\" in the SQL Editor before removing this member."})]})},onCancel:()=>v(!1),onConfirm:()=>{K()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"MemberActions.tsx",children:(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to remove"," ",(0,r.jsx)("span",{className:"text-foreground",children:p.primary_email})," from"," ",(0,r.jsx)("span",{className:"text-foreground",children:null==b?void 0:b.name}),"?"]})}),(0,r.jsx)(sH,{visible:g,member:p,onClose:()=>y(!1),"data-sentry-element":"UpdateRolesPanel","data-sentry-source-file":"MemberActions.tsx"})]}):(0,r.jsx)("div",{className:"flex items-center justify-end",children:(0,r.jsx)(ts.u,{disabled:!0,type:"text",className:"px-1.5",icon:(0,r.jsx)(nG.Z,{size:18}),tooltip:{content:{side:"bottom",text:"You need additional permissions to manage this team member"}}})})},sW={vercel:"vercel-marketplace"},sX=e=>{var t,a,n,s;let{member:i}=e,{profile:l}=(0,aP.Un)(),o=(0,k.l)(),[d,c]=(0,u.useState)(!1),{data:m}=(0,tc.Sy)(),{data:p,isLoading:h}=nN({slug:null==o?void 0:o.slug}),x=null==m?void 0:m.filter(e=>e.organization_id===(null==o?void 0:o.id)),g=(null!==(n=null==p?void 0:p.project_scoped_roles)&&void 0!==n?n:[]).length>0,y=i.gotrue_id==(null==l?void 0:l.gotrue_id),f=!!i.invited_id,v=i.username===i.primary_email,j=!!(null===(t=i.primary_email)||void 0===t?void 0:t.endsWith("customer.fly.io")),b=i.role_ids.filter(e=>{var t,a,n;let s=[...null!==(t=null==p?void 0:p.org_scoped_roles)&&void 0!==t?t:[],...null!==(a=null==p?void 0:p.project_scoped_roles)&&void 0!==a?a:[]].find(t=>t.id===e);return(null==s?void 0:s.project_ids)!==null&&0===(null!==(n=null==s?void 0:s.project_ids)&&void 0!==n?n:[]).map(e=>{var t,a;return null!==(a=null==m?void 0:null===(t=m.find(t=>t.id===e))||void 0===t?void 0:t.name)&&void 0!==a?a:""}).filter(e=>e.length>0).length}).length>0;return(0,r.jsxs)(ef.Z.tr,{"data-sentry-element":"unknown","data-sentry-component":"MemberRow","data-sentry-source-file":"MemberRow.tsx",children:[(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{children:f||v||j||d?(0,r.jsx)("div",{className:"w-[40px] h-[40px] bg-surface-100 border border-overlay rounded-full text-foreground-lighter flex items-center justify-center",children:(0,r.jsx)(nh.Z,{size:20,strokeWidth:1.5})}):(0,r.jsx)(ng(),{alt:i.username,src:"https://github.com/".concat(i.username,".png?size=80"),width:"40",height:"40",className:"border rounded-full",onError:()=>{c(!0)}})}),(0,r.jsxs)("div",{className:"flex item-center gap-x-2",children:[void 0===f?(0,r.jsx)("p",{className:"text-foreground-light truncate",children:i.primary_email}):(0,r.jsx)("p",{className:"text-foreground truncate",children:sC(i)}),i.primary_email===(null==l?void 0:l.primary_email)&&(0,r.jsx)(eI.C,{color:"scale",children:"You"})]}),(null===(a=i.metadata)||void 0===a?void 0:a.origin)&&(0,r.jsx)(sN.Z,{organization:{managed_by:null!==(s=sW[i.metadata.origin])&&void 0!==s?s:"supabase"},tooltipText:"This user is managed by Vercel Marketplace."})]})}),(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:f&&i.invited_at&&(0,r.jsx)(eI.C,{variant:s_(i.invited_at)?"destructive":"warning",children:s_(i.invited_at)?"Expired":"Invited"})}),(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:(0,r.jsx)("div",{className:"flex items-center justify-center",children:i.mfa_enabled?(0,r.jsx)(tt.Z,{className:"text-brand",strokeWidth:2,size:20}):(0,r.jsx)(tK.Z,{className:"text-foreground-light",strokeWidth:1.5,size:20})})}),(0,r.jsx)(ef.Z.td,{className:"max-w-64","data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:h?(0,r.jsx)(sw.Z,{className:"w-32"}):b?(0,r.jsx)(sb.Z,{strokeWidth:1.5,size:20}):i.role_ids.map(e=>{var t,a,n,s,i;let l=(null!==(t=null==p?void 0:p.org_scoped_roles)&&void 0!==t?t:[]).find(t=>t.id===e),o=(null!==(a=null==p?void 0:p.project_scoped_roles)&&void 0!==a?a:[]).find(t=>t.id===e),d=l||o,c=(null!==(n=null==d?void 0:d.name)&&void 0!==n?n:"").split("_")[0],u=(null==d?void 0:d.project_ids)===null?null!==(s=null==x?void 0:x.map(e=>e.name))&&void 0!==s?s:[]:(null!==(i=null==d?void 0:d.project_ids)&&void 0!==i?i:[]).map(e=>{var t,a;return null!==(a=null==x?void 0:null===(t=x.find(t=>t.id===e))||void 0===t?void 0:t.name)&&void 0!==a?a:""}).filter(e=>e.length>0);return(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)("p",{children:c}),g&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"•"}),1===u.length?(0,r.jsx)("span",{className:"text-foreground truncate",title:u[0],children:u[0]}):(0,r.jsxs)(nr.zs,{openDelay:200,children:[(0,r.jsx)(nr.Yi,{asChild:!0,children:(0,r.jsx)("span",{className:"text-foreground",children:(null==d?void 0:d.project_ids)===null?"Organization":"".concat(u.length," project").concat(u.length>1?"s":"")})}),(0,r.jsxs)(nr.bZ,{className:"p-0",children:[(0,r.jsxs)("p",{className:"p-2 text-xs",children:[c," role applies to ",u.length," project",u.length>1?"s":""]}),(0,r.jsx)("div",{className:"border-t flex flex-col py-1",children:(0,r.jsx)(sx.x,{className:(0,W.cn)(u.length>5?"h-[130px]":""),children:u.map(e=>{var t;let a=null==x?void 0:null===(t=x.find(t=>t.name===e))||void 0===t?void 0:t.ref;return(0,r.jsxs)(L(),{href:"/project/".concat(a),className:"px-2 py-1 group hover:bg-surface-300 hover:text-foreground transition flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs truncate max-w-[60%]",children:e}),(0,r.jsxs)("span",{className:"text-xs text-foreground flex items-center gap-x-1 opacity-0 group-hover:opacity-100 transition",children:["Go to project",(0,r.jsx)(sS.Z,{size:14})]})]},e)})})})]})]})]})]},"role-".concat(e))})}),(0,r.jsx)(ef.Z.td,{"data-sentry-element":"unknown","data-sentry-source-file":"MemberRow.tsx",children:!y&&(0,r.jsx)(sq,{member:i})})]})};var sK=e=>{var t,a,n;let{searchString:s}=e,{slug:l}=(0,i.UO)(),{profile:o}=(0,aP.Un)(),{data:d,error:c,isLoading:u,isError:m,isSuccess:h}=nI({slug:l}),{data:x,error:g,isSuccess:y,isError:f}=nN({slug:l}),j=null!=d?d:[],b=(s?j.filter(e=>{var t,a;return e.invited_at?null===(t=e.primary_email)||void 0===t?void 0:t.includes(s):e.gotrue_id?e.username.includes(s)||(null===(a=e.primary_email)||void 0===a?void 0:a.includes(s)):void 0}):j).slice().sort((e,t)=>e.primary_email===(null==o?void 0:o.primary_email)?-1:e.username.localeCompare(t.username)),S=j.find(e=>e.primary_email===(null==o?void 0:o.primary_email)),N=(null!==(a=null==x?void 0:x.org_scoped_roles)&&void 0!==a?a:[]).map(e=>e.id).includes(null!==(n=null==S?void 0:null===(t=S.role_ids)||void 0===t?void 0:t[0])&&void 0!==n?n:-1);return(0,r.jsxs)(r.Fragment,{children:[u&&(0,r.jsx)(v.A,{}),m&&(0,r.jsx)(p.Z,{error:c,subject:"Failed to retrieve organization members"}),f&&(0,r.jsx)(p.Z,{error:g,subject:"Failed to retrieve organization roles"}),h&&(0,r.jsx)("div",{className:"rounded w-full",children:(0,r.jsx)(sj.Z,{active:!b,children:(0,r.jsx)(ef.Z,{head:[(0,r.jsx)(ef.Z.th,{children:"User"},"header-user"),(0,r.jsx)(ef.Z.th,{className:"w-24"},"header-status"),(0,r.jsx)(ef.Z.th,{className:"text-center w-32",children:"Enabled MFA"},"header-mfa"),(0,r.jsxs)(ef.Z.th,{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:"Role"}),(0,r.jsxs)(X.u,{children:[(0,r.jsx)(X.aJ,{asChild:!0,children:(0,r.jsx)(H.z,{asChild:!0,type:"text",className:"px-1",children:(0,r.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/platform/access-control",children:(0,r.jsx)(aA.Z,{size:14,className:"text-foreground-light"})})})}),(0,r.jsx)(X._v,{side:"bottom",children:"How to configure access control?"})]})]},"header-role"),(0,r.jsx)(ef.Z.th,{},"header-action")],body:[...y&&h&&!N?[(0,r.jsx)(ef.Z.tr,{children:(0,r.jsx)(ef.Z.td,{colSpan:12,className:"!p-0",children:(0,r.jsx)(e1.J,{type:"note",title:"You are currently assigned with project scoped roles in this organization",description:"All the members within the organization will not be visible to you",className:"m-0 bg-alternative border-0 rounded-none"})})},"project-scope-notice")]:[],...b.map(e=>(0,r.jsx)(sX,{member:e},e.gotrue_id)),...s.length>0&&0===b.length?[(0,r.jsx)(ef.Z.tr,{className:"bg-panel-secondary-light",children:(0,r.jsx)(ef.Z.td,{colSpan:12,children:(0,r.jsxs)("div",{className:"flex items-center space-x-3 opacity-75",children:[(0,r.jsx)(tT.Z,{size:16,strokeWidth:2}),(0,r.jsxs)("p",{className:"text-foreground-light",children:['No users matched the search query "',s,'"']})]})})},"no-results")]:[],(0,r.jsx)(ef.Z.tr,{className:"bg-panel-secondary-light",children:(0,r.jsx)(ef.Z.td,{colSpan:12,children:(0,r.jsxs)("p",{className:"text-foreground-light",children:[s?"".concat(b.length," of "):"",j.length||"0"," ",1==j.length?"user":"users"]})})},"footer")]})})})]})},sQ=()=>{var e;let{organizationMembersCreate:t,organizationMembersDelete:a}=(0,o.N)(["organization_members:create","organization_members:delete"]),{slug:n}=(0,i.UO)(),{profile:s}=(0,aP.Un)(),d=(0,k.l)(),c=null==d?void 0:d.is_owner,{data:p}=(0,sa.j)(),{data:h}=nN({slug:n}),{data:x}=nI({slug:n}),g=null!==(e=null==h?void 0:h.org_scoped_roles)&&void 0!==e?e:[],{rolesAddable:y}=sy(null==d?void 0:d.slug,g,null!=p?p:[]),[f,v]=(0,u.useState)(!1),[j,b]=(0,u.useState)(""),S=y.length>0,N=!c||c&&sf(x,g),{mutate:w}=st({onSuccess:()=>{var e;v(!1),C(!1),null===(e=window)||void 0===e||e.location.replace(eh.GW)},onError:e=>{v(!1),m.Am.error("Failed to leave organization: ".concat(null==e?void 0:e.message))}}),[_,C]=(0,u.useState)(!1),A=async()=>{if(!n)return console.error("Org slug is required");v(!0),w({slug:n,gotrueId:s.gotrue_id})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.gW,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-source-file":"TeamSettings.tsx",children:(0,r.jsxs)(l.tM,{"data-sentry-element":"ScaffoldFilterAndContent","data-sentry-source-file":"TeamSettings.tsx",children:[(0,r.jsxs)(l.Wv,{className:"justify-between","data-sentry-element":"ScaffoldActionsContainer","data-sentry-source-file":"TeamSettings.tsx",children:[(0,r.jsx)(M.Z,{autoComplete:"off",icon:(0,r.jsx)(n9.Z,{size:12}),size:"small",value:j,onChange:e=>b(e.target.value),name:"email",id:"email",placeholder:"Filter members","data-sentry-element":"Input","data-sentry-source-file":"TeamSettings.tsx"}),(0,r.jsxs)(l.ur,{"data-sentry-element":"ScaffoldActionsGroup","data-sentry-source-file":"TeamSettings.tsx",children:[t&&S&&void 0!==s&&void 0!==d&&(0,r.jsx)(sv,{}),a&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(ts.u,{type:"default",loading:f,disabled:!N,tooltip:{content:{side:"bottom",text:N?void 0:"An organization requires at least 1 owner"}},onClick:()=>C(!0),children:"Leave team"})})]})]}),(0,r.jsx)(l.Lc,{className:"w-full","data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"TeamSettings.tsx",children:(0,r.jsx)(sK,{searchString:j,"data-sentry-element":"MembersView","data-sentry-source-file":"TeamSettings.tsx"})})]})}),(0,r.jsx)(sn.Z,{size:"medium",visible:_,title:"Confirm to leave organization",confirmLabel:"Leave",variant:"warning",alert:{title:"All of your user content will be permanently removed.",description:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Leaving the organization will delete all of your saved content in the projects of the organization, which includes:"}),(0,r.jsxs)("ul",{className:"list-disc pl-4",children:[(0,r.jsxs)("li",{children:["SQL snippets ",(0,r.jsx)("span",{className:"text-foreground",children:"(both private and shared)"})]}),(0,r.jsx)("li",{children:"Custom reports"}),(0,r.jsx)("li",{children:"Log Explorer queries"})]})]})},onCancel:()=>C(!1),onConfirm:()=>A(),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"TeamSettings.tsx",children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to leave this organization? This is permanent."})})]})},sJ=()=>(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"DPA","data-sentry-source-file":"DPA.tsx",children:[(0,r.jsxs)(l.g$,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"DPA.tsx",children:[(0,r.jsx)("p",{className:"text-base m-0",children:"Data Processing Addendum (DPA)"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,r.jsx)("p",{children:"All organizations can access and use our DPA as part of their GDPR compliance. This is only to access the document. Please ignore this if you have sent the signed document to us."}),(0,r.jsxs)("p",{children:["Please review these details and add data specific to user processing where required. Sign and return the signed DPA document to"," ",(0,r.jsx)("a",{href:"mailto:privacy@supabase.com",target:"_blank",className:"text-brand hover:text-brand",children:"privacy@supabase.com"})," ","for the document to be considered executed."]})]})]}),(0,r.jsx)(l.Lc,{className:"flex items-center justify-center h-full","data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"DPA.tsx",children:(0,r.jsx)(H.z,{asChild:!0,type:"default",iconRight:(0,r.jsx)(ed.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"DPA.tsx",children:(0,r.jsx)("a",{download:!0,target:"_blank",rel:"noreferrer noopener",href:"https://supabase.com/downloads/docs/Supabase+DPA+231211.pdf",children:"View DPA"})})})]}),s$=()=>(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"TIA","data-sentry-source-file":"TIA.tsx",children:[(0,r.jsxs)(l.g$,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"TIA.tsx",children:[(0,r.jsx)("p",{className:"text-base m-0",children:"Transfer Impact Assessment (TIA)"}),(0,r.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,r.jsx)("p",{children:"All organizations can access and use our TIA as part of their GDPR-compliant data transfer process."})})]}),(0,r.jsx)(l.Lc,{className:"flex items-center justify-center h-full","data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"TIA.tsx",children:(0,r.jsx)("a",{href:"https://supabase.com/downloads/docs/Supabase+TIA+241030.pdf",target:"_blank",rel:"noreferrer noopener",download:!0,children:(0,r.jsx)(H.z,{type:"default",iconRight:(0,r.jsx)(ed.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"TIA.tsx",children:"View TIA"})})})]});async function s0(e,t){let{orgSlug:a,docType:n}=e;if(!a)throw Error("orgSlug is required");if("standard-security-questionnaire"===n){let{data:e,error:n}=await (0,b.U2)("/platform/organizations/{slug}/documents/standard-security-questionnaire",{params:{path:{slug:a}},signal:t});return n&&(0,b.S3)(n),e}if("soc2-type-2-report"===n){let{data:e,error:n}=await (0,b.U2)("/platform/organizations/{slug}/documents/soc2-type-2-report",{params:{path:{slug:a}},signal:t});if(n)throw n;return e}}var s1=()=>{let{slug:e}=(0,i.UO)(),t=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:a,error:n,isLoading:s,isError:o,isSuccess:u}=(0,d.Gl)({orgSlug:e},{enabled:t}),h=null==a?void 0:a.plan,x=async e=>{try{let t=await s0({orgSlug:e,docType:"standard-security-questionnaire"});(null==t?void 0:t.fileUrl)&&window.open(t.fileUrl,"_blank")}catch(e){m.Am.error("Failed to download Security Questionnaire: ".concat(e.message))}};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"SecurityQuestionnaire.tsx",children:[(0,r.jsxs)(l.g$,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"SecurityQuestionnaire.tsx",children:[(0,r.jsx)("p",{className:"text-base m-0",children:"Standard Security Questionnaire"}),(0,r.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,r.jsx)("p",{children:"Organizations on Team Plan or above have access to our standard security questionnaire."})})]}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"SecurityQuestionnaire.tsx",children:t?(0,r.jsxs)(r.Fragment,{children:[s&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),o&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:n}),u&&(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==h?void 0:h.id)==="free"||(null==h?void 0:h.id)==="pro"?(0,r.jsx)(L(),{href:"/org/".concat(e,"/billing?panel=subscriptionPlan"),children:(0,r.jsx)(H.z,{type:"default",children:"Upgrade to Team"})}):(0,r.jsx)(H.z,{type:"default",icon:(0,r.jsx)(ab.Z,{}),onClick:()=>{e&&x(e)},children:"Download Questionnaire"})})]}):(0,r.jsx)(y.Z,{resourceText:"access our security questionnaire"})})]})})},s2=()=>{let{slug:e}=(0,i.UO)(),t=(0,S.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:a,error:n,isLoading:s,isError:o,isSuccess:h}=(0,d.Gl)({orgSlug:e},{enabled:t}),x=null==a?void 0:a.plan,[g,f]=(0,u.useState)(!1),j=async e=>{try{let t=await s0({orgSlug:e,docType:"soc2-type-2-report"});(null==t?void 0:t.fileUrl)&&window.open(t.fileUrl,"_blank"),f(!1)}catch(e){m.Am.error("Failed to download SOC2 report: ".concat(e.message))}};return(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"SOC2","data-sentry-source-file":"SOC2.tsx",children:[(0,r.jsxs)(l.g$,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"SOC2.tsx",children:[(0,r.jsx)("p",{className:"text-base m-0",children:"SOC2 Type 2"}),(0,r.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,r.jsx)("p",{children:"Organizations on Team Plan or above have access to our most recent SOC2 Type 2 report."})})]}),(0,r.jsxs)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"SOC2.tsx",children:[t?(0,r.jsxs)(r.Fragment,{children:[s&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(v.Z,{}),(0,r.jsx)(v.Z,{className:"w-3/4"}),(0,r.jsx)(v.Z,{className:"w-1/2"})]}),o&&(0,r.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:n}),h&&(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==x?void 0:x.id)==="free"||(null==x?void 0:x.id)==="pro"?(0,r.jsx)(L(),{href:"/org/".concat(e,"/billing?panel=subscriptionPlan"),children:(0,r.jsx)(H.z,{type:"default",children:"Upgrade to Team"})}):(0,r.jsx)(H.z,{type:"default",icon:(0,r.jsx)(ab.Z,{}),onClick:()=>f(!0),children:"Download SOC2 Type 2 Report"})})]}):(0,r.jsx)(y.Z,{resourceText:"access our SOC2 Type 2 report"}),(0,r.jsx)(sn.Z,{visible:g,size:"large",title:"Non-Disclosure Agreement to access Supabase's SOC2 Report",confirmLabel:"I agree",confirmLabelLoading:"Downloading",onCancel:()=>f(!1),onConfirm:()=>{e&&j(e)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"SOC2.tsx",children:(0,r.jsxs)("ol",{className:"list-decimal list-inside text-sm text-foreground-light pl-30",children:[(0,r.jsx)("li",{children:"The information that you are about to access is confidential."}),(0,r.jsx)("li",{children:'Your access to our SOC 2 materials is governed by confidentiality obligations contained in the agreement between Supabase, Inc ("Supabase", "we", "our" or "us") and the Supabase customer that has authorized you to access our platform to obtain this information (our "Customer").'}),(0,r.jsx)("li",{children:"You must ensure that you treat the information in our SOC 2 materials in accordance with those confidentiality obligations, as communicated to you by the Customer."}),(0,r.jsxs)("li",{children:['By clicking "I agree" below or otherwise accessing our SOC 2 materials, you:',(0,r.jsxs)("ol",{className:"list-[lower-roman] list-inside pl-4",children:[(0,r.jsx)("li",{children:"acknowledge that you have read and understood this Confidentiality Notice;"}),(0,r.jsx)("li",{children:"confirm that you have been authorized by the Customer to access this information, and your use of our SOC 2 materials is subject to the confidentiality obligations owed by the Customer to us."})]})]}),(0,r.jsx)("li",{children:"This Confidentiality Notice does not substitute or supersede any agreement between us and the Customer, or any internal rules or policies that the Customer requires you to comply with in your access to and use of confidential information. However, your failure to comply with this Confidentiality Notice may be used to determine whether the Customer has complied with its confidentiality obligations to us."})]})})]})]})},s4=()=>(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"HIPAA.tsx",children:[(0,r.jsxs)(l.g$,{className:"sticky space-y-6 top-12","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"HIPAA.tsx",children:[(0,r.jsx)("p",{className:"text-base m-0",children:"HIPAA"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,r.jsx)("p",{children:"This is only for HIPAA requests. Please ignore this if you already have HIPAA enabled."}),(0,r.jsx)("p",{children:"Organizations on the Team Plan or above are eligible for a paid HIPAA compliance add-on. You can submit a request here and we will get back to you on the pricing and process for your use case."}),(0,r.jsx)("p",{children:"Organizations on the Free or Pro Plan can also submit a request for HIPAA. Note that you are still required to upgrade to the Team Plan after your request is approved."})]})]}),(0,r.jsx)(l.Lc,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"HIPAA.tsx",children:(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("a",{href:"https://forms.supabase.com/hipaa2",target:"_blank",rel:"noreferrer noopener",children:(0,r.jsx)(H.z,{type:"default",iconRight:(0,r.jsx)(ed.Z,{}),"data-sentry-element":"Button","data-sentry-source-file":"HIPAA.tsx",children:"Request HIPAA"})})})})]})}),s5=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l._S,{id:"dpa","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,r.jsx)(sJ,{"data-sentry-element":"DPA","data-sentry-source-file":"Documents.tsx"})}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,r.jsx)(l._S,{id:"tia","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,r.jsx)(s$,{"data-sentry-element":"TIA","data-sentry-source-file":"Documents.tsx"})}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,r.jsx)(l._S,{id:"soc2","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,r.jsx)(s2,{"data-sentry-element":"SOC2","data-sentry-source-file":"Documents.tsx"})}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,r.jsx)(l._S,{id:"hipaa","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,r.jsx)(s4,{"data-sentry-element":"HIPAA","data-sentry-source-file":"Documents.tsx"})}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,r.jsx)(l._S,{id:"security-questionnaire","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,r.jsx)(s1,{"data-sentry-element":"SecurityQuestionnaire","data-sentry-source-file":"Documents.tsx"})}),(0,r.jsx)(l.I7,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"Documents.tsx"}),(0,r.jsx)(l._S,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"Documents.tsx",children:(0,r.jsx)(l.jX,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"Documents.tsx",children:(0,r.jsxs)("p",{className:"sticky space-y-6 top-12 text-sm text-foreground-light m-0 whitespace-nowrap",children:[(0,r.jsx)(L(),{href:"/support/new",className:"hover:underline","data-sentry-element":"Link","data-sentry-source-file":"Documents.tsx",children:"Submit a support request"})," ","if you require additional documents for financial or tax reasons, such as a W-9 form."]})})})]})},5958:function(e,t,a){a.d(t,{s:function(){return l}});var n=a(28894),s=a(61250),r=a(86506);async function i(e,t){let{installationId:a}=e;if(!a)throw Error("installationId is required");let{data:n,error:r}=await (0,s.U2)("/platform/vercel/redirect/{installation_id}",{params:{path:{installation_id:a}},signal:t});return r&&(0,s.S3)(r),n}let l=function(e){let{installationId:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.a)(r.F.vercelRedirect(t),e=>{let{signal:a}=e;return i({installationId:t},a)},{enabled:a&&void 0!==t,...s})}},86427:function(e,t,a){a.d(t,{O:function(){return n}});let n={rolesV2:e=>["organization-members",e,"roles-v2"],invitations:e=>["organization-members",e,"invitations"],invitation:(e,t)=>["organization-members",e,"invitations",t],token:(e,t)=>["organization-members",e,"token",t]}},73966:function(e,t,a){a.d(t,{T:function(){return c}});var n=a(36457),s=a(64618),r=a(34549),i=a(61250),l=a(89431),o=a(31053);async function d(e){let{name:t,kind:a,size:n,tier:s,payment_method:r}=e,{data:l,error:o}=await (0,i.v_)("/platform/organizations",{body:{name:t,kind:a,size:n,tier:s,payment_method:r}});return o&&(0,i.S3)(o),l}let c=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,n.NL)();return(0,s.D)(e=>d(e),{async onSuccess(t,a,n){await Promise.all([i.invalidateQueries(o.O.list()),i.invalidateQueries(l.F.list())]),await (null==e?void 0:e(t,a,n))},async onError(e,a,n){void 0===t?r.Am.error("Failed to create organization: ".concat(e.message)):t(e,a,n)},...a})}},56752:function(e,t,a){a.d(t,{Wu:function(){return i}});var n=a(28622),s=a(34653);let r=(0,n.sj)({panelKey:void 0,setPanelKey:e=>{r.panelKey=e}}),i=e=>(0,s.R)(r,e)},10900:function(e,t,a){a.d(t,{A:function(){return d}});var n=a(97458),s=a(37417),r=a(64071),i=a(61911),l=a(37669),o=a.n(l);let d=e=>{var t;let{organization:a}=e,{data:l}=(0,s.Sy)({}),d=null!==(t=null==l?void 0:l.filter(e=>e.organization_id===(null==a?void 0:a.id)).length)&&void 0!==t?t:0,{data:c}=(0,r.Gl)({orgSlug:null==a?void 0:a.slug});return d>0||(null==c?void 0:c.plan)===void 0||"free"===c.plan.id||"enterprise"===c.plan.id?null:(0,n.jsx)(i.J,{type:"default",title:"Your organization is on the ".concat(c.plan.name," plan with no projects running"),description:(0,n.jsxs)("div",{className:"!max-w-full prose text-sm",children:["The monthly fees for the paid plan still apply. To cancel your subscription, head over to your"," ",(0,n.jsx)(o(),{href:"/org/".concat(null==a?void 0:a.slug,"/billing"),children:"organization billing settings"})]}),"data-sentry-element":"Admonition","data-sentry-component":"NoProjectsOnPaidOrgInfo","data-sentry-source-file":"NoProjectsOnPaidOrgInfo.tsx"})}},32905:function(e,t,a){var n=a(97458),s=a(82445);t.Z=e=>{let{projectUpdateDisabled:t,projectNotActive:a=!1,children:r,tooltip:i}=e;return(0,n.jsxs)(s.u,{"data-sentry-element":"Tooltip_Shadcn_","data-sentry-component":"ProjectUpdateDisabledTooltip","data-sentry-source-file":"ProjectUpdateDisabledTooltip.tsx",children:[(0,n.jsx)(s.aJ,{asChild:!0,"data-sentry-element":"TooltipTrigger_Shadcn_","data-sentry-source-file":"ProjectUpdateDisabledTooltip.tsx",children:r}),(t||a)&&(0,n.jsx)(s._v,{side:"bottom",className:"w-72 text-center",children:t?i||"Subscription changes are currently disabled. Our engineers are working on a fix.":a?"Unable to update subscription as project is currently not active":""})]})}},81463:function(e,t,a){var n=a(97458),s=a(198),r=a(45196);let i=e=>{let{description:t,hasReadScope:a,hasWriteScope:s}=e;if(a||s){let e=[a?"Read":null,s?"Write":null].filter(Boolean).map(e=>(0,n.jsx)("span",{className:"font-semibold text-foreground",children:e},e)).reduce((e,t)=>(0,n.jsxs)(n.Fragment,{children:[e,(0,n.jsx)("span",{children:" and "}),t]}));return(0,n.jsxs)("div",{className:"first:border-t border-b flex flex-row space-x-1 text-sm text-foreground-light py-2 px-1",children:[(0,n.jsx)("div",{className:"pt-0.5",children:(0,n.jsx)(r.Z,{stroke:"green",height:18,width:18,strokeWidth:1.5})}),(0,n.jsxs)("div",{children:[e," ",t]})]})}return null};t.Z=e=>{let{icon:t,name:a,domain:r,scopes:l}=e;return(0,n.jsxs)("div",{className:"flex gap-y-4 flex-col","data-sentry-component":"AuthorizeRequesterDetails","data-sentry-source-file":"AuthorizeRequesterDetails.tsx",children:[(0,n.jsxs)("div",{className:"flex flex-row gap-x-4 items-center",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-center bg-no-repeat bg-cover flex items-center justify-center rounded-md border border-control",style:{backgroundImage:t?"url('".concat(t,"')"):"none"},children:!t&&(0,n.jsx)("p",{className:"text-foreground-light text-lg",children:a[0]})})}),(0,n.jsxs)("p",{className:"text-foreground",children:[a," (",r,") is requesting API access to an organization."]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"Permissions"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following scopes will apply for the"," ",(0,n.jsx)("span",{className:"text-amber-900",children:"selected organization and all of its projects."})]}),(0,n.jsxs)("div",{className:"pt-2",children:[(0,n.jsx)(i,{description:"access to analytics logs.",hasReadScope:l.includes(s.YX.ANALYTICS_READ),hasWriteScope:l.includes(s.YX.ANALYTICS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to auth configurations and SSO providers.",hasReadScope:l.includes(s.YX.AUTH_READ),hasWriteScope:l.includes(s.YX.AUTH_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",hasReadScope:l.includes(s.YX.DATABASE_READ),hasWriteScope:l.includes(s.YX.DATABASE_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to custom domains and vanity subdomains.",hasReadScope:l.includes(s.YX.DOMAINS_READ),hasWriteScope:l.includes(s.YX.DOMAINS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to edge functions.",hasReadScope:l.includes(s.YX.EDGE_FUNCTIONS_READ),hasWriteScope:l.includes(s.YX.EDGE_FUNCTIONS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to environments/branches.",hasReadScope:l.includes(s.YX.ENVIRONMENT_READ),hasWriteScope:l.includes(s.YX.ENVIRONMENT_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to the organization and all its members.",hasReadScope:l.includes(s.YX.ORGANIZATIONS_READ),hasWriteScope:l.includes(s.YX.ORGANIZATIONS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to metadata, its upgrade status, network restrictions and network bans.",hasReadScope:l.includes(s.YX.PROJECTS_READ),hasWriteScope:l.includes(s.YX.PROJECTS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to PostgREST configurations.",hasReadScope:l.includes(s.YX.REST_READ),hasWriteScope:l.includes(s.YX.REST_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to API keys, secrets and pgsodium configurations.",hasReadScope:l.includes(s.YX.SECRETS_READ),hasWriteScope:l.includes(s.YX.SECRETS_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"}),(0,n.jsx)(i,{description:"access to storage buckets and files.",hasReadScope:l.includes(s.YX.STORAGE_READ),hasWriteScope:l.includes(s.YX.STORAGE_WRITE),"data-sentry-element":"ScopeSection","data-sentry-source-file":"AuthorizeRequesterDetails.tsx"})]})]})]})}},49154:function(e,t,a){a.d(t,{DO:function(){return d},Tq:function(){return l},by:function(){return i},iL:function(){return o},m9:function(){return c}});var n=a(97458),s=a(52983),r=a(5546);let i=e=>{let{children:t,header:a,footer:s}=e;return(0,n.jsxs)(l,{"data-sentry-element":"FormPanelContainer","data-sentry-component":"FormPanel","data-sentry-source-file":"FormPanel.tsx",children:[a&&(0,n.jsx)(o,{children:a}),(0,n.jsx)(d,{className:"divide-y","data-sentry-element":"FormPanelContent","data-sentry-source-file":"FormPanel.tsx",children:t}),s&&(0,n.jsx)(c,{children:s})]})},l=(0,s.forwardRef)((e,t)=>{let{children:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("bg-surface-100 border overflow-hidden rounded-md shadow",s.className),children:a})});l.displayName=l.displayName;let o=(0,s.forwardRef)((e,t)=>{let{children:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("border-default border-b px-8 py-4",s.className),children:a})});o.displayName=o.displayName;let d=(0,s.forwardRef)((e,t)=>{let{children:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("divide-border flex flex-col gap-0",s.className),children:a})});d.displayName=d.displayName;let c=(0,s.forwardRef)((e,t)=>{let{children:a,...s}=e;return(0,n.jsx)("div",{ref:t,...s,className:(0,r.cn)("border-t",s.className),children:a})});c.displayName=c.displayName},6166:function(e,t,a){a.d(t,{y:function(){return d}});var n=a(97458),s=a(2552),r=a(5958),i=a(71904),l=a(19168),o=a(86355);let d={"vercel-marketplace":"Vercel Marketplace","aws-marketplace":"AWS Marketplace"};t.Z=function(e){var t,a;let{partner:c,resource:u,cta:m}=e,p=void 0!==m,{data:h,isLoading:x,isError:g}=(0,r.s)({installationId:null==m?void 0:m.installationId},{enabled:p}),y=(null!==(t=null==h?void 0:h.url)&&void 0!==t?t:"")+(null!==(a=null==m?void 0:m.path)&&void 0!==a?a:"");return(0,n.jsxs)(i.bZ,{className:"flex flex-col items-center gap-y-2 border-0 rounded-none","data-sentry-element":"Alert_Shadcn_","data-sentry-component":"PartnerManagedResource","data-sentry-source-file":"PartnerManagedResource.tsx",children:[(0,n.jsx)(o.Z,{organization:{managed_by:c},showTooltip:!1,size:"large","data-sentry-element":"PartnerIcon","data-sentry-source-file":"PartnerManagedResource.tsx"}),(0,n.jsxs)(i.Cd,{className:"text-sm","data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"PartnerManagedResource.tsx",children:[u," are managed by ",d[c],"."]}),p&&(0,n.jsx)(l.z,{asChild:!0,type:"default",iconRight:(0,n.jsx)(s.Z,{}),disabled:x||g,children:(0,n.jsx)("a",{href:y,target:"_blank",rel:"noopener noreferrer",children:m.message||"View ".concat(u," on ").concat(d[c])})})]})}},33074:function(e,t,a){a.d(t,{b:function(){return l}});var n=a(97458),s=a(52983),r=a(82445);let i=(0,s.forwardRef)((e,t)=>(0,n.jsx)("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...e,children:(0,n.jsx)("path",{d:"M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0ZM9 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM6.75 8a.75.75 0 0 0 0 1.5h.75v1.75a.75.75 0 0 0 1.5 0v-2.5A.75.75 0 0 0 8.25 8h-1.5Z",fillRule:"evenodd",clipRule:"evenodd"})})),l=(0,s.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsxs)(r.u,{children:[(0,n.jsx)(r.aJ,{type:"button",role:"button",className:"flex [&_svg]:data-[state=delayed-open]:fill-foreground-lighter [&_svg]:data-[state=instant-open]:fill-foreground-lighter",children:(0,n.jsx)(i,{strokeWidth:2,className:"transition-colors fill-foreground-muted w-4 h-4"})}),(0,n.jsx)(r._v,{...a})]})})},48653:function(e,t,a){var n=a(97458),s=a(99517);a(52983);var r=a(82188);let i=e=>{let{open:t,children:a,className:r,...i}=e;return(0,n.jsx)(s.fC,{asChild:i.asChild,defaultOpen:i.defaultOpen,open:t,onOpenChange:i.onOpenChange,disabled:i.disabled,className:r,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:a})};i.Trigger=function(e){let{children:t,asChild:a}=e;return(0,n.jsx)(s.xz,{asChild:a,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},i.Content=function(e){let{asChild:t,children:a,className:i}=e,l=(0,r.Z)("collapsible");return(0,n.jsx)(s.VY,{asChild:t,className:[l.content,i].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:a})},t.ZP=i}}]);